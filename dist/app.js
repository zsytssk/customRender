!function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=112)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static regClass(t){r.__classMap[t.name]=t}}e.ILaya=r,r.Laya=null,r.Timer=null,r.WorkerLoader=null,r.Dragging=null,r.GraphicsBounds=null,r.Sprite=null,r.TextRender=null,r.TextAtlas=null,r.timer=null,r.systemTimer=null,r.startTimer=null,r.updateTimer=null,r.lateTimer=null,r.physicsTimer=null,r.stage=null,r.Loader=null,r.loader=null,r.TTFLoader=null,r.SoundManager=null,r.WebAudioSound=null,r.AudioSound=null,r.ShaderCompile=null,r.ClassUtils=null,r.SceneUtils=null,r.Context=null,r.Render=null,r.MouseManager=null,r.Text=null,r.Browser=null,r.WebGL=null,r.Pool=null,r.Utils=null,r.Graphics=null,r.Submit=null,r.Stage=null,r.Resource=null,r.__classMap={}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static getPoolBySign(t){return r._poolDic[t]||(r._poolDic[t]=[])}static clearBySign(t){r._poolDic[t]&&(r._poolDic[t].length=0)}static recover(t,e){e[r.POOLSIGN]||(e[r.POOLSIGN]=!0,r.getPoolBySign(t).push(e))}static recoverByClass(t){if(t){var e=t.__className||t.constructor._$gid;e&&r.recover(e,t)}}static _getClassSign(t){var e=t.__className||t._$gid;return e||(t._$gid=e=r._CLSID+"",r._CLSID++),e}static createByClass(t){return r.getItemByClass(r._getClassSign(t),t)}static getItemByClass(t,e){if(!r._poolDic[t])return new e;var i=r.getPoolBySign(t);if(i.length){var s=i.pop();s[r.POOLSIGN]=!1}else s=new e;return s}static getItemByCreateFun(t,e,i=null){var s=r.getPoolBySign(t),a=s.length?s.pop():e.call(i);return a[r.POOLSIGN]=!1,a}static getItem(t){var e=r.getPoolBySign(t),i=e.length?e.pop():null;return i&&(i[r.POOLSIGN]=!1),i}}e.Pool=r,r._CLSID=0,r.POOLSIGN="__InPool",r._poolDic={}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(5),s=i(0);class a{setTo(t,e,i){return this.type=t,this.currentTarget=e,this.target=i,this}stopPropagation(){this._stoped=!0}get touches(){if(!this.nativeEvent)return null;var t=this.nativeEvent.touches;if(t)for(var e=s.ILaya.stage,i=0,a=t.length;i<a;i++){var n=t[i],o=r.Point.TEMP;o.setTo(n.clientX,n.clientY),e._canvasTransform.invertTransformPoint(o),e.transform.invertTransformPoint(o),n.stageX=o.x,n.stageY=o.y}return t}get altKey(){return this.nativeEvent.altKey}get ctrlKey(){return this.nativeEvent.ctrlKey}get shiftKey(){return this.nativeEvent.shiftKey}get charCode(){return this.nativeEvent.charCode}get keyLocation(){return this.nativeEvent.location||this.nativeEvent.keyLocation}get stageX(){return s.ILaya.stage.mouseX}get stageY(){return s.ILaya.stage.mouseY}}e.Event=a,a.EMPTY=new a,a.MOUSE_DOWN="mousedown",a.MOUSE_UP="mouseup",a.CLICK="click",a.RIGHT_MOUSE_DOWN="rightmousedown",a.RIGHT_MOUSE_UP="rightmouseup",a.RIGHT_CLICK="rightclick",a.MOUSE_MOVE="mousemove",a.MOUSE_OVER="mouseover",a.MOUSE_OUT="mouseout",a.MOUSE_WHEEL="mousewheel",a.ROLL_OVER="mouseover",a.ROLL_OUT="mouseout",a.DOUBLE_CLICK="doubleclick",a.CHANGE="change",a.CHANGED="changed",a.RESIZE="resize",a.ADDED="added",a.REMOVED="removed",a.DISPLAY="display",a.UNDISPLAY="undisplay",a.ERROR="error",a.COMPLETE="complete",a.LOADED="loaded",a.READY="ready",a.PROGRESS="progress",a.INPUT="input",a.RENDER="render",a.OPEN="open",a.MESSAGE="message",a.CLOSE="close",a.KEY_DOWN="keydown",a.KEY_PRESS="keypress",a.KEY_UP="keyup",a.FRAME="enterframe",a.DRAG_START="dragstart",a.DRAG_MOVE="dragmove",a.DRAG_END="dragend",a.ENTER="enter",a.SELECT="select",a.BLUR="blur",a.FOCUS="focus",a.VISIBILITY_CHANGE="visibilitychange",a.FOCUS_CHANGE="focuschange",a.PLAYED="played",a.PAUSED="paused",a.STOPPED="stopped",a.START="start",a.END="end",a.COMPONENT_ADDED="componentadded",a.COMPONENT_REMOVED="componentremoved",a.RELEASED="released",a.LINK="link",a.LABEL="label",a.FULL_SCREEN_CHANGE="fullscreenchange",a.DEVICE_LOST="devicelost",a.TRANSFORM_CHANGED="transformchanged",a.ANIMATION_CHANGED="animationchanged",a.TRAIL_FILTER_CHANGE="trailfilterchange",a.TRIGGER_ENTER="triggerenter",a.TRIGGER_STAY="triggerstay",a.TRIGGER_EXIT="triggerexit"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{}e.LayaGL=r,r.ARRAY_BUFFER_TYPE_DATA=0,r.ARRAY_BUFFER_TYPE_CMD=1,r.ARRAY_BUFFER_REF_REFERENCE=0,r.ARRAY_BUFFER_REF_COPY=1,r.UPLOAD_SHADER_UNIFORM_TYPE_ID=0,r.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{constructor(t=1,e=0,i=0,r=1,a=0,n=0,o=0){if(this._bTransform=!1,null!=s._createFun)return s._createFun(t,e,i,r,a,n,o);this.a=t,this.b=e,this.c=i,this.d=r,this.tx=a,this.ty=n,this._checkTransform()}identity(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this._bTransform=!1,this}_checkTransform(){return this._bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d}setTranslate(t,e){return this.tx=t,this.ty=e,this}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this._bTransform=!0,this}rotate(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,s=this.c,a=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=s*e-this.d*i,this.d=s*i+this.d*e,this.tx=a*e-this.ty*i,this.ty=a*i+this.ty*e,this._bTransform=!0,this}skew(t,e){var i=Math.tan(t),r=Math.tan(e),s=this.a,a=this.b;return this.a+=r*this.c,this.b+=r*this.d,this.c+=i*s,this.d+=i*a,this}invertTransformPoint(t){var e=this.a,i=this.b,r=this.c,s=this.d,a=this.tx,n=e*s-i*r,o=s/n,l=-i/n,h=-r/n,u=e/n,c=(r*this.ty-s*a)/n,_=-(e*this.ty-i*a)/n;return t.setTo(o*t.x+h*t.y+c,l*t.x+u*t.y+_)}transformPoint(t){return t.setTo(this.a*t.x+this.c*t.y+this.tx,this.b*t.x+this.d*t.y+this.ty)}transformPointN(t){return t.setTo(this.a*t.x+this.c*t.y,this.b*t.x+this.d*t.y)}getScaleX(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)}getScaleY(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)}invert(){var t=this.a,e=this.b,i=this.c,r=this.d,s=this.tx,a=t*r-e*i;return this.a=r/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-r*s)/a,this.ty=-(t*this.ty-e*s)/a,this}setTo(t,e,i,r,s,a){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=s,this.ty=a,this}concat(t){var e=this.a,i=this.c,r=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d,this.tx=r*t.a+this.ty*t.c+t.tx,this.ty=r*t.b+this.ty*t.d+t.ty,this}static mul(t,e,i){var r=t.a,s=t.b,a=t.c,n=t.d,o=t.tx,l=t.ty,h=e.a,u=e.b,c=e.c,_=e.d,d=e.tx,f=e.ty;return 0!==u||0!==c?(i.a=r*h+s*c,i.b=r*u+s*_,i.c=a*h+n*c,i.d=a*u+n*_,i.tx=h*o+c*l+d,i.ty=u*o+_*l+f):(i.a=r*h,i.b=s*_,i.c=a*h,i.d=n*_,i.tx=h*o+d,i.ty=_*l+f),i}static mul16(t,e,i){var r=t.a,s=t.b,a=t.c,n=t.d,o=t.tx,l=t.ty,h=e.a,u=e.b,c=e.c,_=e.d,d=e.tx,f=e.ty;return 0!==u||0!==c?(i[0]=r*h+s*c,i[1]=r*u+s*_,i[4]=a*h+n*c,i[5]=a*u+n*_,i[12]=h*o+c*l+d,i[13]=u*o+_*l+f):(i[0]=r*h,i[1]=s*_,i[4]=a*h,i[5]=n*_,i[12]=h*o+d,i[13]=_*l+f),i}scaleEx(t,e){var i=this.a,r=this.b,s=this.c,a=this.d;0!==r||0!==s?(this.a=t*i,this.b=t*r,this.c=e*s,this.d=e*a):(this.a=t*i,this.b=0*a,this.c=0*i,this.d=e*a),this._bTransform=!0}rotateEx(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,s=this.b,a=this.c,n=this.d;0!==s||0!==a?(this.a=e*r+i*a,this.b=e*s+i*n,this.c=-i*r+e*a,this.d=-i*s+e*n):(this.a=e*r,this.b=i*n,this.c=-i*r,this.d=e*n),this._bTransform=!0}clone(){var t=s.create();return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t._bTransform=this._bTransform,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t._bTransform=this._bTransform,t}toString(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty}destroy(){this.recover()}recover(){r.Pool.recover("Matrix",this.identity())}static create(){return r.Pool.getItemByClass("Matrix",s)}}e.Matrix=s,s.EMPTY=new s,s.TEMP=new s,s._createFun=null},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{constructor(t=0,e=0){this.x=t,this.y=e}static create(){return r.Pool.getItemByClass("Point",s)}setTo(t,e){return this.x=t,this.y=e,this}reset(){return this.x=this.y=0,this}recover(){r.Pool.recover("Point",this.reset())}distance(t,e){return Math.sqrt((this.x-t)*(this.x-t)+(this.y-e)*(this.y-e))}toString(){return this.x+","+this.y}normalize(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t>0){var e=1/t;this.x*=e,this.y*=e}}copy(t){return this.setTo(t.x,t.y)}}e.Point=s,s.TEMP=new s,s.EMPTY=new s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(5),s=i(10),a=i(0);class n{static toRadian(t){return t*n._pi2}static toAngle(t){return t*n._pi}static toHexColor(t){if(t<0||isNaN(t))return null;for(var e=t.toString(16);e.length<6;)e="0"+e;return"#"+e}static getGID(){return n._gid++}static concatArray(t,e){if(!e)return t;if(!t)return e;var i,r=e.length;for(i=0;i<r;i++)t.push(e[i]);return t}static clearArray(t){return t?(t.length=0,t):t}static copyArray(t,e){if(t||(t=[]),!e)return t;t.length=e.length;var i,r=e.length;for(i=0;i<r;i++)t[i]=e[i];return t}static getGlobalRecByPoints(t,e,i,a,n){var o,l;o=r.Point.create().setTo(e,i),o=t.localToGlobal(o),l=r.Point.create().setTo(a,n),l=t.localToGlobal(l);var h=s.Rectangle._getWrapRec([o.x,o.y,l.x,l.y]);return o.recover(),l.recover(),h}static getGlobalPosAndScale(t){return n.getGlobalRecByPoints(t,0,0,1,1)}static bind(t,e){return t.bind(e)}static updateOrder(t){if(!t||t.length<2)return!1;for(var e,i,r,s=1,a=t.length;s<a;){for(r=t[e=s],i=t[e]._zOrder;--e>-1&&t[e]._zOrder>i;)t[e+1]=t[e];t[e+1]=r,s++}return!0}static transPointList(t,e,i){var r,s=t.length;for(r=0;r<s;r+=2)t[r]+=e,t[r+1]+=i}static parseInt(t,e=0){var i=parseInt(t,e);return isNaN(i)?0:i}static getFileExtension(t){n._extReg.lastIndex=t.lastIndexOf(".");var e=n._extReg.exec(t);return e&&e.length>1?e[1].toLowerCase():null}static getTransformRelativeToWindow(t,e,i){var r=n.gStage,s=n.getGlobalPosAndScale(t),a=r._canvasTransform.clone(),o=a.tx,l=a.ty;a.rotate(-Math.PI/180*r.canvasDegree),a.scale(r.clientScaleX,r.clientScaleY);var h,u,c,_,d=r.canvasDegree%180!=0;return d?(h=i+s.y,u=e+s.x,h*=a.d,u*=a.a,90==r.canvasDegree?(h=o-h,u+=l):(h+=o,u=l-u)):(h=e+s.x,u=i+s.y,h*=a.a,u*=a.d,h+=o,u+=l),u+=r._safariOffsetY,d?(c=a.d*s.height,_=a.a*s.width):(c=a.a*s.width,_=a.d*s.height),{x:h,y:u,scaleX:c,scaleY:_}}static fitDOMElementInArea(t,e,i,r,s,a){t._fitLayaAirInitialized||(t._fitLayaAirInitialized=!0,t.style.transformOrigin=t.style.webKittransformOrigin="left top",t.style.position="absolute");var o=n.getTransformRelativeToWindow(e,i,r);t.style.transform=t.style.webkitTransform="scale("+o.scaleX+","+o.scaleY+") rotate("+n.gStage.canvasDegree+"deg)",t.style.width=s+"px",t.style.height=a+"px",t.style.left=o.x+"px",t.style.top=o.y+"px"}static isOkTextureList(t){if(!t)return!1;var e,i,r=t.length;for(e=0;e<r;e++)if(!(i=t[e])||!i._getSource())return!1;return!0}static isOKCmdList(t){if(!t)return!1;var e,i=t.length;for(e=0;e<i;e++)t[e];return!0}static getQueryString(t){if(a.ILaya.Browser.onMiniGame)return null;if(!window.location||!window.location.search)return null;var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null}}e.Utils=n,n.gStage=null,n._gid=1,n._pi=180/Math.PI,n._pi2=Math.PI/180,n._extReg=/\.(\w+)\??/g,n.parseXMLFromString=function(t){var e;if(t=t.replace(/>\s+</g,"><"),(e=(new DOMParser).parseFromString(t,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors")>-1)throw new Error(e.firstChild.firstChild.textContent);return e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(3);class a{static __init__(){var t=s.LayaGL.instance;a._depthFunc=t.LESS,a._blendEquation=t.FUNC_ADD,a._blendEquationRGB=t.FUNC_ADD,a._blendEquationAlpha=t.FUNC_ADD,a._sFactor=t.ONE,a._dFactor=t.ZERO,a._sFactorAlpha=t.ONE,a._dFactorAlpha=t.ZERO,a._activedTextureID=t.TEXTURE0,a._glTextureIDs=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3,t.TEXTURE4,t.TEXTURE5,t.TEXTURE6,t.TEXTURE7]}static useProgram(t,e){return a._useProgram!==e&&(t.useProgram(e),a._useProgram=e,!0)}static setDepthTest(t,e){e!==a._depthTest&&(a._depthTest=e,e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST))}static setDepthMask(t,e){e!==a._depthMask&&(a._depthMask=e,t.depthMask(e))}static setDepthFunc(t,e){e!==a._depthFunc&&(a._depthFunc=e,t.depthFunc(e))}static setBlend(t,e){e!==a._blend&&(a._blend=e,e?t.enable(t.BLEND):t.disable(t.BLEND))}static setBlendEquation(t,e){e!==a._blendEquation&&(a._blendEquation=e,a._blendEquationRGB=a._blendEquationAlpha=null,t.blendEquation(e))}static setBlendEquationSeparate(t,e,i){e===a._blendEquationRGB&&i===a._blendEquationAlpha||(a._blendEquationRGB=e,a._blendEquationAlpha=i,a._blendEquation=null,t.blendEquationSeparate(e,i))}static setBlendFunc(t,e,i){e===a._sFactor&&i===a._dFactor||(a._sFactor=e,a._dFactor=i,a._sFactorRGB=null,a._dFactorRGB=null,a._sFactorAlpha=null,a._dFactorAlpha=null,t.blendFunc(e,i))}static setBlendFuncSeperate(t,e,i,r,s){e===a._sFactorRGB&&i===a._dFactorRGB&&r===a._sFactorAlpha&&s===a._dFactorAlpha||(a._sFactorRGB=e,a._dFactorRGB=i,a._sFactorAlpha=r,a._dFactorAlpha=s,a._sFactor=null,a._dFactor=null,t.blendFuncSeparate(e,i,r,s))}static setCullFace(t,e){e!==a._cullFace&&(a._cullFace=e,e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE))}static setFrontFace(t,e){e!==a._frontFace&&(a._frontFace=e,t.frontFace(e))}static activeTexture(t,e){a._activedTextureID!==e&&(t.activeTexture(e),a._activedTextureID=e)}static bindTexture(t,e,i){a._activeTextures[a._activedTextureID-t.TEXTURE0]!==i&&(t.bindTexture(e,i),a._activeTextures[a._activedTextureID-t.TEXTURE0]=i)}static __init_native(){if(r.ILaya.Render.supportWebGLPlusRendering){var t=a;t.activeTexture=t.activeTextureForNative,t.bindTexture=t.bindTextureForNative}}static useProgramForNative(t,e){return t.useProgram(e),!0}static setDepthTestForNative(t,e){e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)}static setDepthMaskForNative(t,e){t.depthMask(e)}static setDepthFuncForNative(t,e){t.depthFunc(e)}static setBlendForNative(t,e){e?t.enable(t.BLEND):t.disable(t.BLEND)}static setBlendFuncForNative(t,e,i){t.blendFunc(e,i)}static setCullFaceForNative(t,e){e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)}static setFrontFaceForNative(t,e){t.frontFace(e)}static activeTextureForNative(t,e){t.activeTexture(e)}static bindTextureForNative(t,e,i){t.bindTexture(e,i)}static bindVertexArrayForNative(t,e){t.bindVertexArray(e)}}e.WebGLContext=a,a._activeTextures=new Array(8),a._useProgram=null,a._depthTest=!0,a._depthMask=!0,a._blend=!1,a._cullFace=!1,a.mainContext=null},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0);class s{static __init__(){var t=window.Laya||r.ILaya.Laya;if(s._window)return s._window;var e=s._window=window,i=s._document=e.document,a=s.userAgent=e.navigator.userAgent,n=e.navigator.maxTouchPoints||0,o=e.navigator.platform;a.indexOf("AlipayMiniGame")>-1&&"my"in s.window&&(window.aliPayMiniGame(t,t),t.ALIMiniAdapter?t.ALIMiniAdapter.enable():console.error("请先添加阿里小游戏适配库")),-1==a.indexOf("OPPO")&&a.indexOf("MiniGame")>-1&&"wx"in s.window&&("qq"in s.window?(window.qqMiniGame(t,t),t.QQMiniAdapter?t.QQMiniAdapter.enable():console.error("请引入手机QQ小游戏的适配库：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")):(window.wxMiniGame(t,t),t.MiniAdpter?t.MiniAdpter.enable():console.error("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0"))),a.indexOf("MiniGame")>-1&&"qq"in s.window&&(window.qqMiniGame(t,t),t.QQMiniAdapter?t.QQMiniAdapter.enable():console.error("请先添加小游戏适配库,详细教程")),a.indexOf("SwanGame")>-1&&(window.bdMiniGame(t,t),t.BMiniAdapter?t.BMiniAdapter.enable():console.error("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),a.indexOf("QuickGame")>-1&&(window.miMiniGame(t,t),t.KGMiniAdapter?t.KGMiniAdapter.enable():console.error("请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),a.indexOf("OPPO")>-1&&a.indexOf("MiniGame")>-1&&(window.qgMiniGame(t,t),t.QGMiniAdapter?t.QGMiniAdapter.enable():console.error("请先添加OPPO小游戏适配库")),a.indexOf("VVGame")>-1&&(window.vvMiniGame(t,t),t.VVMiniAdapter?t.VVMiniAdapter.enable():console.error("请先添加VIVO小游戏适配库")),e.trace=console.log,e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return e.setTimeout(t,1e3/60)};var l=i.body.style;l.margin=0,l.overflow="hidden",l["-webkit-user-select"]="none",l["-webkit-tap-highlight-color"]="rgba(200,200,200,0)";for(var h=i.getElementsByTagName("meta"),u=0,c=!1,_="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no";u<h.length;){var d=h[u];if("viewport"==d.name){d.content=_,c=!0;break}u++}return c||((d=i.createElement("meta")).name="viewport",d.content=_,i.getElementsByTagName("head")[0].appendChild(d)),s.onMobile=!!window.isConchApp||a.indexOf("Mobile")>-1,s.onIOS=!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),s.onIPhone=a.indexOf("iPhone")>-1,s.onMac=a.indexOf("Mac OS X")>-1,s.onIPad=a.indexOf("iPad")>-1||"MacIntel"===o&&n>1,s.onAndroid=a.indexOf("Android")>-1||a.indexOf("Adr")>-1,s.onWP=a.indexOf("Windows Phone")>-1,s.onQQBrowser=a.indexOf("QQBrowser")>-1,s.onMQQBrowser=a.indexOf("MQQBrowser")>-1||a.indexOf("Mobile")>-1&&a.indexOf("QQ")>-1,s.onIE=!!e.ActiveXObject||"ActiveXObject"in e,s.onWeiXin=a.indexOf("MicroMessenger")>-1,s.onSafari=a.indexOf("Safari")>-1,s.onPC=!s.onMobile,s.onMiniGame=a.indexOf("MiniGame")>-1,s.onBDMiniGame=a.indexOf("SwanGame")>-1,s.onLayaRuntime=!!s.window.conch,a.indexOf("OPPO")>-1&&a.indexOf("MiniGame")>-1?(s.onQGMiniGame=!0,s.onMiniGame=!1):"qq"in s.window&&a.indexOf("MiniGame")>-1&&(s.onQQMiniGame=!0,s.onMiniGame=!1),s.onVVMiniGame=a.indexOf("VVGame")>-1,s.onKGMiniGame=a.indexOf("QuickGame")>-1,a.indexOf("AlipayMiniGame")>-1&&(s.onAlipayMiniGame=!0,s.onMiniGame=!1),e}static createElement(t){return s.__init__(),s._document.createElement(t)}static getElementById(t){return s.__init__(),s._document.getElementById(t)}static removeElement(t){t&&t.parentNode&&t.parentNode.removeChild(t)}static now(){return Date.now()}static get clientWidth(){return s.__init__(),s._window.innerWidth||s._document.body.clientWidth}static get clientHeight(){return s.__init__(),s._window.innerHeight||s._document.body.clientHeight||s._document.documentElement.clientHeight}static get width(){return s.__init__(),(r.ILaya.stage&&r.ILaya.stage.canvasRotation?s.clientHeight:s.clientWidth)*s.pixelRatio}static get height(){return s.__init__(),(r.ILaya.stage&&r.ILaya.stage.canvasRotation?s.clientWidth:s.clientHeight)*s.pixelRatio}static get pixelRatio(){return s._pixelRatio<0&&(s.__init__(),s.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1?s._pixelRatio=2:(s._pixelRatio=s._window.devicePixelRatio||1,s._pixelRatio<1&&(s._pixelRatio=1))),s._pixelRatio}static get container(){return s._container||(s.__init__(),s._container=s.createElement("div"),s._container.id="layaContainer",s._document.body.appendChild(s._container)),s._container}static set container(t){s._container=t}static get window(){return s._window||s.__init__()}static get document(){return s.__init__(),s._document}}e.Browser=s,s._pixelRatio=-1,s.mainCanvas=null,s.hanzi=new RegExp("^[一-龥]$"),s.fontMap=[],s.measureText=function(t,e){var i=s.hanzi.test(t);if(i&&s.fontMap[e])return s.fontMap[e];var r=s.context;r.font=e;var a=r.measureText(t);return i&&(s.fontMap[e]=a),a}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(4),s=i(43),a=i(0),n=i(150);class o{static regClass(t,e){o._classMap[t]=e}static regShortClassName(t){for(var e=0;e<t.length;e++){var i=t[e],r=i.name;o._classMap[r]=i}}static getRegClass(t){return o._classMap[t]}static getClass(t){var e=o._classMap[t]||o._classMap["Laya."+t]||t,i=a.ILaya.Laya;return"string"==typeof e?a.ILaya.__classMap[e]||i[t]:e}static getInstance(t){var e=o.getClass(t);return e?new e:(console.warn("[error] Undefined class:",t),null)}static createByJson(t,e=null,i=null,r=null,s=null){"string"==typeof t&&(t=JSON.parse(t));var a=t.props;if(!e&&!(e=s?s.runWith(t):o.getInstance(a.runtime||t.type)))return null;var n=t.child;if(n)for(var l=0,h=n.length;l<h;l++){var u=n[l];if("render"!==u.props.name&&"render"!==u.props.renderType||!e._$set_itemRender)if("Graphic"==u.type)o._addGraphicsToSprite(u,e);else if(o._isDrawType(u.type))o._addGraphicToSprite(u,e,!0);else{var c=o.createByJson(u,null,i,r,s);"Script"===u.type?"owner"in c?c.owner=e:"target"in c&&(c.target=e):"mask"==u.props.renderType?e.mask=c:e.addChild(c)}else e.itemRender=u}if(a)for(var _ in a){var d=a[_];"var"===_&&i?i[d]=e:d instanceof Array&&e[_]instanceof Function?e[_].apply(e,d):e[_]=d}return r&&t.customProps&&r.runWith([e,t]),e.created&&e.created(),e}static _addGraphicsToSprite(t,e){var i=t.child;if(i&&!(i.length<1)){var r,s,a=o._getGraphicsFromSprite(t,e),n=0,l=0;for(t.props&&(n=o._getObjVar(t.props,"x",0),l=o._getObjVar(t.props,"y",0)),0!=n&&0!=l&&a.translate(n,l),s=i.length,r=0;r<s;r++)o._addGraphicToGraphics(i[r],a);0!=n&&0!=l&&a.translate(-n,-l)}}static _addGraphicToSprite(t,e,i=!1){var r=i?o._getGraphicsFromSprite(t,e):e.graphics;o._addGraphicToGraphics(t,r)}static _getGraphicsFromSprite(t,e){if(!t||!t.props)return e.graphics;var i=t.props.renderType;if("hit"===i||"unHit"===i){var r=e._style.hitArea||(e.hitArea=new n.HitArea);r[i]||(r[i]=new s.Graphics);var a=r[i]}return a||(a=e.graphics),a}static _getTransformData(t){var e;("pivotX"in t||"pivotY"in t)&&(e=e||new r.Matrix).translate(-o._getObjVar(t,"pivotX",0),-o._getObjVar(t,"pivotY",0));var i=o._getObjVar(t,"scaleX",1),s=o._getObjVar(t,"scaleY",1),a=o._getObjVar(t,"rotation",0);o._getObjVar(t,"skewX",0),o._getObjVar(t,"skewY",0);return 1==i&&1==s&&0==a||((e=e||new r.Matrix).scale(i,s),e.rotate(.0174532922222222*a)),e}static _addGraphicToGraphics(t,e){var i,r;if((i=t.props)&&(r=o.DrawTypeDic[t.type])){var s=e,a=o._getParams(i,r[1],r[2],r[3]),n=o._tM;(n||1!=o._alpha)&&(s.save(),n&&s.transform(n),1!=o._alpha&&s.alpha(o._alpha)),s[r[0]].apply(s,a),(n||1!=o._alpha)&&s.restore()}}static _adptLineData(t){return t[2]=parseFloat(t[0])+parseFloat(t[2]),t[3]=parseFloat(t[1])+parseFloat(t[3]),t}static _adptTextureData(t){return t[0]=a.ILaya.Loader.getRes(t[0]),t}static _adptLinesData(t){return t[2]=o._getPointListByStr(t[2]),t}static _isDrawType(t){return"Image"!==t&&t in o.DrawTypeDic}static _getParams(t,e,i=0,r=null){var s,a,n,l=o._temParam;for(l.length=e.length,a=e.length,s=0;s<a;s++)l[s]=o._getObjVar(t,e[s][0],e[s][1]);return o._alpha=o._getObjVar(t,"alpha",1),(n=o._getTransformData(t))?(i||(i=0),n.translate(l[i],l[i+1]),l[i]=l[i+1]=0,o._tM=n):o._tM=null,r&&o[r]&&(l=o[r](l)),l}static _getPointListByStr(t){var e,i,r=t.split(",");for(i=r.length,e=0;e<i;e++)r[e]=parseFloat(r[e]);return r}static _getObjVar(t,e,i){return e in t?t[e]:i}}e.ClassUtils=o,o.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]},o._temParam=[],o._classMap={}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1),s=i(5);class a{constructor(t=0,e=0,i=0,r=0){this.x=t,this.y=e,this.width=i,this.height=r}get right(){return this.x+this.width}get bottom(){return this.y+this.height}setTo(t,e,i,r){return this.x=t,this.y=e,this.width=i,this.height=r,this}reset(){return this.x=this.y=this.width=this.height=0,this}recover(){this!=a.TEMP&&this!=a.EMPTY?r.Pool.recover("Rectangle",this.reset()):console.log("recover Temp or Empty:",this)}static create(){return r.Pool.getItemByClass("Rectangle",a)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}contains(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.right&&e>=this.y&&e<this.bottom)}intersects(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)}intersection(t,e=null){return this.intersects(t)?(e||(e=new a),e.x=Math.max(this.x,t.x),e.y=Math.max(this.y,t.y),e.width=Math.min(this.right,t.right)-e.x,e.height=Math.min(this.bottom,t.bottom)-e.y,e):null}union(t,e=null){return e||(e=new a),this.clone(e),t.width<=0||t.height<=0?e:(e.addPoint(t.x,t.y),e.addPoint(t.right,t.bottom),this)}clone(t=null){return t||(t=new a),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}toString(){return this.x+","+this.y+","+this.width+","+this.height}equals(t){return!(!t||t.x!==this.x||t.y!==this.y||t.width!==this.width||t.height!==this.height)}addPoint(t,e){return this.x>t&&(this.width+=this.x-t,this.x=t),this.y>e&&(this.height+=this.y-e,this.y=e),this.width<t-this.x&&(this.width=t-this.x),this.height<e-this.y&&(this.height=e-this.y),this}_getBoundPoints(){var t=a._temB;return t.length=0,0==this.width||0==this.height?t:(t.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),t)}static _getBoundPointS(t,e,i,r){var s=a._temA;return s.length=0,0==i||0==r?s:(s.push(t,e,t+i,e,t,e+r,t+i,e+r),s)}static _getWrapRec(t,e=null){if(!t||t.length<1)return e?e.setTo(0,0,0,0):a.TEMP.setTo(0,0,0,0);e=e||a.create();var i,r,n,o,l,h=t.length,u=s.Point.TEMP;for(n=l=-(r=o=99999),i=0;i<h;i+=2)u.x=t[i],u.y=t[i+1],r=r<u.x?r:u.x,o=o<u.y?o:u.y,n=n>u.x?n:u.x,l=l>u.y?l:u.y;return e.setTo(r,o,n-r,l-o)}isEmpty(){return this.width<=0||this.height<=0}}e.Rectangle=a,a.EMPTY=new a,a.TEMP=new a,a._temB=[],a._temA=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(115);class s extends r.ShaderDefinesBase{constructor(){super(s.__name2int,s.__int2name,s.__int2nameMap)}static __init__(){s.reg("TEXTURE2D",s.TEXTURE2D),s.reg("PRIMITIVE",s.PRIMITIVE),s.reg("GLOW_FILTER",s.FILTERGLOW),s.reg("BLUR_FILTER",s.FILTERBLUR),s.reg("COLOR_FILTER",s.FILTERCOLOR),s.reg("COLOR_ADD",s.COLORADD),s.reg("WORLDMAT",s.WORLDMAT),s.reg("FILLTEXTURE",s.FILLTEXTURE),s.reg("MVP3D",s.MVP3D)}static reg(t,e){this._reg(t,e,s.__name2int,s.__int2name)}static toText(t,e,i){return this._toText(t,e,i)}static toInt(t){return this._toInt(t,s.__name2int)}}e.ShaderDefines2D=s,s.TEXTURE2D=1,s.PRIMITIVE=4,s.FILTERGLOW=8,s.FILTERBLUR=16,s.FILTERCOLOR=32,s.COLORADD=64,s.WORLDMAT=128,s.FILLTEXTURE=256,s.SKINMESH=512,s.MVP3D=2048,s.NOOPTMASK=s.FILTERGLOW|s.FILTERBLUR|s.FILTERCOLOR|s.FILLTEXTURE,s.__name2int={},s.__int2name=[],s.__int2nameMap=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(16);class s{hasListener(t){return!!(this._events&&this._events[t])}event(t,e=null){if(!this._events||!this._events[t])return!1;var i=this._events[t];if(i.run)i.once&&delete this._events[t],null!=e?i.runWith(e):i.run();else{for(var r=0,s=i.length;r<s;r++){var a=i[r];a&&(null!=e?a.runWith(e):a.run()),a&&!a.once||(i.splice(r,1),r--,s--)}0===i.length&&this._events&&delete this._events[t]}return!0}on(t,e,i,r=null){return this._createListener(t,e,i,r,!1)}once(t,e,i,r=null){return this._createListener(t,e,i,r,!0)}_createListener(t,e,i,r,s,n=!0){n&&this.off(t,e,i,s);var o=a.create(e||this,i,r,s);this._events||(this._events={});var l=this._events;return l[t]?l[t].run?l[t]=[l[t],o]:l[t].push(o):l[t]=o,this}off(t,e,i,r=!1){if(!this._events||!this._events[t])return this;var s=this._events[t];if(null!=s)if(s.run)e&&s.caller!==e||null!=i&&s.method!==i||r&&!s.once||(delete this._events[t],s.recover());else{for(var a=0,n=0,o=s.length;n<o;n++){var l=s[n];l?!l||e&&l.caller!==e||null!=i&&l.method!==i||r&&!l.once||(a++,s[n]=null,l.recover()):a++}a===o&&delete this._events[t]}return this}offAll(t=null){var e=this._events;if(!e)return this;if(t)this._recoverHandlers(e[t]),delete e[t];else{for(var i in e)this._recoverHandlers(e[i]);this._events=null}return this}offAllCaller(t){if(t&&this._events)for(var e in this._events)this.off(e,t,null);return this}_recoverHandlers(t){if(t)if(t.run)t.recover();else for(var e=t.length-1;e>-1;e--)t[e]&&(t[e].recover(),t[e]=null)}isMouseEvent(t){return s.MOUSE_EVENTS[t]||!1}}e.EventDispatcher=s,s.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0};class a extends r.Handler{constructor(t,e,i,r){super(t,e,i,r)}recover(){this._id>0&&(this._id=0,a._pool.push(this.clear()))}static create(t,e,i=null,r=!0){return a._pool.length?a._pool.pop().setTo(t,e,i,r):new a(t,e,i,r)}}a._pool=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(31),s=i(117),a=i(11),n=i(18),o=i(0);class l{constructor(t,e){this.defines=new a.ShaderDefines2D,this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this.ref=1,this._cacheID=0,this.clipMatDir=[o.ILaya.Context._MAXSIZE,0,0,o.ILaya.Context._MAXSIZE],this.clipMatPos=[0,0],this.clipOff=[0,0],this.mainID=t,this.subID=e,this.textureHost=null,this.texture=null,this.color=null,this.colorAdd=null,this.u_mmat2=null,this._cacheID=t|e,this._inClassCache=l._cache[this._cacheID],t>0&&!this._inClassCache&&(this._inClassCache=l._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}static _initone(t,e){l._typeClass[t]=e,l._cache[t]=[],l._cache[t]._length=0}static __init__(){}setValue(t){}_ShaderWithCompile(){return r.Shader.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,s.Shader2X.create,this._attribLocation)}upload(){var t=n.RenderState2D;n.RenderState2D.worldMatrix4===n.RenderState2D.TEMPMAT4_ARRAY||this.defines.addInt(a.ShaderDefines2D.WORLDMAT),this.mmat=t.worldMatrix4,n.RenderState2D.matWVP&&(this.defines.addInt(a.ShaderDefines2D.MVP3D),this.u_MvpMatrix=n.RenderState2D.matWVP.elements);var e=r.Shader.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height?(this.size[0]=t.width,this.size[1]=t.height,e._shaderValueWidth=t.width,e._shaderValueHeight=t.height,e.upload(this,null)):e.upload(this,e._params2dQuick2||e._make2dQuick2())}setFilters(t){if(this.filters=t,t)for(var e,i=t.length,r=0;r<i;r++)(e=t[r])&&(this.defines.add(e.type),e.action.setValue(this))}clear(){this.defines._value=this.subID,this.clipOff[0]=0}release(){--this.ref<1&&(this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this),this.clear(),this.filters=null,this.ref=1,this.clipOff[0]=0)}static create(t,e){var i=l._cache[t|e];return i._length?i[--i._length]:new l._typeClass[t|e](e)}}e.Value2D=l,l._cache=[],l._typeClass=[],l.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0);class s{constructor(t){this._url=s.formatURL(t),this._path=s.getPath(t)}get url(){return this._url}get path(){return this._path}static set basePath(t){s._basePath=r.ILaya.Laya._getUrlPath(),s._basePath=s.formatURL(t)}static get basePath(){return s._basePath}static formatURL(t){if(!t)return"null path";if(t.indexOf(":")>0)return t;if(null!=s.customFormat&&(t=s.customFormat(t)),t.indexOf(":")>0)return t;var e=t.charAt(0);if("."===e)return s._formatRelativePath(s._basePath+t);if("~"===e)return s.rootPath+t.substring(1);if("d"===e){if(0===t.indexOf("data:image"))return t}else if("/"===e)return t;return s._basePath+t}static _formatRelativePath(t){for(var e=t.split("/"),i=0,r=e.length;i<r;i++)".."==e[i]&&(e.splice(i-1,2),i-=2);return e.join("/")}static getPath(t){var e=t.lastIndexOf("/");return e>0?t.substr(0,e+1):""}static getFileName(t){var e=t.lastIndexOf("/");return e>0?t.substr(e+1):t}static getAdptedFilePath(t){if(!s.exportSceneToJson||!t)return t;var e,i,r;for(i=s._adpteTypeList.length,e=0;e<i;e++)r=s._adpteTypeList[e],t=t.replace(r[0],r[1]);return t}}e.URL=s,s.version={},s.exportSceneToJson=!1,s._basePath="",s.rootPath="",s.customFormat=function(t){var e=s.version[t];return!window.conch&&e&&(t+="?v="+e),t},s._adpteTypeList=[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static show(t=0,e=0){r._StatRender.show(t,e)}static enable(){r._StatRender.enable()}static hide(){r._StatRender.hide()}static clear(){r.trianglesFaces=r.renderBatches=r.savedRenderBatches=r.shaderCall=r.spriteRenderUseCacheCount=r.frustumCulling=r.octreeNodeCulling=r.canvasNormal=r.canvasBitmap=r.canvasReCache=0}static set onclick(t){r._StatRender.set_onclick(t)}}e.Stat=r,r.FPS=0,r.loopCount=0,r.shaderCall=0,r.renderBatches=0,r.savedRenderBatches=0,r.trianglesFaces=0,r.spriteCount=0,r.spriteRenderUseCacheCount=0,r.frustumCulling=0,r.octreeNodeCulling=0,r.canvasNormal=0,r.canvasBitmap=0,r.canvasReCache=0,r.renderSlow=!1,r._fpsData=[],r._timer=0,r._count=0,r._StatRender=null},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{constructor(t=null,e=null,i=null,r=!1){this.once=!1,this._id=0,this.setTo(t,e,i,r)}setTo(t,e,i,s=!1){return this._id=r._gid++,this.caller=t,this.method=e,this.args=i,this.once=s,this}run(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e}runWith(t){if(null==this.method)return null;var e=this._id;if(null==t)var i=this.method.apply(this.caller,this.args);else i=this.args||t.unshift?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===e&&this.once&&this.recover(),i}clear(){return this.caller=null,this.method=null,this.args=null,this}recover(){this._id>0&&(this._id=0,r._pool.push(this.clear()))}static create(t,e,i=null,s=!0){return r._pool.length?r._pool.pop().setTo(t,e,i,s):new r(t,e,i,s)}}e.Handler=r,r._pool=[],r._gid=1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(12),a=i(10),n=i(16),o=i(0);class l extends s.EventDispatcher{constructor(t=null,e=null,i=0,r=0){super(),this.uvrect=[0,0,1,1],this._destroyed=!1,this._referenceCount=0,this.$_GID=0,this.offsetX=0,this.offsetY=0,this._w=0,this._h=0,this.sourceWidth=0,this.sourceHeight=0,this.url=null,this.scaleRate=1,this.setTo(t,e,i,r)}static moveUV(t,e,i){for(var r=0;r<8;r+=2)i[r]+=t,i[r+1]+=e;return i}static create(t,e,i,r,s,a=0,n=0,o=0,h=0){return l._create(t,e,i,r,s,a,n,o,h)}static _create(t,e,i,r,s,a=0,n=0,o=0,h=0,u=null){var c,_=t instanceof l,d=_?t.uv:l.DEF_UV,f=_?t.bitmap:t;f.width&&e+r>f.width&&(r=f.width-e),f.height&&i+s>f.height&&(s=f.height-i),u?(c=u).setTo(f,null,o||r,h||s):c=new l(f,null,o||r,h||s),c.width=r,c.height=s,c.offsetX=a,c.offsetY=n;var p=1/f.width,m=1/f.height;e*=p,i*=m,r*=p,s*=m;var g=c.uv[0],v=c.uv[1],y=c.uv[4],x=c.uv[5],T=y-g,b=x-v,E=l.moveUV(d[0],d[1],[e,i,e+r,i,e+r,i+s,e,i+s]);c.uv=new Float32Array([g+E[0]*T,v+E[1]*b,y-(1-E[2])*T,v+E[3]*b,y-(1-E[4])*T,x-(1-E[5])*b,g+E[6]*T,x-(1-E[7])*b]);var C=f.scaleRate;return C&&1!=C?(c.sourceWidth/=C,c.sourceHeight/=C,c.width/=C,c.height/=C,c.scaleRate=C):c.scaleRate=1,c}static createFromTexture(t,e,i,r,s){var n=t.scaleRate;1!=n&&(e*=n,i*=n,r*=n,s*=n);var o=a.Rectangle.TEMP.setTo(e-t.offsetX,i-t.offsetY,r,s),h=o.intersection(l._rect1.setTo(0,0,t.width,t.height),l._rect2);return h?l.create(t,h.x,h.y,h.width,h.height,h.x-o.x,h.y-o.y,r,s):null}get uv(){return this._uv}set uv(t){this.uvrect[0]=Math.min(t[0],t[2],t[4],t[6]),this.uvrect[1]=Math.min(t[1],t[3],t[5],t[7]),this.uvrect[2]=Math.max(t[0],t[2],t[4],t[6])-this.uvrect[0],this.uvrect[3]=Math.max(t[1],t[3],t[5],t[7])-this.uvrect[1],this._uv=t}get width(){return this._w?this._w:this.bitmap?this.uv&&this.uv!==l.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width:0}set width(t){this._w=t,this.sourceWidth||(this.sourceWidth=t)}get height(){return this._h?this._h:this.bitmap?this.uv&&this.uv!==l.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height:0}set height(t){this._h=t,this.sourceHeight||(this.sourceHeight=t)}get bitmap(){return this._bitmap}set bitmap(t){this._bitmap&&this._bitmap._removeReference(this._referenceCount),this._bitmap=t,t&&t._addReference(this._referenceCount)}get destroyed(){return this._destroyed}_addReference(){this._bitmap&&this._bitmap._addReference(),this._referenceCount++}_removeReference(){this._bitmap&&this._bitmap._removeReference(),this._referenceCount--}_getSource(t=null){return this._destroyed||!this._bitmap?null:(this.recoverBitmap(t),this._bitmap.destroyed?null:this.bitmap._getSource())}_onLoaded(t,e){if(e)if(e==this);else if(e instanceof l){var i=e;l._create(e,0,0,i.width,i.height,0,0,i.sourceWidth,i.sourceHeight,this)}else this.bitmap=e,this.sourceWidth=this._w=e.width,this.sourceHeight=this._h=e.height;else;t&&t.run(),this.event(r.Event.READY,this)}getIsReady(){return!this._destroyed&&!!this._bitmap}setTo(t=null,e=null,i=0,r=0){this.bitmap=t,this.sourceWidth=i,this.sourceHeight=r,t&&(this._w=t.width,this._h=t.height,this.sourceWidth=this.sourceWidth||t.width,this.sourceHeight=this.sourceHeight||t.height),this.uv=e||l.DEF_UV}load(t,e=null){this._destroyed||o.ILaya.loader.load(t,n.Handler.create(this,this._onLoaded,[e]),null,"htmlimage",1,!0)}getTexturePixels(t,e,i,r){var s,a,n,l=this.bitmap,h=l.width,u=l.height;if(t+i>h&&(i-=t+i-h),e+r>u&&(r-=e+r-u),i<=0||r<=0)return null;var c=4*i,_=null;try{_=l.getPixels()}catch(t){}if(_){if(0==t&&0==e&&i==h&&r==u)return _;var d=new Uint8Array(i*r*4);for(s=4*t,a=(e+r-1)*(c=4*h)+4*t,n=r-1;n>=0;n--)d.set(x.slice(a,a+4*i),s),s+=c,a-=c;return d}var f=new o.ILaya.Context;f.size(i,r),f.asBitmap=!0;var p=null;if(0!=t||0!=e||i!=h||r!=u){var m=(p=this._uv.slice())[0],g=p[1],v=(p[2]-m)/h,y=(p[7]-g)/u;p=[m+t*v,g+e*y,m+(t+i)*v,g+e*y,m+(t+i)*v,g+(e+r)*y,m+t*v,g+(e+r)*y]}f._drawTextureM(this,0,0,i,r,null,1,p),f._targets.start(),f.flush(),f._targets.end(),f._targets.restore();var x=f._targets.getData(0,0,i,r);for(f.destroy(),d=new Uint8Array(i*r*4),s=0,a=(r-1)*c,n=r-1;n>=0;n--)d.set(x.slice(a,a+c),s),s+=c,a-=c;return d}getPixels(t,e,i,r){return window.conch?this._nativeObj.getImageData(t,e,i,r):this.getTexturePixels(t,e,i,r)}recoverBitmap(t=null){var e=this._bitmap.url;this._destroyed||this._bitmap&&!this._bitmap.destroyed||!e||o.ILaya.loader.load(e,n.Handler.create(this,(function(e){this.bitmap=e,t&&t()})),null,"htmlimage",1,!0)}disposeBitmap(){!this._destroyed&&this._bitmap&&this._bitmap.destroy()}destroy(t=!1){if(!this._destroyed){this._destroyed=!0;var e=this._bitmap;e&&(e._removeReference(this._referenceCount),(0===e.referenceCount||t)&&e.destroy(),e=null),this.url&&this===o.ILaya.loader.getRes(this.url)&&o.ILaya.Loader.clearRes(this.url)}}}e.Texture=l,l.DEF_UV=new Float32Array([0,0,1,0,1,1,0,1]),l.NO_UV=new Float32Array([0,0,0,0,0,0,0,0]),l.INV_UV=new Float32Array([0,1,1,1,1,0,0,0]),l._rect1=new a.Rectangle,l._rect2=new a.Rectangle},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(4);class s{static mat2MatArray(t,e){var i=t,r=e;return r[0]=i.a,r[1]=i.b,r[2]=s.EMPTYMAT4_ARRAY[2],r[3]=s.EMPTYMAT4_ARRAY[3],r[4]=i.c,r[5]=i.d,r[6]=s.EMPTYMAT4_ARRAY[6],r[7]=s.EMPTYMAT4_ARRAY[7],r[8]=s.EMPTYMAT4_ARRAY[8],r[9]=s.EMPTYMAT4_ARRAY[9],r[10]=s.EMPTYMAT4_ARRAY[10],r[11]=s.EMPTYMAT4_ARRAY[11],r[12]=i.tx,r[13]=i.ty,r[14]=s.EMPTYMAT4_ARRAY[14],r[15]=s.EMPTYMAT4_ARRAY[15],e}static restoreTempArray(){s.TEMPMAT4_ARRAY[0]=1,s.TEMPMAT4_ARRAY[1]=0,s.TEMPMAT4_ARRAY[4]=0,s.TEMPMAT4_ARRAY[5]=1,s.TEMPMAT4_ARRAY[12]=0,s.TEMPMAT4_ARRAY[13]=0}static clear(){s.worldScissorTest=!1,s.worldAlpha=1}}e.RenderState2D=s,s._MAXSIZE=99999999,s.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s.worldMatrix4=s.TEMPMAT4_ARRAY,s.worldMatrix=new r.Matrix,s.matWVP=null,s.worldAlpha=1,s.worldScissorTest=!1,s.width=0,s.height=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(7);class s{static _init_(t){s.fns=[s.BlendNormal,s.BlendAdd,s.BlendMultiply,s.BlendScreen,s.BlendOverlay,s.BlendLight,s.BlendMask,s.BlendDestinationOut],s.targetFns=[s.BlendNormalTarget,s.BlendAddTarget,s.BlendMultiplyTarget,s.BlendScreenTarget,s.BlendOverlayTarget,s.BlendLightTarget,s.BlendMask,s.BlendDestinationOut]}static BlendNormal(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA)}static BlendAdd(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.DST_ALPHA)}static BlendMultiply(t){r.WebGLContext.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA)}static BlendScreen(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.ONE)}static BlendOverlay(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR)}static BlendLight(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.ONE)}static BlendNormalTarget(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA)}static BlendAddTarget(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.DST_ALPHA)}static BlendMultiplyTarget(t){r.WebGLContext.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA)}static BlendScreenTarget(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.ONE)}static BlendOverlayTarget(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR)}static BlendLightTarget(t){r.WebGLContext.setBlendFunc(t,t.ONE,t.ONE)}static BlendMask(t){r.WebGLContext.setBlendFunc(t,t.ZERO,t.SRC_ALPHA)}static BlendDestinationOut(t){r.WebGLContext.setBlendFunc(t,t.ZERO,t.ZERO)}}e.BlendMode=s,s.activeBlendFunction=null,s.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],s.TOINT={normal:0,add:1,multiply:2,screen:3,overlay:4,light:5,mask:6,"destination-out":7,lighter:1},s.NORMAL="normal",s.ADD="add",s.MULTIPLY="multiply",s.SCREEN="screen",s.OVERLAY="overlay",s.LIGHT="light",s.MASK="mask",s.DESTINATIONOUT="destination-out",s.LIGHTER="lighter",s.fns=[],s.targetFns=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(6);class s{constructor(t){if(this.arrColor=[],null==t)return this.strColor="#00000000",this.numColor=0,void(this.arrColor=[0,0,0,0]);var e,i,a;if("string"==typeof t)if(t.indexOf("rgba(")>=0||t.indexOf("rgb(")>=0){var n,o,l=t;for(n=l.indexOf("("),o=l.indexOf(")"),l=l.substring(n+1,o),this.arrColor=l.split(","),i=this.arrColor.length,e=0;e<i;e++)this.arrColor[e]=parseFloat(this.arrColor[e]),e<3&&(this.arrColor[e]=Math.round(this.arrColor[e]));a=4==this.arrColor.length?256*(256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2])+Math.round(255*this.arrColor[3]):256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2],this.strColor=t}else{if(this.strColor=t,"#"===t.charAt(0)&&(t=t.substr(1)),3===(i=t.length)||4===i){var h="";for(e=0;e<i;e++)h+=t[e]+t[e];t=h}a=parseInt(t,16)}else a=t,this.strColor=r.Utils.toHexColor(a);this.strColor.indexOf("rgba")>=0||9===this.strColor.length?(this.arrColor=[((4278190080&a)>>>24)/255,((16711680&a)>>16)/255,((65280&a)>>8)/255,(255&a)/255],this.numColor=(4278190080&a)>>>24|(16711680&a)>>8|(65280&a)<<8|(255&a)<<24):(this.arrColor=[((16711680&a)>>16)/255,((65280&a)>>8)/255,(255&a)/255,1],this.numColor=4278190080|(16711680&a)>>16|65280&a|(255&a)<<16),this.arrColor.__id=++s._COLODID}static _initDefault(){for(var t in s._DEFAULT={},s._COLOR_MAP)s._SAVE[t]=s._DEFAULT[t]=new s(s._COLOR_MAP[t]);return s._DEFAULT}static _initSaveMap(){for(var t in s._SAVE_SIZE=0,s._SAVE={},s._DEFAULT)s._SAVE[t]=s._DEFAULT[t]}static create(t){var e=t+"",i=s._SAVE[e];return null!=i?i:(s._SAVE_SIZE<1e3&&s._initSaveMap(),s._SAVE[e]=new s(t))}}e.ColorUtils=s,s._SAVE={},s._SAVE_SIZE=0,s._COLOR_MAP={purple:"#800080",orange:"#ffa500",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#808080"},s._DEFAULT=s._initDefault(),s._COLODID=1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(40),s=i(13);class a{constructor(t=a.TYPE_2D){this.clipInfoID=-1,this._mesh=null,this._blendFn=null,this._id=0,this._renderType=0,this._parent=null,this._key=new r.SubmitKey,this._startIdx=0,this._numEle=0,this._ref=1,this.shaderValue=null,this._renderType=t,this._id=++a.ID}static __init__(){var t=a.RENDERBASE=new a(-1);t.shaderValue=new s.Value2D(0,0),t.shaderValue.ALPHA=1,t._ref=4294967295}getID(){return this._id}getRenderType(){return this._renderType}toString(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key}renderSubmit(){return 1}releaseRender(){}}e.SubmitBase=a,a.TYPE_2D=1e4,a.TYPE_CANVAS=10003,a.TYPE_CMDSETRT=10004,a.TYPE_CUSTOM=10005,a.TYPE_BLURRT=10006,a.TYPE_CMDDESTORYPRERT=10007,a.TYPE_DISABLESTENCIL=10008,a.TYPE_OTHERIBVB=10009,a.TYPE_PRIMITIVE=10010,a.TYPE_RT=10011,a.TYPE_BLUR_RT=10012,a.TYPE_TARGET=10013,a.TYPE_CHANGE_VALUE=10014,a.TYPE_SHAPE=10015,a.TYPE_TEXTURE=10016,a.TYPE_FILLTEXTURE=10017,a.KEY_ONCE=-1,a.KEY_FILLRECT=1,a.KEY_DRAWTEXTURE=2,a.KEY_VG=3,a.KEY_TRIANGLES=4,a.ID=1,a.preRender=null},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{}e.Const=r,r.NOT_ACTIVE=1,r.ACTIVE_INHIERARCHY=2,r.AWAKED=4,r.NOT_READY=8,r.DISPLAY=16,r.HAS_ZORDER=32,r.HAS_MOUSE=64,r.DISPLAYED_INSTAGE=128,r.DRAWCALL_OPTIMIZE=256},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(3),a=i(7),n=i(39),o=i(46);class l extends n.BaseTexture{constructor(t=0,e=0,i=o.TextureFormat.R8G8B8A8,r=!0,a=!1){super(i,r);var n=s.LayaGL.instance;this._glTextureType=n.TEXTURE_2D,this._width=t,this._height=e,this._canRead=a,this._setWarpMode(n.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(n.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel);var l=this._gpuCompressFormat();if(r){var h=Math.max(Math.ceil(Math.log2(t))+1,Math.ceil(Math.log2(e))+1);if(!l)for(var u=0;u<h;u++)this._setPixels(null,u,Math.max(t>>u,1),Math.max(e>>u,1));this._mipmapCount=h,this._setGPUMemory(t*e*4*(1+1/3))}else l||this._setPixels(null,0,t,e),this._mipmapCount=1,this._setGPUMemory(t*e*4)}static __init__(){var t=new Uint8Array(3);t[0]=128,t[1]=128,t[2]=128,l.grayTexture=new l(1,1,o.TextureFormat.R8G8B8,!1,!1),l.grayTexture.setPixels(t),l.grayTexture.lock=!0,t[0]=255,t[1]=255,t[2]=255,l.whiteTexture=new l(1,1,o.TextureFormat.R8G8B8,!1,!1),l.whiteTexture.setPixels(t),l.whiteTexture.lock=!0,t[0]=0,t[1]=0,t[2]=0,l.blackTexture=new l(1,1,o.TextureFormat.R8G8B8,!1,!1),l.blackTexture.setPixels(t),l.blackTexture.lock=!0}static _parse(t,e=null,i=null){var r=i?new l(i[0],i[1],i[2],i[3],i[4]):new l(0,0);switch(e&&(r.wrapModeU=e.wrapModeU,r.wrapModeV=e.wrapModeV,r.filterMode=e.filterMode,r.anisoLevel=e.anisoLevel),r._format){case o.TextureFormat.R8G8B8:case o.TextureFormat.R8G8B8A8:r.loadImageSource(t);break;case o.TextureFormat.DXT1:case o.TextureFormat.DXT5:case o.TextureFormat.ETC1RGB:case o.TextureFormat.PVRTCRGB_2BPPV:case o.TextureFormat.PVRTCRGBA_2BPPV:case o.TextureFormat.PVRTCRGB_4BPPV:case o.TextureFormat.PVRTCRGBA_4BPPV:r.setCompressData(t);break;default:throw"Texture2D:unkonwn format."}return r}static load(t,e){r.ILaya.loader.create(t,e,null,r.ILaya.Loader.TEXTURE2D)}get defaulteTexture(){return l.grayTexture}_gpuCompressFormat(){return this._format==o.TextureFormat.DXT1||this._format==o.TextureFormat.DXT5||this._format==o.TextureFormat.ETC1RGB||this._format==o.TextureFormat.PVRTCRGB_2BPPV||this._format==o.TextureFormat.PVRTCRGBA_2BPPV||this._format==o.TextureFormat.PVRTCRGB_4BPPV||this._format==o.TextureFormat.PVRTCRGBA_4BPPV}_setPixels(t,e,i,r){var n=s.LayaGL.instance,l=this._glTextureType,h=this._getGLFormat();switch(a.WebGLContext.bindTexture(n,l,this._glTexture),this.format){case o.TextureFormat.R8G8B8:n.pixelStorei(n.UNPACK_ALIGNMENT,1),n.texImage2D(l,e,h,i,r,0,h,n.UNSIGNED_BYTE,t),n.pixelStorei(n.UNPACK_ALIGNMENT,4);break;case o.TextureFormat.R32G32B32A32:s.LayaGL.layaGPUInstance._isWebGL2?n.texImage2D(l,e,n.RGBA32F,i,r,0,h,n.FLOAT,t):n.texImage2D(l,e,n.RGBA,i,r,0,h,n.FLOAT,t);break;default:n.texImage2D(l,e,h,i,r,0,h,n.UNSIGNED_BYTE,t)}}_calcualatesCompressedDataSize(t,e,i){switch(t){case o.TextureFormat.DXT1:case o.TextureFormat.ETC1RGB:return(e+3>>2)*(i+3>>2)*8;case o.TextureFormat.DXT5:return(e+3>>2)*(i+3>>2)*16;case o.TextureFormat.PVRTCRGB_4BPPV:case o.TextureFormat.PVRTCRGBA_4BPPV:return Math.floor((Math.max(e,8)*Math.max(i,8)*4+7)/8);case o.TextureFormat.PVRTCRGB_2BPPV:case o.TextureFormat.PVRTCRGBA_2BPPV:return Math.floor((Math.max(e,16)*Math.max(i,8)*2+7)/8);default:return 0}}_pharseDDS(t){var e=new Int32Array(t,0,31);if(542327876!=e[0])throw"Invalid magic number in DDS header";if(!(4&e[20]))throw"Unsupported format, must contain a FourCC code";var i=e[21];switch(this._format){case o.TextureFormat.DXT1:if(827611204!==i)throw"the FourCC code is not same with texture format.";break;case o.TextureFormat.DXT5:if(894720068!==i)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format."}var r=1;if(131072&e[2]){if(r=Math.max(1,e[7]),!this._mipmap)throw"the mipmap is not same with Texture2D."}else if(this._mipmap)throw"the mipmap is not same with Texture2D.";var s=e[4],a=e[3];this._width=s,this._height=a;var n=e[1]+4;this._upLoadCompressedTexImage2D(t,s,a,r,n,0)}_pharseKTX(t){var e=new Uint8Array(t,0,12);if(171!=e[0]||75!=e[1]||84!=e[2]||88!=e[3]||32!=e[4]||49!=e[5]||49!=e[6]||187!=e[7]||13!=e[8]||10!=e[9]||26!=e[10]||10!=e[11])throw"Invalid fileIdentifier in KTX header";var i=new Int32Array(e.buffer,e.length,13);switch(i[4]){case s.LayaGL.layaGPUInstance._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL:this._format=o.TextureFormat.ETC1RGB;break;default:throw"unknown texture format."}var r=i[11],a=i[6],n=i[7];this._width=a,this._height=n;var l=64+i[12];this._upLoadCompressedTexImage2D(t,a,n,r,l,4)}_pharsePVR(t){var e=new Int32Array(t,0,13);if(55727696!=e[0])throw"Invalid magic number in PVR header";switch(e[2]){case 0:this._format=o.TextureFormat.PVRTCRGB_2BPPV;break;case 2:this._format=o.TextureFormat.PVRTCRGB_4BPPV;break;case 1:this._format=o.TextureFormat.PVRTCRGBA_2BPPV;break;case 3:this._format=o.TextureFormat.PVRTCRGBA_4BPPV;break;default:throw"Texture2D:unknown PVR format."}var i=e[11],r=e[7],s=e[6];this._width=r,this._height=s;var a=e[12]+52;this._upLoadCompressedTexImage2D(t,r,s,i,a,0)}_upLoadCompressedTexImage2D(t,e,i,r,n,o){var l=s.LayaGL.instance,h=this._glTextureType;a.WebGLContext.bindTexture(l,h,this._glTexture);for(var u=this._getGLFormat(),c=n,_=0;_<r;_++){c+=o;var d=this._calcualatesCompressedDataSize(this._format,e,i),f=new Uint8Array(t,c,d);l.compressedTexImage2D(h,_,u,e,i,0,f),e=Math.max(e>>1,1),i=Math.max(i>>1,1),c+=d}var p=c;this._setGPUMemory(p),this._readyed=!0,this._activeResource()}loadImageSource(t,e=!1){var i=s.LayaGL.instance,n=t.width,o=t.height;this._width=n,this._height=o,this._isPot(n)&&this._isPot(o)||(this._mipmap=!1),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),a.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture);var l=this._getGLFormat();r.ILaya.Render.isConchApp?(t.setPremultiplyAlpha&&t.setPremultiplyAlpha(e),i.texImage2D(this._glTextureType,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t)):(e&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(this._glTextureType,0,l,l,i.UNSIGNED_BYTE,t),e&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)),this._mipmap?(i.generateMipmap(this._glTextureType),this._setGPUMemory(n*o*4*(1+1/3))):this._setGPUMemory(n*o*4),this._canRead&&(r.ILaya.Render.isConchApp?this._pixels=new Uint8Array(t._nativeObj.getImageData(0,0,n,o)):(r.ILaya.Browser.canvas.size(n,o),r.ILaya.Browser.canvas.clear(),r.ILaya.Browser.context.drawImage(t,0,0,n,o),this._pixels=new Uint8Array(r.ILaya.Browser.context.getImageData(0,0,n,o).data.buffer))),this._readyed=!0,this._activeResource()}setPixels(t,e=0){if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!t)throw"Texture2D:pixels can't be null.";var i=Math.max(this._width>>e,1),r=Math.max(this._height>>e,1),s=i*r*this._getFormatByteCount();if(t.length<s)throw"Texture2D:pixels length should at least "+s+".";this._setPixels(t,e,i,r),this._canRead&&(this._pixels=t),this._readyed=!0,this._activeResource()}setSubPixels(t,e,i,r,n,l=0){if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!n)throw"Texture2D:pixels can't be null.";var h=s.LayaGL.instance,u=this._glTextureType;a.WebGLContext.bindTexture(h,u,this._glTexture);var c=this._getGLFormat();switch(this.format){case o.TextureFormat.R8G8B8:h.pixelStorei(h.UNPACK_ALIGNMENT,1),h.texSubImage2D(u,l,t,e,i,r,c,h.UNSIGNED_BYTE,n),h.pixelStorei(h.UNPACK_ALIGNMENT,4);break;case o.TextureFormat.R32G32B32A32:h.texSubImage2D(u,l,t,e,i,r,c,h.FLOAT,n);break;default:h.texSubImage2D(u,l,t,e,i,r,c,h.UNSIGNED_BYTE,n)}this._readyed=!0,this._activeResource()}setCompressData(t){switch(this._format){case o.TextureFormat.DXT1:case o.TextureFormat.DXT5:this._pharseDDS(t);break;case o.TextureFormat.ETC1RGB:this._pharseKTX(t);break;case o.TextureFormat.PVRTCRGB_2BPPV:case o.TextureFormat.PVRTCRGBA_2BPPV:case o.TextureFormat.PVRTCRGB_4BPPV:case o.TextureFormat.PVRTCRGBA_4BPPV:this._pharsePVR(t);break;default:throw"Texture2D:unkonwn format."}}_recoverResource(){}getPixels(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")}}e.Texture2D=l,l.TEXTURE2D="TEXTURE2D",l.grayTexture=null,l.whiteTexture=null,l.blackTexture=null},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(12),a=i(14);class n extends s.EventDispatcher{constructor(){super(),this._id=0,this._url=null,this._cpuMemory=0,this._gpuMemory=0,this._destroyed=!1,this._referenceCount=0,this.lock=!1,this.name=null,this._id=++n._uniqueIDCounter,this._destroyed=!1,this._referenceCount=0,n._idResourcesMap[this.id]=this,this.lock=!1}static get cpuMemory(){return n._cpuMemory}static get gpuMemory(){return n._gpuMemory}static _addCPUMemory(t){n._cpuMemory+=t}static _addGPUMemory(t){n._gpuMemory+=t}static _addMemory(t,e){n._cpuMemory+=t,n._gpuMemory+=e}static getResourceByID(t){return n._idResourcesMap[t]}static getResourceByURL(t,e=0){return n._urlResourcesMap[t][e]}static destroyUnusedResources(){for(var t in n._idResourcesMap){var e=n._idResourcesMap[t];e.lock||0!==e._referenceCount||e.destroy()}}get id(){return this._id}get url(){return this._url}get cpuMemory(){return this._cpuMemory}get gpuMemory(){return this._gpuMemory}get destroyed(){return this._destroyed}get referenceCount(){return this._referenceCount}_setCPUMemory(t){var e=t-this._cpuMemory;this._cpuMemory=t,n._addCPUMemory(e)}_setGPUMemory(t){var e=t-this._gpuMemory;this._gpuMemory=t,n._addGPUMemory(e)}_setCreateURL(t){var e;(t=a.URL.formatURL(t),this._url!==t)&&(this._url&&((e=n._urlResourcesMap[this._url]).splice(e.indexOf(this),1),0===e.length&&delete n._urlResourcesMap[this._url]),t&&((e=n._urlResourcesMap[t])||(n._urlResourcesMap[t]=e=[]),e.push(this)),this._url=t)}_addReference(t=1){this._referenceCount+=t}_removeReference(t=1){this._referenceCount-=t}_clearReference(){this._referenceCount=0}_recoverResource(){}_disposeResource(){}_activeResource(){}destroy(){var t;this._destroyed||(this._destroyed=!0,this.lock=!1,this._disposeResource(),delete n._idResourcesMap[this.id],this._url&&((t=n._urlResourcesMap[this._url])&&(t.splice(t.indexOf(this),1),0===t.length&&delete n._urlResourcesMap[this._url]),r.ILaya.Loader.loadedMap[this._url]==this&&delete r.ILaya.Loader.loadedMap[this._url]))}}e.Resource=n,n._uniqueIDCounter=0,n._idResourcesMap={},n._urlResourcesMap={},n._cpuMemory=0,n._gpuMemory=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(32),a=i(3),n=i(33),o=i(55),l=i(7),h=i(19),u=i(86),c=i(11),_=i(13),d=i(51),f=i(21),p=i(143),m=i(8);class g{constructor(t,e,i){this._timeId=0,g._mainCanvas=i;let s=g._mainCanvas.source;s.id="layaCanvas",s.width=t,s.height=e,g.isConchApp&&document.body.appendChild(s),this.initRender(g._mainCanvas,t,e),window.requestAnimationFrame((function t(e){r.ILaya.stage._loop(),window.requestAnimationFrame(t)})),r.ILaya.stage.on("visibilitychange",this,this._onVisibilitychange)}_onVisibilitychange(){r.ILaya.stage.isVisibility?0!=this._timeId&&window.clearInterval(this._timeId):this._timeId=window.setInterval(this._enterFrame,1e3)}initRender(t,e,i){var r=a.LayaGL.instance=l.WebGLContext.mainContext=function(t){var e,i=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];s.Config.useWebGL2&&!m.Browser.onBDMiniGame||i.shift();for(var r=0;r<i.length;r++){try{e=t.getContext(i[r],{stencil:s.Config.isStencil,alpha:s.Config.isAlpha,antialias:s.Config.isAntialias,premultipliedAlpha:s.Config.premultipliedAlpha,preserveDrawingBuffer:s.Config.preserveDrawingBuffer})}catch(t){}if(e)return"webgl2"===i[r]&&(o.WebGL._isWebGL2=!0),new a.LayaGL,e}return null}(g._mainCanvas.source);if(!r)return!1;a.LayaGL.instance=r,a.LayaGL.layaGPUInstance=new p.LayaGPU(r,o.WebGL._isWebGL2),t.size(e,i),n.Context.__init__(),f.SubmitBase.__init__();var v=new n.Context;return v.isMain=!0,g._context=v,t._setContext(v),c.ShaderDefines2D.__init__(),_.Value2D.__init__(),u.Shader2D.__init__(),d.Buffer2D.__int__(r),h.BlendMode._init_(r),!0}_enterFrame(t=null){r.ILaya.stage._loop()}static get context(){return g._context}static get canvas(){return g._mainCanvas.source}}e.Render=g,g.supportWebGLPlusCulling=!1,g.supportWebGLPlusAnimation=!1,g.supportWebGLPlusRendering=!1,g.isConchApp=!1,g.isConchApp=null!=window.conch,g.isConchApp?(g.supportWebGLPlusCulling=!1,g.supportWebGLPlusAnimation=!0,g.supportWebGLPlusRendering=!0):null!=window.qq&&null!=window.qq.webglPlus&&(g.supportWebGLPlusCulling=!1,g.supportWebGLPlusAnimation=!0,g.supportWebGLPlusRendering=!0)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{}e.RenderInfo=r,r.loopStTm=0,r.loopCount=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{}e.SpriteConst=r,r.ALPHA=1,r.TRANSFORM=2,r.BLEND=4,r.CANVAS=8,r.FILTERS=16,r.MASK=32,r.CLIP=64,r.STYLE=128,r.TEXTURE=256,r.GRAPHICS=512,r.LAYAGL3D=1024,r.CUSTOM=2048,r.ONECHILD=4096,r.CHILDS=8192,r.REPAINT_NONE=0,r.REPAINT_NODE=1,r.REPAINT_CACHE=2,r.REPAINT_ALL=3},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(22),a=i(2),n=i(37),o=i(44),l=i(81),h=i(4),u=i(5),c=i(10),_=i(97),d=i(33),f=i(42),p=i(17),m=i(9),g=i(6),v=i(151),y=i(152),x=i(98),T=i(43),b=i(57),E=i(27),C=i(14);class S extends b.Node{constructor(){super(),this._x=0,this._y=0,this._width=0,this._height=0,this._visible=!0,this._mouseState=0,this._zOrder=0,this._renderType=0,this._transform=null,this._tfChanged=!1,this._repaint=E.SpriteConst.REPAINT_NONE,this._texture=null,this._style=x.SpriteStyle.EMPTY,this._cacheStyle=y.CacheStyle.EMPTY,this._boundStyle=null,this._graphics=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1}destroy(t=!0){super.destroy(t),this._style&&this._style.recover(),this._cacheStyle&&this._cacheStyle.recover(),this._boundStyle&&this._boundStyle.recover(),this._style=null,this._cacheStyle=null,this._boundStyle=null,this._transform=null,this._graphics&&this._graphics.autoDestroy&&this._graphics.destroy(),this._graphics=null,this.texture=null}updateZOrder(){g.Utils.updateOrder(this._children)&&this.repaint()}_getBoundsStyle(){return this._boundStyle||(this._boundStyle=v.BoundsStyle.create()),this._boundStyle}_setCustomRender(){}set customRenderEnable(t){t&&(this._renderType|=E.SpriteConst.CUSTOM,this._setRenderType(this._renderType),this._setCustomRender())}get cacheAs(){return this._cacheStyle.cacheAs}_setCacheAs(t){}set cacheAs(t){t!==this._cacheStyle.userSetCache&&(this.mask&&"normal"===t||(this._setCacheAs(t),this._getCacheStyle().userSetCache=t,this._checkCanvasEnable(),this.repaint()))}_checkCanvasEnable(){var t=this._cacheStyle.needEnableCanvasRender();this._getCacheStyle().enableCanvasRender=t,t?(this._cacheStyle.needBitmapCache()?this._cacheStyle.cacheAs="bitmap":this._cacheStyle.cacheAs=this._cacheStyle.userSetCache,this._cacheStyle.reCache=!0,this._renderType|=E.SpriteConst.CANVAS):(this._cacheStyle.cacheAs="none",this._cacheStyle.releaseContext(),this._renderType&=~E.SpriteConst.CANVAS),this._setCacheAs(this._cacheStyle.cacheAs),this._setRenderType(this._renderType)}get staticCache(){return this._cacheStyle.staticCache}set staticCache(t){this._getCacheStyle().staticCache=t,t||this.reCache()}reCache(){this._cacheStyle.reCache=!0,this._repaint|=E.SpriteConst.REPAINT_CACHE}getRepaint(){return this._repaint}_setX(t){this._x=t}_setY(t){this._y=t}_setWidth(t,e){}_setHeight(t,e){}get x(){return this._x}set x(t){if(!this.destroyed&&this._x!==t){this._setX(t),this.parentRepaint(E.SpriteConst.REPAINT_CACHE);var e=this._cacheStyle.maskParent;e&&e.repaint(E.SpriteConst.REPAINT_CACHE)}}get y(){return this._y}set y(t){if(!this.destroyed&&this._y!==t){this._setY(t),this.parentRepaint(E.SpriteConst.REPAINT_CACHE);var e=this._cacheStyle.maskParent;e&&e.repaint(E.SpriteConst.REPAINT_CACHE)}}get width(){return this.get_width()}set width(t){this.set_width(t)}set_width(t){this._width!==t&&(this._width=t,this._setWidth(this.texture,t),this._setTranformChange())}get_width(){return this.autoSize?this.texture?this.texture.width:this._graphics||0!==this._children.length?this.getSelfBounds().width:0:this._width||(this.texture?this.texture.width:0)}get height(){return this.get_height()}set height(t){this.set_height(t)}set_height(t){this._height!==t&&(this._height=t,this._setHeight(this.texture,t),this._setTranformChange())}get_height(){return this.autoSize?this.texture?this.texture.height:this._graphics||0!==this._children.length?this.getSelfBounds().height:0:this._height||(this.texture?this.texture.height:0)}get displayWidth(){return this.width*this.scaleX}get displayHeight(){return this.height*this.scaleY}setSelfBounds(t){this._getBoundsStyle().userBounds=t}getBounds(){return this._getBoundsStyle().bounds=c.Rectangle._getWrapRec(this._boundPointsToParent())}getSelfBounds(){return this._boundStyle&&this._boundStyle.userBounds?this._boundStyle.userBounds:this._graphics||0!==this._children.length||this._texture?this._getBoundsStyle().bounds=c.Rectangle._getWrapRec(this._getBoundPointsM(!1)):c.Rectangle.TEMP.setTo(0,0,this.width,this.height)}_boundPointsToParent(t=!1){var e=0,i=0;this._style&&(e=this.pivotX,i=this.pivotY,t=t||0!==this._style.rotation,this._style.scrollRect&&(e+=this._style.scrollRect.x,i+=this._style.scrollRect.y));var r=this._getBoundPointsM(t);if(!r||r.length<1)return r;if(8!=r.length&&(r=t?l.GrahamScan.scanPList(r):c.Rectangle._getWrapRec(r,c.Rectangle.TEMP)._getBoundPoints()),!this.transform)return g.Utils.transPointList(r,this._x-e,this._y-i),r;var s,a=u.Point.TEMP,n=r.length;for(s=0;s<n;s+=2)a.x=r[s],a.y=r[s+1],this.toParentPoint(a),r[s]=a.x,r[s+1]=a.y;return r}getGraphicBounds(t=!1){return this._graphics?this._graphics.getBounds(t):c.Rectangle.TEMP.setTo(0,0,0,0)}_getBoundPointsM(t=!1){if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();if(this._boundStyle||this._getBoundsStyle(),this._boundStyle.temBM||(this._boundStyle.temBM=[]),this._style.scrollRect){var e=g.Utils.clearArray(this._boundStyle.temBM),i=c.Rectangle.TEMP;return i.copyFrom(this._style.scrollRect),g.Utils.concatArray(e,i._getBoundPoints()),e}var r,s,a,n;this._graphics?r=this._graphics.getBoundPoints():(r=g.Utils.clearArray(this._boundStyle.temBM),this._texture&&((i=c.Rectangle.TEMP).setTo(0,0,this.width||this._texture.width,this.height||this._texture.height),g.Utils.concatArray(r,i._getBoundPoints())));for(var o=0,l=(n=this._children).length;o<l;o++)(s=n[o])instanceof S&&!0===s._visible&&(a=s._boundPointsToParent(t))&&(r=r?g.Utils.concatArray(r,a):a);return r}_getCacheStyle(){return this._cacheStyle===y.CacheStyle.EMPTY&&(this._cacheStyle=y.CacheStyle.create()),this._cacheStyle}getStyle(){return this._style===x.SpriteStyle.EMPTY&&(this._style=x.SpriteStyle.create()),this._style}setStyle(t){this._style=t}get scaleX(){return this._style.scaleX}set scaleX(t){this.set_scaleX(t)}_setScaleX(t){this._style.scaleX=t}get scaleY(){return this._style.scaleY}set scaleY(t){this.set_scaleY(t)}_setScaleY(t){this._style.scaleY=t}set_scaleX(t){this.getStyle().scaleX!==t&&(this._setScaleX(t),this._setTranformChange())}get_scaleX(){return this._style.scaleX}set_scaleY(t){this.getStyle().scaleY!==t&&(this._setScaleY(t),this._setTranformChange())}get_scaleY(){return this._style.scaleY}get rotation(){return this._style.rotation}set rotation(t){this.getStyle().rotation!==t&&(this._setRotation(t),this._setTranformChange())}_setRotation(t){this._style.rotation=t}get skewX(){return this._style.skewX}set skewX(t){this.getStyle().skewX!==t&&(this._setSkewX(t),this._setTranformChange())}_setSkewX(t){this._style.skewX=t}get skewY(){return this._style.skewY}set skewY(t){this.getStyle().skewY!==t&&(this._setSkewY(t),this._setTranformChange())}_setSkewY(t){this._style.skewY=t}_createTransform(){return h.Matrix.create()}_adjustTransform(){this._tfChanged=!1;var t=this._style,e=t.scaleX,i=t.scaleY,r=t.skewX,s=t.skewY,a=t.rotation,n=this._transform||(this._transform=this._createTransform());if(a||1!==e||1!==i||0!==r||0!==s){n._bTransform=!0;var o=.0174532922222222*(a-r),l=.0174532922222222*(a+s),h=Math.cos(l),u=Math.sin(l),c=Math.sin(o),_=Math.cos(o);n.a=e*h,n.b=e*u,n.c=-i*c,n.d=i*_,n.tx=n.ty=0}else n.identity(),this._renderType&=~E.SpriteConst.TRANSFORM,this._setRenderType(this._renderType);return n}_setTransform(t){}get transform(){return this._tfChanged?this._adjustTransform():this._transform}set transform(t){this.set_transform(t)}get_transform(){return this._tfChanged?this._adjustTransform():this._transform}set_transform(t){this._tfChanged=!1;var e=this._transform||(this._transform=this._createTransform());t.copyTo(e),this._setTransform(e),t&&(this._x=e.tx,this._y=e.ty,e.tx=e.ty=0),t?this._renderType|=E.SpriteConst.TRANSFORM:this._renderType&=~E.SpriteConst.TRANSFORM,this._setRenderType(this._renderType),this.parentRepaint()}_setPivotX(t){this.getStyle().pivotX=t}_getPivotX(){return this._style.pivotX}_setPivotY(t){this.getStyle().pivotY=t}_getPivotY(){return this._style.pivotY}get pivotX(){return this._getPivotX()}set pivotX(t){this._setPivotX(t),this.repaint()}get pivotY(){return this._getPivotY()}set pivotY(t){this._setPivotY(t),this.repaint()}_setAlpha(t){this._style.alpha!==t&&(this.getStyle().alpha=t,1!==t?this._renderType|=E.SpriteConst.ALPHA:this._renderType&=~E.SpriteConst.ALPHA,this._setRenderType(this._renderType),this.parentRepaint())}_getAlpha(){return this._style.alpha}get alpha(){return this._getAlpha()}set alpha(t){t=t<0?0:t>1?1:t,this._setAlpha(t)}get visible(){return this.get_visible()}set visible(t){this.set_visible(t)}get_visible(){return this._visible}set_visible(t){this._visible!==t&&(this._visible=t,this.parentRepaint(E.SpriteConst.REPAINT_ALL))}_setBlendMode(t){}get blendMode(){return this._style.blendMode}set blendMode(t){this._setBlendMode(t),this.getStyle().blendMode=t,t&&"source-over"!=t?this._renderType|=E.SpriteConst.BLEND:this._renderType&=~E.SpriteConst.BLEND,this._setRenderType(this._renderType),this.parentRepaint()}get graphics(){return this._graphics||(this.graphics=new T.Graphics,this._graphics.autoDestroy=!0),this._graphics}_setGraphics(t){}_setGraphicsCallBack(){}set graphics(t){this._graphics&&(this._graphics._sp=null),this._graphics=t,t?(this._setGraphics(t),this._renderType|=E.SpriteConst.GRAPHICS,t._sp=this):this._renderType&=~E.SpriteConst.GRAPHICS,this._setRenderType(this._renderType),this.repaint()}get scrollRect(){return this._style.scrollRect}_setScrollRect(t){}set scrollRect(t){this.getStyle().scrollRect=t,this._setScrollRect(t),this.repaint(),t?this._renderType|=E.SpriteConst.CLIP:this._renderType&=~E.SpriteConst.CLIP,this._setRenderType(this._renderType)}pos(t,e,i=!1){if(this._x!==t||this._y!==e){if(this.destroyed)return this;if(i){this._setX(t),this._setY(e),this.parentRepaint(E.SpriteConst.REPAINT_CACHE);var r=this._cacheStyle.maskParent;r&&r.repaint(E.SpriteConst.REPAINT_CACHE)}else this.x=t,this.y=e}return this}pivot(t,e){return this.pivotX=t,this.pivotY=e,this}size(t,e){return this.width=t,this.height=e,this}scale(t,e,i=!1){var r=this.getStyle();if(r.scaleX!=t||r.scaleY!=e){if(this.destroyed)return this;i?(this._setScaleX(t),this._setScaleY(e),this._setTranformChange()):(this.scaleX=t,this.scaleY=e)}return this}skew(t,e){return this.skewX=t,this.skewY=e,this}render(t,e,i){_.RenderSprite.renders[this._renderType]._fun(this,t,e+this._x,i+this._y),this._repaint=0}drawToCanvas(t,e,i,r){return S.drawToCanvas(this,this._renderType,t,e,i,r)}drawToTexture(t,e,i,r,s=null){return S.drawToTexture(this,this._renderType,t,e,i,r,s)}drawToTexture3D(t,e,i){throw"not implement"}static drawToCanvas(t,e,i,r,s,a){s-=t.x,a-=t.y,s|=0,a|=0,i|=0,r|=0;var n=new d.Context;n.size(i,r),n.asBitmap=!0,n._targets.start(),n._targets.clear(0,0,0,0),_.RenderSprite.renders[e]._fun(t,n,s,a),n.flush(),n._targets.end(),n._targets.restore();var o=n._targets.getData(0,0,i,r);n.destroy();for(var l=new ImageData(i,r),h=4*i,u=(new Uint8Array(h),l.data),c=r-1,p=c*h,m=0;c>=0;c--)u.set(o.subarray(m,m+h),p),p-=h,m+=h;var g=new f.HTMLCanvas(!0);return g.size(i,r),g.getContext("2d").putImageData(l,0,0),g}static drawToTexture(t,e,i,r,s,a,n=null){S.drawtocanvCtx||(S.drawtocanvCtx=new d.Context),s-=t.x,a-=t.y,s|=0,a|=0,i|=0,r|=0;var o=n?S.drawtocanvCtx:new d.Context;if(o.clear(),o.size(i,r),n?o._targets=n:o.asBitmap=!0,o._targets.start(),o._targets.clear(0,0,0,0),_.RenderSprite.renders[e]._fun(t,o,s,a),o.flush(),o._targets.end(),o._targets.restore(),!n){var l=new p.Texture(o._targets,p.Texture.INV_UV);return o.destroy(!0),l}return n}customRender(t,e,i){this._repaint=E.SpriteConst.REPAINT_ALL}_applyFilters(){}get filters(){return this._cacheStyle.filters}_setColorFilter(t){}set filters(t){t&&0===t.length&&(t=null),this._cacheStyle.filters!=t&&(this._getCacheStyle().filters=t?t.slice():null,t&&t.length?(this._setColorFilter(t[0]),this._renderType|=E.SpriteConst.FILTERS):(this._setColorFilter(null),this._renderType&=~E.SpriteConst.FILTERS),this._setRenderType(this._renderType),t&&t.length>0?(this._getBit(s.Const.DISPLAY)||this._setBitUp(s.Const.DISPLAY),1==t.length&&t[0]instanceof n.ColorFilter||(this._getCacheStyle().cacheForFilters=!0,this._checkCanvasEnable())):this._cacheStyle.cacheForFilters&&(this._cacheStyle.cacheForFilters=!1,this._checkCanvasEnable()),this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter(),this.repaint())}_isHaveGlowFilter(){var t,e;if(this.filters)for(t=0;t<this.filters.length;t++)if(this.filters[t].type==o.Filter.GLOW)return!0;for(t=0,e=this._children.length;t<e;t++)if(this._children[t]._isHaveGlowFilter())return!0;return!1}localToGlobal(t,e=!1,i=null){!0===e&&(t=new u.Point(t.x,t.y));var s=this;for(i=i||r.ILaya.stage;s&&!s.destroyed&&s!=i;)t=s.toParentPoint(t),s=s.parent;return t}globalToLocal(t,e=!1,i=null){e&&(t=new u.Point(t.x,t.y));var s=this,a=[];for(i=i||r.ILaya.stage;s&&!s.destroyed&&s!=i;)a.push(s),s=s.parent;for(var n=a.length-1;n>=0;)t=(s=a[n]).fromParentPoint(t),n--;return t}toParentPoint(t){if(!t)return t;t.x-=this.pivotX,t.y-=this.pivotY,this.transform&&this._transform.transformPoint(t),t.x+=this._x,t.y+=this._y;var e=this._style.scrollRect;return e&&(t.x-=e.x,t.y-=e.y),t}fromParentPoint(t){if(!t)return t;t.x-=this._x,t.y-=this._y;var e=this._style.scrollRect;return e&&(t.x+=e.x,t.y+=e.y),this.transform&&this._transform.invertTransformPoint(t),t.x+=this.pivotX,t.y+=this.pivotY,t}fromStagePoint(t){return t}on(t,e,i,r=null){return 1!==this._mouseState&&this.isMouseEvent(t)?(this.mouseEnabled=!0,this._setBit(s.Const.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(t,e,i,r,!1)):super.on(t,e,i,r)}once(t,e,i,r=null){return 1!==this._mouseState&&this.isMouseEvent(t)?(this.mouseEnabled=!0,this._setBit(s.Const.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(t,e,i,r,!0)):super.once(t,e,i,r)}_onDisplay(t){if(1!==this._mouseState){var e=this;for(e=e.parent;e&&1!==e._mouseState&&!e._getBit(s.Const.HAS_MOUSE);)e.mouseEnabled=!0,e._setBit(s.Const.HAS_MOUSE,!0),e=e.parent}}_setParent(t){super._setParent(t),t&&this._getBit(s.Const.HAS_MOUSE)&&this._onDisplay()}loadImage(t,e=null){if(t){var i=r.ILaya.Loader.textureMap[C.URL.formatURL(t)];i||((i=new p.Texture).load(t),r.ILaya.Loader.cacheTexture(t,i)),this.texture=i,i.getIsReady()?s.call(this):i.once(a.Event.READY,this,s)}else this.texture=null,s.call(this);function s(){this.repaint(E.SpriteConst.REPAINT_ALL),e&&e.run()}return this}static fromImage(t){return(new S).loadImage(t)}repaint(t=E.SpriteConst.REPAINT_CACHE){this._repaint&t||(this._repaint|=t,this.parentRepaint(t)),this._cacheStyle&&this._cacheStyle.maskParent&&this._cacheStyle.maskParent.repaint(t)}_needRepaint(){return this._repaint&E.SpriteConst.REPAINT_CACHE&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache}_childChanged(t=null){this._children.length?this._renderType|=E.SpriteConst.CHILDS:this._renderType&=~E.SpriteConst.CHILDS,this._setRenderType(this._renderType),t&&this._getBit(s.Const.HAS_ZORDER)&&r.ILaya.systemTimer.callLater(this,this.updateZOrder),this.repaint(E.SpriteConst.REPAINT_ALL)}parentRepaint(t=E.SpriteConst.REPAINT_CACHE){var e=this._parent;!e||e._repaint&t||(e._repaint|=t,e.parentRepaint(t))}get stage(){return r.ILaya.stage}get hitArea(){return this._style.hitArea}set hitArea(t){this.getStyle().hitArea=t}_setMask(t){}get mask(){return this._cacheStyle.mask}set mask(t){t&&this.mask&&this.mask._cacheStyle.maskParent||(this._getCacheStyle().mask=t,this._setMask(t),this._checkCanvasEnable(),t?t._getCacheStyle().maskParent=this:this.mask&&(this.mask._getCacheStyle().maskParent=null),this._renderType|=E.SpriteConst.MASK,this._setRenderType(this._renderType),this.parentRepaint(E.SpriteConst.REPAINT_ALL))}get mouseEnabled(){return this._mouseState>1}set mouseEnabled(t){this._mouseState=t?2:1}startDrag(t=null,e=!1,i=0,s=300,a=null,n=!1,o=.92){this._style.dragging||(this.getStyle().dragging=new r.ILaya.Dragging),this._style.dragging.start(this,t,e,i,s,a,n,o)}stopDrag(){this._style.dragging&&this._style.dragging.stop()}_setDisplay(t){t||this._cacheStyle&&(this._cacheStyle.releaseContext(),this._cacheStyle.releaseFilterCache(),this._cacheStyle.hasGlowFilter&&(this._cacheStyle.hasGlowFilter=!1)),super._setDisplay(t)}hitTestPoint(t,e){var i=this.globalToLocal(u.Point.TEMP.setTo(t,e));return t=i.x,e=i.y,(this._style.hitArea?this._style.hitArea:this._width>0&&this._height>0?c.Rectangle.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(t,e)}getMousePoint(){return this.globalToLocal(u.Point.TEMP.setTo(r.ILaya.stage.mouseX,r.ILaya.stage.mouseY))}get globalScaleX(){for(var t=1,e=this;e&&e!==r.ILaya.stage;)t*=e.scaleX,e=e.parent;return t}get globalRotation(){for(var t=0,e=this;e&&e!==r.ILaya.stage;)t+=e.rotation,e=e.parent;return t}get globalScaleY(){for(var t=1,e=this;e&&e!==r.ILaya.stage;)t*=e.scaleY,e=e.parent;return t}get mouseX(){return this.getMousePoint().x}get mouseY(){return this.getMousePoint().y}get zOrder(){return this._zOrder}set zOrder(t){this._zOrder!=t&&(this._zOrder=t,this._parent&&(t&&this._parent._setBit(s.Const.HAS_ZORDER,!0),r.ILaya.systemTimer.callLater(this._parent,this.updateZOrder)))}get texture(){return this._texture}_setTexture(t){}set texture(t){"string"==typeof t?this.loadImage(t):this._texture!=t&&(this._texture&&this._texture._removeReference(),this._texture=t,t&&t._addReference(),this._setTexture(t),this._setWidth(this._texture,this.width),this._setHeight(this._texture,this.height),t?this._renderType|=E.SpriteConst.TEXTURE:this._renderType&=~E.SpriteConst.TEXTURE,this._setRenderType(this._renderType),this.repaint())}get viewport(){return this._style.viewport}set viewport(t){var e;"string"==typeof t&&((e=t.split(",")).length>3&&(t=new c.Rectangle(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]))));this.getStyle().viewport=t}_setRenderType(t){}_setTranformChange(){this._tfChanged=!0,this._renderType|=E.SpriteConst.TRANSFORM,this.parentRepaint(E.SpriteConst.REPAINT_CACHE)}_setBgStyleColor(t,e,i,r,s){}_setBorderStyleColor(t,e,i,r,s,a){}captureMouseEvent(t){r.ILaya.MouseManager.instance.setCapture(this,t)}releaseMouseEvent(){r.ILaya.MouseManager.instance.releaseCapture()}set drawCallOptimize(t){this._setBit(s.Const.DRAWCALL_OPTIMIZE,t)}get drawCallOptimize(){return this._getBit(s.Const.DRAWCALL_OPTIMIZE)}}e.Sprite=S,m.ClassUtils.regClass("laya.display.Sprite",S),m.ClassUtils.regClass("Laya.Sprite",S)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(159),a=i(36),n=i(2),o=i(12),l=i(102),h=i(39),u=i(17),c=i(23),_=i(8),d=i(160),f=i(16),p=i(6),m=i(161),g=i(104),v=i(14),y=i(46);class x extends o.EventDispatcher{constructor(){super(...arguments),this._customParse=!1}static getTypeFromUrl(t){var e=p.Utils.getFileExtension(t);return e?x.typeMap[e]:(console.warn("Not recognize the resources suffix",t),"text")}load(t,e=null,i=!0,s=null,a=!1,o=r.ILaya.WorkerLoader.enable){if(t){var l;if(x.setGroup(t,"666"),this._url=t,0===t.indexOf("data:image")?e=x.IMAGE:t=v.URL.formatURL(t),this._type=e||(e=x.getTypeFromUrl(this._url)),this._cache=i,this._useWorkerLoader=o,this._data=null,o&&r.ILaya.WorkerLoader.enableWorkerLoader(),l=e==x.IMAGE?x.textureMap[t]:x.loadedMap[t],!a&&l)return this._data=l,this.event(n.Event.PROGRESS,1),void this.event(n.Event.COMPLETE,this._data);if(s&&x.setGroup(t,s),null!=x.parserMap[e])return this._customParse=!0,void(x.parserMap[e]instanceof f.Handler?x.parserMap[e].runWith(this):x.parserMap[e].call(null,this));this._loadResourceFilter(e,t)}else this.onLoaded(null)}_loadResourceFilter(t,e){this._loadResource(t,e)}_loadResource(t,e){switch(t){case x.IMAGE:case"htmlimage":case"nativeimage":this._loadImage(e);break;case x.SOUND:this._loadSound(e);break;case x.TTF:this._loadTTF(e);break;case x.ATLAS:case x.PREFAB:case x.PLF:this._loadHttpRequestWhat(e,x.JSON);break;case x.FONT:this._loadHttpRequestWhat(e,x.XML);break;case x.PLFB:this._loadHttpRequestWhat(e,x.BUFFER);break;default:this._loadHttpRequestWhat(e,t)}}_loadHttpRequest(t,e,i,r,s,a,o,l){_.Browser.onVVMiniGame?this._http=new g.HttpRequest:this._http||(this._http=new g.HttpRequest),a&&this._http.on(n.Event.PROGRESS,s,a),r&&this._http.on(n.Event.COMPLETE,i,r),this._http.on(n.Event.ERROR,o,l),this._http.send(t,null,"get",e)}_loadHtmlImage(t,e,i,r,s){var a;function n(){var e=a;e.onload=null,e.onerror=null,delete x._imgCache[t]}(a=new _.Browser.window.Image).crossOrigin="",a.onload=function(){n(),i.call(e,a)},a.onerror=function(){n(),s.call(r)},a.src=t,x._imgCache[t]=a}_loadHttpRequestWhat(t,e){x.preLoadedMap[t]?this.onLoaded(x.preLoadedMap[t]):this._loadHttpRequest(t,e,this,this.onLoaded,this,this.onProgress,this,this.onError)}_loadTTF(t){t=v.URL.formatURL(t);var e=new r.ILaya.TTFLoader;e.complete=f.Handler.create(this,this.onLoaded),e.load(t)}_loadImage(t,e=!0){var i,r=this;e&&(t=v.URL.formatURL(t));var s=function(){r.event(n.Event.ERROR,"Load image failed")};if("nativeimage"===this._type)i=t=>{this.onLoaded(t)},this._loadHtmlImage(t,this,i,this,s);else{var a=p.Utils.getFileExtension(t);"ktx"===a||"pvr"===a?(i=function(e){let i;switch(a){case"ktx":i=y.TextureFormat.ETC1RGB;break;case"pvr":i=y.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",a)}var s=new c.Texture2D(0,0,i,!1,!1);s.wrapModeU=h.BaseTexture.WARPMODE_CLAMP,s.wrapModeV=h.BaseTexture.WARPMODE_CLAMP,s.setCompressData(e),s._setCreateURL(t),r.onLoaded(s)},this._loadHttpRequest(t,x.BUFFER,this,i,null,null,this,s)):(i=function(e){var i=new c.Texture2D(e.width,e.height,1,!1,!1);i.wrapModeU=h.BaseTexture.WARPMODE_CLAMP,i.wrapModeV=h.BaseTexture.WARPMODE_CLAMP,i.loadImageSource(e,!0),i._setCreateURL(t),r.onLoaded(i)},this._loadHtmlImage(t,this,i,this,s))}}_loadSound(t){var e=new l.SoundManager._soundClass,i=this;function r(){e.offAll()}e.on(n.Event.COMPLETE,this,(function(){r(),i.onLoaded(e)})),e.on(n.Event.ERROR,this,(function(){r(),e.dispose(),i.event(n.Event.ERROR,"Load sound failed")})),e.load(t)}onProgress(t){this._type===x.ATLAS?this.event(n.Event.PROGRESS,.3*t):this.event(n.Event.PROGRESS,t)}onError(t){this.event(n.Event.ERROR,t)}onLoaded(t=null){var e=this._type;if(e==x.PLFB)this.parsePLFBData(t),this.complete(t);else if(e==x.PLF)this.parsePLFData(t),this.complete(t);else if(e===x.IMAGE){var i=new u.Texture(t);i.url=this._url,this.complete(i)}else if(e===x.SOUND||"htmlimage"===e||"nativeimage"===e)this.complete(t);else if(e===x.ATLAS){if(!(t instanceof c.Texture2D)){var r=[];if(!this._data){if(this._data=t,t.meta&&t.meta.image){r=t.meta.image.split(",");var o=this._url.indexOf("/")>=0?"/":"\\",l=this._url.lastIndexOf(o),h=l>=0?this._url.substr(0,l+1):"",d=null;_.Browser.onAndroid&&t.meta.compressTextureAndroid&&(d=".ktx"),_.Browser.onIOS&&t.meta.compressTextureIOS&&(d=".pvr");for(var f=0,p=r.length;f<p;f++)r[f]=d?h+r[f].replace(".png",d):h+r[f]}else r=[this._url.replace(".json",".png")];r.reverse(),t.toLoads=r,t.pics=[]}return this.event(n.Event.PROGRESS,.3+1/r.length*.6),this._loadResourceFilter(x.IMAGE,r.pop())}if(this._data.pics.push(t),this._data.toLoads.length>0)return this.event(n.Event.PROGRESS,.3+1/this._data.toLoads.length*.6),this._loadResourceFilter(x.IMAGE,this._data.toLoads.pop());var g=this._data.frames,y=this._url.split("?")[0],T=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:y.substring(0,y.lastIndexOf("."))+"/",b=this._data.pics,E=v.URL.formatURL(this._url),C=x.atlasMap[E]||(x.atlasMap[E]=[]);C.dir=T;var S=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var R in S=parseFloat(this._data.meta.scale),g){var w,M=g[R],L=b[M.frame.idx?M.frame.idx:0],I=v.URL.formatURL(T+R);L.scaleRate=S,w=u.Texture._create(L,M.frame.x,M.frame.y,M.frame.w,M.frame.h,M.spriteSourceSize.x,M.spriteSourceSize.y,M.sourceSize.w,M.sourceSize.h,x.getRes(I)),x.cacheTexture(I,w),w.url=I,C.push(I)}else for(R in g)L=b[(M=g[R]).frame.idx?M.frame.idx:0],I=v.URL.formatURL(T+R),w=u.Texture._create(L,M.frame.x,M.frame.y,M.frame.w,M.frame.h,M.spriteSourceSize.x,M.spriteSourceSize.y,M.sourceSize.w,M.sourceSize.h,x.getRes(I)),x.cacheTexture(I,w),w.url=I,C.push(I);delete this._data.pics,this.complete(this._data)}else if(e===x.FONT){if(!t._source)return this._data=t,this.event(n.Event.PROGRESS,.5),this._loadResourceFilter(x.IMAGE,this._url.replace(".fnt",".png"));var A=new m.BitmapFont;A.parseFont(this._data,new u.Texture(t));var P=this._url.split(".fnt")[0].split("/"),D=P[P.length-1];a.Text.registerBitmapFont(D,A),this._data=A,this.complete(this._data)}else if(e===x.PREFAB){var B=new s.Prefab;B.json=t,this.complete(B)}else this.complete(t)}parsePLFData(t){var e,i,r;for(e in t)switch(r=t[e],e){case"json":case"text":for(i in r)x.preLoadedMap[v.URL.formatURL(i)]=r[i];break;default:for(i in r)x.preLoadedMap[v.URL.formatURL(i)]=r[i]}}parsePLFBData(t){var e,i,r;for(r=(e=new d.Byte(t)).getInt32(),i=0;i<r;i++)this.parseOnePLFBFile(e)}parseOnePLFBFile(t){var e,i,r;i=t.getUTFString(),e=t.getInt32(),r=t.readArrayBuffer(e),x.preLoadedMap[v.URL.formatURL(i)]=r}complete(t){this._data=t,this._customParse?this.event(n.Event.LOADED,t instanceof Array?[t]:t):(x._loaders.push(this),x._isWorking||x.checkNext())}static checkNext(){x._isWorking=!0;for(var t=_.Browser.now();x._startIndex<x._loaders.length;)if(x._loaders[x._startIndex].endLoad(),x._startIndex++,_.Browser.now()-t>x.maxTimeOut)return console.warn("loader callback cost a long time:"+(_.Browser.now()-t)+" url="+x._loaders[x._startIndex-1].url),void r.ILaya.systemTimer.frameOnce(1,null,x.checkNext);x._loaders.length=0,x._startIndex=0,x._isWorking=!1}endLoad(t=null){t&&(this._data=t),this._cache&&x.cacheRes(this._url,this._data),this.event(n.Event.PROGRESS,1),this.event(n.Event.COMPLETE,this.data instanceof Array?[this.data]:this.data)}get url(){return this._url}get type(){return this._type}get cache(){return this._cache}get data(){return this._data}static clearRes(t){t=v.URL.formatURL(t);var e=x.getAtlas(t);if(e){for(var i=0,r=e.length;i<r;i++){var s=e[i],a=x.getRes(s);delete x.textureMap[s],a&&a.destroy()}e.length=0,delete x.atlasMap[t]}var n=x.textureMap[t];n&&(n.destroy(),delete x.textureMap[t]),x.loadedMap[t]&&delete x.loadedMap[t]}static clearTextureRes(t){t=v.URL.formatURL(t);var e=x.getAtlas(t);if(e&&e.length>0)e.forEach((function(t){var e=x.getRes(t);e instanceof u.Texture&&e.disposeBitmap()}));else{var i=x.getRes(t);i instanceof u.Texture&&i.disposeBitmap()}}static getRes(t){var e=x.textureMap[v.URL.formatURL(t)];return e||x.loadedMap[v.URL.formatURL(t)]}static getAtlas(t){return x.atlasMap[v.URL.formatURL(t)]}static cacheRes(t,e){t=v.URL.formatURL(t),null!=x.loadedMap[t]?console.warn("Resources already exist,is repeated loading:",t):e instanceof u.Texture?(x.loadedMap[t]=e.bitmap,x.textureMap[t]=e):x.loadedMap[t]=e}static cacheTexture(t,e){t=v.URL.formatURL(t),null!=x.textureMap[t]?console.warn("Resources already exist,is repeated loading:",t):x.textureMap[t]=e}static setGroup(t,e){x.groupMap[e]||(x.groupMap[e]=[]),x.groupMap[e].push(t)}static clearResByGroup(t){if(x.groupMap[t]){var e,i=x.groupMap[t],r=i.length;for(e=0;e<r;e++)x.clearRes(i[e]);i.length=0}}}e.Loader=x,x.TEXT="text",x.JSON="json",x.PREFAB="prefab",x.XML="xml",x.BUFFER="arraybuffer",x.IMAGE="image",x.SOUND="sound",x.ATLAS="atlas",x.FONT="font",x.TTF="ttf",x.PLF="plf",x.PLFB="plfb",x.HIERARCHY="HIERARCHY",x.MESH="MESH",x.MATERIAL="MATERIAL",x.TEXTURE2D="TEXTURE2D",x.TEXTURECUBE="TEXTURECUBE",x.ANIMATIONCLIP="ANIMATIONCLIP",x.AVATAR="AVATAR",x.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA",x.TERRAINRES="TERRAIN",x.typeMap={ttf:"ttf",png:"image",jpg:"image",jpeg:"image",ktx:"image",pvr:"image",txt:"text",json:"json",prefab:"prefab",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",plf:"plf",plfb:"plfb",scene:"json",ani:"json",sk:"arraybuffer"},x.parserMap={},x.maxTimeOut=100,x.groupMap={},x.loadedMap={},x.atlasMap={},x.textureMap={},x.preLoadedMap={},x._imgCache={},x._loaders=[],x._isWorking=!1,x._startIndex=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(24);class s extends r.Resource{constructor(){super()}}e.BaseShader=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(15),a=i(116),n=i(7),o=i(30),l=i(3);class h extends o.BaseShader{constructor(t,e,i=null,r=null,s=null){if(super(),this._attribInfo=null,this.customCompile=!1,this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},!t||!e)throw"Shader Error";this._attribInfo=s,this._id=++h._count,this._vs=t,this._ps=e,this._nameMap=r||{},null!=i&&(h.sharders[i]=this),this.recreateResource(),this.lock=!0}static getShader(t){return h.sharders[t]}static create(t,e,i=null,r=null,s=null){return new h(t,e,i,r,s)}static withCompile(t,e,i,r){if(i&&h.sharders[i])return h.sharders[i];var s=h._preCompileShader[h.SHADERNAME2ID*t];if(!s)throw new Error("withCompile shader err!"+t);return s.createShader(e,i,r,null)}static withCompile2D(t,e,i,r,s,a=null){if(r&&h.sharders[r])return h.sharders[r];var n=h._preCompileShader[h.SHADERNAME2ID*t+e];if(!n)throw new Error("withCompile shader err!"+t+" "+e);return n.createShader(i,r,s,a)}static addInclude(t,e){r.ILaya.ShaderCompile.addInclude(t,e)}static preCompile(t,e,i,s){var a=h.SHADERNAME2ID*t;h._preCompileShader[a]=new r.ILaya.ShaderCompile(e,i,s)}static preCompile2D(t,e,i,s,a){var n=h.SHADERNAME2ID*t+e;h._preCompileShader[n]=new r.ILaya.ShaderCompile(i,s,a)}recreateResource(){this._compile(),this._setGPUMemory(0)}_disposeResource(){n.WebGLContext.mainContext.deleteShader(this._vshader),n.WebGLContext.mainContext.deleteShader(this._pshader),n.WebGLContext.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this._setGPUMemory(0),this._curActTexIndex=0}_compile(){if(this._vs&&this._ps&&!this._params){var t;this._reCompile=!0,this._params=[],this.customCompile&&(t=r.ILaya.ShaderCompile.preGetParams(this._vs,this._ps));var e,i,s,a=n.WebGLContext.mainContext;this._program=a.createProgram(),this._vshader=h._createShader(a,this._vs,a.VERTEX_SHADER),this._pshader=h._createShader(a,this._ps,a.FRAGMENT_SHADER),a.attachShader(this._program,this._vshader),a.attachShader(this._program,this._pshader);var o=this._attribInfo?this._attribInfo.length:0;for(i=0;i<o;i+=2)a.bindAttribLocation(this._program,this._attribInfo[i+1],this._attribInfo[i]);if(a.linkProgram(this._program),!this.customCompile&&!a.getProgramParameter(this._program,a.LINK_STATUS))throw a.getProgramInfoLog(this._program);var l=this.customCompile?t.uniforms.length:a.getProgramParameter(this._program,a.ACTIVE_UNIFORMS);for(i=0;i<l;i++){var u=this.customCompile?t.uniforms[i]:a.getActiveUniform(this._program,i);(e={vartype:"uniform",glfun:null,ivartype:1,location:a.getUniformLocation(this._program,u.name),name:u.name,type:u.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")>0&&(e.name=e.name.substr(0,e.name.length-3),e.isArray=!0,e.location=a.getUniformLocation(this._program,e.name)),this._params.push(e)}for(i=0,s=this._params.length;i<s;i++)switch((e=this._params[i]).indexOfParams=i,e.index=1,e.value=[e.location,null],e.codename=e.name,e.name=this._nameMap[e.codename]?this._nameMap[e.codename]:e.codename,this._paramsMap[e.name]=e,e._this=this,e.uploadedValue=[],e.type){case a.INT:e.fun=e.isArray?this._uniform1iv:this._uniform1i;break;case a.FLOAT:e.fun=e.isArray?this._uniform1fv:this._uniform1f;break;case a.FLOAT_VEC2:e.fun=e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case a.FLOAT_VEC3:e.fun=e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case a.FLOAT_VEC4:e.fun=e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case a.SAMPLER_2D:e.fun=this._uniform_sampler2D;break;case a.SAMPLER_CUBE:e.fun=this._uniform_samplerCube;break;case a.FLOAT_MAT4:e.glfun=a.uniformMatrix4fv,e.fun=this._uniformMatrix4fv;break;case a.BOOL:e.fun=this._uniform1i;break;case a.FLOAT_MAT2:case a.FLOAT_MAT3:default:throw new Error("compile shader err!")}}}static _createShader(t,e,i){var r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.log(t.getShaderInfoLog(r)),null)}getUniform(t){return this._paramsMap[t]}_uniform1f(t,e){var i=t.uploadedValue;return i[0]!==e?(n.WebGLContext.mainContext.uniform1f(t.location,i[0]=e),1):0}_uniform1fv(t,e){if(e.length<4){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(n.WebGLContext.mainContext.uniform1fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return n.WebGLContext.mainContext.uniform1fv(t.location,e),1}_uniform_vec2(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(n.WebGLContext.mainContext.uniform2f(t.location,i[0]=e[0],i[1]=e[1]),1):0}_uniform_vec2v(t,e){if(e.length<2){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(n.WebGLContext.mainContext.uniform2fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return n.WebGLContext.mainContext.uniform2fv(t.location,e),1}_uniform_vec3(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(n.WebGLContext.mainContext.uniform3f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0}_uniform_vec3v(t,e){return n.WebGLContext.mainContext.uniform3fv(t.location,e),1}_uniform_vec4(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(n.WebGLContext.mainContext.uniform4f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0}_uniform_vec4v(t,e){return n.WebGLContext.mainContext.uniform4fv(t.location,e),1}_uniformMatrix2fv(t,e){return n.WebGLContext.mainContext.uniformMatrix2fv(t.location,!1,e),1}_uniformMatrix3fv(t,e){return n.WebGLContext.mainContext.uniformMatrix3fv(t.location,!1,e),1}_uniformMatrix4fv(t,e){return n.WebGLContext.mainContext.uniformMatrix4fv(t.location,!1,e),1}_uniform1i(t,e){var i=t.uploadedValue;return i[0]!==e?(n.WebGLContext.mainContext.uniform1i(t.location,i[0]=e),1):0}_uniform1iv(t,e){return n.WebGLContext.mainContext.uniform1iv(t.location,e),1}_uniform_ivec2(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(n.WebGLContext.mainContext.uniform2i(t.location,i[0]=e[0],i[1]=e[1]),1):0}_uniform_ivec2v(t,e){return n.WebGLContext.mainContext.uniform2iv(t.location,e),1}_uniform_vec3i(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(n.WebGLContext.mainContext.uniform3i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0}_uniform_vec3vi(t,e){return n.WebGLContext.mainContext.uniform3iv(t.location,e),1}_uniform_vec4i(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(n.WebGLContext.mainContext.uniform4i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0}_uniform_vec4vi(t,e){return n.WebGLContext.mainContext.uniform4iv(t.location,e),1}_uniform_sampler2D(t,e){var i=n.WebGLContext.mainContext,r=t.uploadedValue;return null==r[0]?(r[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),n.WebGLContext.activeTexture(i,i.TEXTURE0+this._curActTexIndex),n.WebGLContext.bindTexture(i,i.TEXTURE_2D,e),this._curActTexIndex++,1):(n.WebGLContext.activeTexture(i,i.TEXTURE0+r[0]),n.WebGLContext.bindTexture(i,i.TEXTURE_2D,e),0)}_uniform_samplerCube(t,e){var i=n.WebGLContext.mainContext,r=t.uploadedValue;return null==r[0]?(r[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),n.WebGLContext.activeTexture(i,i.TEXTURE0+this._curActTexIndex),n.WebGLContext.bindTexture(i,i.TEXTURE_CUBE_MAP,e),this._curActTexIndex++,1):(n.WebGLContext.activeTexture(i,i.TEXTURE0+r[0]),n.WebGLContext.bindTexture(i,i.TEXTURE_CUBE_MAP,e),0)}_noSetValue(t){console.log("no....:"+t.name)}uploadOne(t,e){n.WebGLContext.useProgram(n.WebGLContext.mainContext,this._program);var i=this._paramsMap[t];i.fun.call(this,i,e)}uploadTexture2D(t){var e=n.WebGLContext;e._activeTextures[0]!==t&&(e.bindTexture(n.WebGLContext.mainContext,l.LayaGL.instance.TEXTURE_2D,t),e._activeTextures[0]=t)}upload(t,e=null){o.BaseShader.activeShader=o.BaseShader.bindShader=this;var i=n.WebGLContext.mainContext;n.WebGLContext.useProgram(i,this._program),this._reCompile?(e=this._params,this._reCompile=!1):e=e||this._params;for(var r,a,l=e.length,h=0,u=0;u<l;u++)null!==(a=t[(r=e[u]).name])&&(h+=r.fun.call(this,r,a));s.Stat.shaderCall+=h}uploadArray(t,e,i){o.BaseShader.activeShader=this,o.BaseShader.bindShader=this,n.WebGLContext.useProgram(n.WebGLContext.mainContext,this._program);this._params;for(var r,a,l=0,h=e-2;h>=0;h-=2)(a=this._paramsMap[t[h]])&&null!=(r=t[h+1])&&(i&&i[a.name]&&i[a.name].bind(),l+=a.fun.call(this,a,r));s.Stat.shaderCall+=l}getParams(){return this._params}setAttributesLocation(t){this._attribInfo=t}}e.Shader=h,h._count=0,h._preCompileShader={},h.SHADERNAME2ID=2e-4,h.nameKey=new a.StringKey,h.sharders=new Array(32)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{}e.Config=r,r.animationInterval=50,r.isAntialias=!1,r.isAlpha=!1,r.premultipliedAlpha=!0,r.isStencil=!0,r.preserveDrawingBuffer=!1,r.webGL2D_MeshAllocMaxMem=!0,r.is2DPixelArtGame=!1,r.useWebGL2=!0,r.useRetinalCanvas=!1,window.Config=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(3),a=i(80),n=i(4),o=i(5),l=i(10),h=i(15),u=i(19),c=i(82),_=i(118),d=i(34),f=i(119),p=i(120),m=i(121),g=i(122),v=i(83),y=i(30),x=i(86),T=i(11),b=i(131),E=i(13),C=i(132),S=i(133),R=i(87),w=i(21),M=i(135),L=i(48),I=i(40),A=i(136),P=i(88),D=i(137),B=i(89),O=i(49),F=i(52),N=i(53),U=i(18),k=i(7),G=i(38),W=i(47),Y=i(17),V=i(23);class z{constructor(){if(this._tmpMatrix=new n.Matrix,this._drawTexToDrawTri_Vert=new Float32Array(8),this._drawTexToDrawTri_Index=new Uint16Array([0,1,2,0,2,3]),this._tempUV=new Float32Array(8),this._drawTriUseAbsMatrix=!1,this._id=++z._COUNT,this._other=null,this._renderNextSubmitIndex=0,this._path=null,this._drawCount=1,this._width=z._MAXSIZE,this._height=z._MAXSIZE,this._renderCount=0,this._submits=null,this._curSubmit=null,this._submitKey=new I.SubmitKey,this._mesh=null,this._pathMesh=null,this._triangleMesh=null,this.meshlist=[],this._transedPoints=new Array(8),this._temp4Points=new Array(8),this._clipRect=z.MAXCLIPRECT,this._globalClipMatrix=new n.Matrix(z._MAXSIZE,0,0,z._MAXSIZE,0,0),this._clipInCache=!1,this._clipInfoID=0,this._clipID_Gen=0,this._lastMatScaleX=1,this._lastMatScaleY=1,this._lastMat_a=1,this._lastMat_b=0,this._lastMat_c=0,this._lastMat_d=1,this._nBlendType=0,this._save=null,this._targets=null,this._charSubmitCache=null,this._saveMark=null,this._shader2D=new x.Shader2D,this.sprite=null,this._italicDeg=0,this._lastTex=null,this._fillColor=0,this._flushCnt=0,this.defTexture=null,this._colorFiler=null,this.drawTexAlign=!1,this._incache=!1,this.isMain=!1,z._contextcount++,z._textRender=z._textRender||new B.TextRender,!this.defTexture){var t=new V.Texture2D(2,2);t.setPixels(new Uint8Array(16)),t.lock=!0,this.defTexture=new Y.Texture(t)}this._lastTex=this.defTexture,this.clear()}static __init__(){z.MAXCLIPRECT=new l.Rectangle(0,0,z._MAXSIZE,z._MAXSIZE),H.DEFAULT=new H,v.WebGLCacheAsNormalCanvas}drawImage(...t){}getImageData(...t){}measureText(t){return null}setTransform(...t){}$transform(t,e,i,r,s,a){}get lineJoin(){return""}set lineJoin(t){}get lineCap(){return""}set lineCap(t){}get miterLimit(){return""}set miterLimit(t){}clearRect(t,e,i,r){}_drawRect(t,e,i,r,s){h.Stat.renderBatches++,s&&(this.fillStyle=s),this.fillRect(t,e,i,r,null)}drawTexture2(t,e,i,r,s,a){}transformByMatrix(t,e,i){this.transform(t.a,t.b,t.c,t.d,t.tx+e,t.ty+i)}saveTransform(t){this.save()}restoreTransform(t){this.restore()}drawRect(t,e,i,r,s,a,n){null!=s&&(this.fillStyle=s,this.fillRect(t,e,i,r)),null!=a&&(this.strokeStyle=a,this.lineWidth=n,this.strokeRect(t,e,i,r))}alpha(t){this.globalAlpha*=t}_transform(t,e,i){this.translate(e,i),this.transform(t.a,t.b,t.c,t.d,t.tx,t.ty),this.translate(-e,-i)}_rotate(t,e,i){this.translate(e,i),this.rotate(t),this.translate(-e,-i)}_scale(t,e,i,r){this.translate(i,r),this.scale(t,e),this.translate(-i,-r)}_drawLine(t,e,i,r,s,a,n,o,l){this.beginPath(),this.strokeStyle=n,this.lineWidth=o,this.moveTo(t+i,e+r),this.lineTo(t+s,e+a),this.stroke()}_drawLines(t,e,i,r,s,a){this.beginPath(),this.strokeStyle=r,this.lineWidth=s,this.addPath(i.slice(),!1,!1,t,e),this.stroke()}drawCurves(t,e,i,r,s){this.beginPath(),this.strokeStyle=r,this.lineWidth=s,this.moveTo(t+i[0],e+i[1]);for(var a=2,n=i.length;a<n;)this.quadraticCurveTo(t+i[a++],e+i[a++],t+i[a++],e+i[a++]);this.stroke()}_fillAndStroke(t,e,i,r=!1){null!=t&&(this.fillStyle=t,this.fill()),null!=e&&i>0&&(this.strokeStyle=e,this.lineWidth=i,this.stroke())}_drawCircle(t,e,i,r,s,a,n){h.Stat.renderBatches++,this.beginPath(!0),this.arc(t,e,i,0,z.PI2),this.closePath(),this._fillAndStroke(r,s,a)}_drawPie(t,e,i,r,s,a,n,o,l){this.beginPath(),this.moveTo(t,e),this.arc(t,e,i,r,s),this.closePath(),this._fillAndStroke(a,n,o)}_drawPoly(t,e,i,r,s,a,n,o){this.beginPath(),this.addPath(i.slice(),!0,n,t,e),this.closePath(),this._fillAndStroke(r,s,a,n)}_drawPath(t,e,i,r,s){this.beginPath();for(var a=0,n=i.length;a<n;a++){var o=i[a];switch(o[0]){case"moveTo":this.moveTo(t+o[1],e+o[2]);break;case"lineTo":this.lineTo(t+o[1],e+o[2]);break;case"arcTo":this.arcTo(t+o[1],e+o[2],t+o[3],e+o[4],o[5]);break;case"closePath":this.closePath()}}null!=r&&(this.fillStyle=r.fillStyle,this.fill()),null!=s&&(this.strokeStyle=s.strokeStyle,this.lineWidth=s.lineWidth||1,this.lineJoin=s.lineJoin,this.lineCap=s.lineCap,this.miterLimit=s.miterLimit,this.stroke())}static set2DRenderConfig(){var t=s.LayaGL.instance;k.WebGLContext.setBlend(t,!0),k.WebGLContext.setBlendEquation(t,t.FUNC_ADD),u.BlendMode.activeBlendFunction=null,k.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA),k.WebGLContext.setDepthTest(t,!1),k.WebGLContext.setCullFace(t,!1),k.WebGLContext.setDepthMask(t,!0),k.WebGLContext.setFrontFace(t,t.CCW),t.viewport(0,0,U.RenderState2D.width,U.RenderState2D.height)}clearBG(t,e,i,r){var s=k.WebGLContext.mainContext;s.clearColor(t,e,i,r),s.clear(s.COLOR_BUFFER_BIT)}_getSubmits(){return this._submits}_releaseMem(t=!1){if(this._submits){this._curMat&&this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null,this._charSubmitCache.clear();for(var e=0,i=this._submits._length;e<i;e++)this._submits[e].releaseRender();var r;for(this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path=null,this._save=null,e=0,r=this.meshlist.length;e<r;e++){this.meshlist[e].destroy()}this.meshlist.length=0,this.sprite=null,t||(this._targets&&this._targets.destroy(),this._targets=null)}}destroy(t=!1){--z._contextcount,this.sprite=null,this._releaseMem(t),this._charSubmitCache.destroy(),this._mesh.destroy(),t||(this._targets&&this._targets.destroy(),this._targets=null)}clear(){this._submits||(this._other=H.DEFAULT,this._curMat=n.Matrix.create(),this._charSubmitCache=new D.CharSubmitCache,this._mesh=O.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh),this._pathMesh=N.MeshVG.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._triangleMesh=F.MeshTexture.getAMesh(this.isMain),this.meshlist.push(this._triangleMesh),this._submits=[],this._save=[p.SaveMark.Create(this)],this._save.length=10,this._shader2D=new x.Shader2D),this._submitKey.clear(),this._mesh.clearVB(),this._drawCount=1,this._other=H.DEFAULT,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=z.MAXCLIPRECT,this._curSubmit=w.SubmitBase.RENDERBASE,w.SubmitBase.RENDERBASE._ref=16777215,w.SubmitBase.RENDERBASE._numEle=0,this._shader2D.fillStyle=this._shader2D.strokeStyle=c.DrawStyle.DEFAULT;for(var t=0,e=this._submits._length;t<e;t++)this._submits[t].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1}size(t,e){this._width==t&&this._height==e||(this._width=t,this._height=e,this._targets&&(this._targets.destroy(),this._targets=new G.RenderTexture2D(t,e,W.RenderTextureFormat.R8G8B8A8,-1)),this.isMain&&(k.WebGLContext.mainContext.viewport(0,0,t,e),U.RenderState2D.width=t,U.RenderState2D.height=e)),0===t&&0===e&&this._releaseMem()}set asBitmap(t){if(t){let t=this._targets;if(!this._width||!this._height)throw Error("asBitmap no size!");t&&t.width==this._width&&t.height==this._height||(this._targets=new G.RenderTexture2D(this._width,this._height,W.RenderTextureFormat.R8G8B8A8,-1))}else this._targets&&this._targets.destroy(),this._targets=null}getMatScaleX(){return this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b?this._lastMatScaleX:(this._lastMatScaleX=this._curMat.getScaleX(),this._lastMat_a=this._curMat.a,this._lastMat_b=this._curMat.b,this._lastMatScaleX)}getMatScaleY(){return this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d?this._lastMatScaleY:(this._lastMatScaleY=this._curMat.getScaleY(),this._lastMat_c=this._curMat.c,this._lastMat_d=this._curMat.d,this._lastMatScaleY)}setFillColor(t){this._fillColor=t}getFillColor(){return this._fillColor}set fillStyle(t){this._shader2D.fillStyle.equal(t)||(d.SaveBase.save(this,d.SaveBase.TYPE_FILESTYLE,this._shader2D,!1),this._shader2D.fillStyle=c.DrawStyle.create(t),this._submitKey.other=-this._shader2D.fillStyle.toInt())}get fillStyle(){return this._shader2D.fillStyle}set globalAlpha(t){(t=Math.floor(1e3*t)/1e3)!=this._shader2D.ALPHA&&(d.SaveBase.save(this,d.SaveBase.TYPE_ALPHA,this._shader2D,!1),this._shader2D.ALPHA=t)}get globalAlpha(){return this._shader2D.ALPHA}set textAlign(t){this._other.textAlign===t||(this._other=this._other.make(),d.SaveBase.save(this,d.SaveBase.TYPE_TEXTALIGN,this._other,!1),this._other.textAlign=t)}get textAlign(){return this._other.textAlign}set textBaseline(t){this._other.textBaseline===t||(this._other=this._other.make(),d.SaveBase.save(this,d.SaveBase.TYPE_TEXTBASELINE,this._other,!1),this._other.textBaseline=t)}get textBaseline(){return this._other.textBaseline}set globalCompositeOperation(t){var e=u.BlendMode.TOINT[t];null==e||this._nBlendType===e||(d.SaveBase.save(this,d.SaveBase.TYPE_GLOBALCOMPOSITEOPERATION,this,!0),this._curSubmit=w.SubmitBase.RENDERBASE,this._nBlendType=e)}get globalCompositeOperation(){return u.BlendMode.NAMES[this._nBlendType]}set strokeStyle(t){this._shader2D.strokeStyle.equal(t)||(d.SaveBase.save(this,d.SaveBase.TYPE_STROKESTYLE,this._shader2D,!1),this._shader2D.strokeStyle=c.DrawStyle.create(t),this._submitKey.other=-this._shader2D.strokeStyle.toInt())}get strokeStyle(){return this._shader2D.strokeStyle}translate(t,e){0===t&&0===e||(g.SaveTranslate.save(this),this._curMat._bTransform?(m.SaveTransform.save(this),this._curMat.tx+=t*this._curMat.a+e*this._curMat.c,this._curMat.ty+=t*this._curMat.b+e*this._curMat.d):(this._curMat.tx=t,this._curMat.ty=e))}set lineWidth(t){this._other.lineWidth===t||(this._other=this._other.make(),d.SaveBase.save(this,d.SaveBase.TYPE_LINEWIDTH,this._other,!1),this._other.lineWidth=t)}get lineWidth(){return this._other.lineWidth}save(){this._save[this._save._length++]=p.SaveMark.Create(this)}restore(){var t=this._save._length,e=this._nBlendType;if(!(t<1)){for(var i=t-1;i>=0;i--){var r=this._save[i];if(r.restore(this),r.isSaveMark())return void(this._save._length=i)}e!=this._nBlendType&&(this._curSubmit=w.SubmitBase.RENDERBASE)}}set font(t){this._other=this._other.make(),d.SaveBase.save(this,d.SaveBase.TYPE_FONT,this._other,!1)}fillText(t,e,i,r,s,a,n=0,o=""){z._textRender.filltext(this,t,e,i,r,s,o,n,a)}drawText(t,e,i,r,s,a){z._textRender.filltext(this,t,e,i,r,s,null,0,a)}fillWords(t,e,i,r,s){z._textRender.fillWords(this,t,e,i,r,s,null,0)}strokeWord(t,e,i,r,s,a,n){z._textRender.filltext(this,t,e,i,r,null,s,a,n)}fillBorderText(t,e,i,r,s,a,n,o){z._textRender.filltext(this,t,e,i,r,s,a,n,o)}fillBorderWords(t,e,i,r,s,a,n){z._textRender.fillWords(this,t,e,i,r,s,a,n)}_fast_filltext(t,e,i,r,s,a,n,o,l=0){z._textRender._fast_filltext(this,t,null,e,i,r,s,a,n,o,l)}_fillRect(t,e,i,r,s){var a=this._curSubmit,n=a&&a._key.submitType===w.SubmitBase.KEY_DRAWTEXTURE&&a._key.blendShader===this._nBlendType;this._mesh.vertNum+4>z._MAXVERTNUM&&(this._mesh=O.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh),n=!1),n&&(n=n&&this.isSameClipInfo(a)),this.transformQuad(t,e,i,r,0,this._curMat,this._transedPoints),this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,Y.Texture.NO_UV,s,!1),n||(a=this._curSubmit=P.SubmitTexture.create(this,this._mesh,E.Value2D.create(T.ShaderDefines2D.TEXTURE2D,0)),this._submits[this._submits._length++]=a,this._copyClipInfo(a,this._globalClipMatrix),a.shaderValue.textureHost=this._lastTex,a._key.other=this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1,a._renderType=w.SubmitBase.TYPE_TEXTURE),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}fillRect(t,e,i,r,s){var a=s?c.DrawStyle.create(s):this._shader2D.fillStyle,n=this.mixRGBandAlpha(a.toInt());this._fillRect(t,e,i,r,n)}fillTexture(t,e,i,s,a,n,o,l){t._getSource()?this._fillTexture(t,t.width,t.height,t.uvrect,e,i,s,a,n,o.x,o.y):this.sprite&&r.ILaya.systemTimer.callLater(this,this._repaintSprite)}_fillTexture(t,e,i,r,s,a,n,o,l,h,u){var c=this._curSubmit;this._mesh.vertNum+4>z._MAXVERTNUM&&(this._mesh=O.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh));var _=!0,d=!0;switch(l){case"repeat":break;case"repeat-x":d=!1;break;case"repeat-y":_=!1;break;case"no-repeat":_=d=!1}var f=this._temp4Points,p=0,m=0,g=0,v=0,y=0,x=0;if(h<0?(g=s,p=-h%e/e):g=s+h,u<0?(v=a,m=-u%i/i):v=a+u,y=s+n,x=a+o,!_&&(y=Math.min(y,s+h+e)),!d&&(x=Math.min(x,a+u+i)),!(y<s||x<a||g>y||v>x)){var b=(y-s-h)/e,C=(x-a-u)/i;if(this.transformQuad(g,v,y-g,x-v,0,this._curMat,this._transedPoints),f[0]=p,f[1]=m,f[2]=b,f[3]=m,f[4]=b,f[5]=C,f[6]=p,f[7]=C,!this.clipedOff(this._transedPoints)){var S=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA);this._mesh.addQuad(this._transedPoints,f,S,!0);var R=E.Value2D.create(T.ShaderDefines2D.TEXTURE2D,0);R.defines.add(T.ShaderDefines2D.FILLTEXTURE),R.u_TexRange=r.concat(),c=this._curSubmit=P.SubmitTexture.create(this,this._mesh,R),this._submits[this._submits._length++]=c,this._copyClipInfo(c,this._globalClipMatrix),c.shaderValue.textureHost=t,c._renderType=w.SubmitBase.TYPE_TEXTURE,this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4}this.breakNextMerge()}}setColorFilter(t){d.SaveBase.save(this,d.SaveBase.TYPE_COLORFILTER,this,!0),this._colorFiler=t,this._curSubmit=w.SubmitBase.RENDERBASE}drawTexture(t,e,i,r,s){this._drawTextureM(t,e,i,r,s,null,1,null)}drawTextures(t,e,i,s){if(t._getSource())for(var a=e.length/2,n=0,o=t.bitmap.id,l=0;l<a;l++)this._inner_drawTexture(t,o,e[n++]+i,e[n++]+s,0,0,null,null,1,!1);else this.sprite&&r.ILaya.systemTimer.callLater(this,this._repaintSprite)}_drawTextureAddSubmit(t,e){var i=null;i=P.SubmitTexture.create(this,this._mesh,E.Value2D.create(T.ShaderDefines2D.TEXTURE2D,0)),this._submits[this._submits._length++]=i,i.shaderValue.textureHost=e,i._key.other=t,i._renderType=w.SubmitBase.TYPE_TEXTURE,this._curSubmit=i}_drawTextureM(t,e,i,r,s,a,n,o){var l=this.sprite;return!!t._getSource((function(){l&&l.repaint()}))&&this._inner_drawTexture(t,t.bitmap.id,e,i,r,s,a,o,n,!1)}_drawRenderTexture(t,e,i,r,s,a,n,o){return this._inner_drawTexture(t,-1,e,i,r,s,a,o,1,!1)}submitDebugger(){this._submits[this._submits._length++]=L.SubmitCMD.create([],(function(){}),this)}_copyClipInfo(t,e){var i=t.shaderValue.clipMatDir;i[0]=e.a,i[1]=e.b,i[2]=e.c,i[3]=e.d;var r=t.shaderValue.clipMatPos;r[0]=e.tx,r[1]=e.ty,t.clipInfoID=this._clipInfoID,this._clipInCache&&(t.shaderValue.clipOff[0]=1)}isSameClipInfo(t){return t.clipInfoID===this._clipInfoID}_useNewTex2DSubmit(t,e){this._mesh.vertNum+e>z._MAXVERTNUM&&(this._mesh=O.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh));var i=P.SubmitTexture.create(this,this._mesh,E.Value2D.create(T.ShaderDefines2D.TEXTURE2D,0));this._submits[this._submits._length++]=this._curSubmit=i,i.shaderValue.textureHost=t,this._copyClipInfo(i,this._globalClipMatrix)}_drawTexRect(t,e,i,r,s){this.transformQuad(t,e,i,r,this._italicDeg,this._curMat,this._transedPoints);var a=this._transedPoints;a[0]=a[0]+.5|0,a[1]=a[1]+.5|0,a[2]=a[2]+.5|0,a[3]=a[3]+.5|0,a[4]=a[4]+.5|0,a[5]=a[5]+.5|0,a[6]=a[6]+.5|0,a[7]=a[7]+.5|0,this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,s,this._fillColor,!0),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}drawCallOptimize(t){return this._charSubmitCache.enable(t,this),t}_inner_drawTexture(t,e,i,r,s,a,n,o,l,h){var u=this._curSubmit._key;if(o=o||t._uv,u.submitType===w.SubmitBase.KEY_TRIANGLES&&u.other===e){var c=this._drawTexToDrawTri_Vert;c[0]=i,c[1]=r,c[2]=i+s,c[3]=r,c[4]=i+s,c[5]=r+a,c[6]=i,c[7]=r+a,this._drawTriUseAbsMatrix=!0;var _=this._tempUV;return _[0]=o[0],_[1]=o[1],_[2]=o[2],_[3]=o[3],_[4]=o[4],_[5]=o[5],_[6]=o[6],_[7]=o[7],this.drawTriangles(t,0,0,c,_,this._drawTexToDrawTri_Index,n,l,null,null),this._drawTriUseAbsMatrix=!1,!0}var d=this._mesh,f=this._curSubmit,p=h?this._charSubmitCache.getPos():this._transedPoints;if(this.transformQuad(i,r,s||t.width,a||t.height,this._italicDeg,n||this._curMat,p),this.drawTexAlign){var m=Math.round;p[0]=m(p[0]),p[1]=m(p[1]),p[2]=m(p[2]),p[3]=m(p[3]),p[4]=m(p[4]),p[5]=m(p[5]),p[6]=m(p[6]),p[7]=m(p[7]),this.drawTexAlign=!1}var g=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*l);if(h)return this._charSubmitCache.add(this,t,e,p,o,g),!0;this._drawCount++;var v=e>=0&&u.submitType===w.SubmitBase.KEY_DRAWTEXTURE&&u.other===e;return v&&(v=v&&this.isSameClipInfo(f)),this._lastTex=t,d.vertNum+4>z._MAXVERTNUM&&(d=this._mesh=O.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(d),v=!1),d.addQuad(p,o,g,!0),v||(this._submits[this._submits._length++]=this._curSubmit=f=P.SubmitTexture.create(this,d,E.Value2D.create(T.ShaderDefines2D.TEXTURE2D,0)),f.shaderValue.textureHost=t,f._key.other=e,this._copyClipInfo(f,this._globalClipMatrix)),f._numEle+=6,d.indexNum+=6,d.vertNum+=4,!0}transform4Points(t,e,i){var r=e.tx,s=e.ty,a=e.a,n=e.b,o=e.c,l=e.d,h=t[0],u=t[1],c=t[2],_=t[3],d=t[4],f=t[5],p=t[6],m=t[7];e._bTransform?(i[0]=h*a+u*o+r,i[1]=h*n+u*l+s,i[2]=c*a+_*o+r,i[3]=c*n+_*l+s,i[4]=d*a+f*o+r,i[5]=d*n+f*l+s,i[6]=p*a+m*o+r,i[7]=p*n+m*l+s):(i[0]=h+r,i[1]=u+s,i[2]=c+r,i[3]=_+s,i[4]=d+r,i[5]=f+s,i[6]=p+r,i[7]=m+s)}clipedOff(t){return this._clipRect.width<=0||this._clipRect.height<=0}transformQuad(t,e,i,r,s,a,n){var o=0;0!=s&&(o=Math.tan(s*Math.PI/180)*r);var l=t+i,h=e+r,u=a.tx,c=a.ty,_=a.a,d=a.b,f=a.c,p=a.d,m=t+o,g=e,v=l+o,y=e,x=l,T=h,b=t,E=h;a._bTransform?(n[0]=m*_+g*f+u,n[1]=m*d+g*p+c,n[2]=v*_+y*f+u,n[3]=v*d+y*p+c,n[4]=x*_+T*f+u,n[5]=x*d+T*p+c,n[6]=b*_+E*f+u,n[7]=b*d+E*p+c):(n[0]=m+u,n[1]=g+c,n[2]=v+u,n[3]=y+c,n[4]=x+u,n[5]=T+c,n[6]=b+u,n[7]=E+c)}pushRT(){this.addRenderObject(L.SubmitCMD.create(null,G.RenderTexture2D.pushRT,this))}popRT(){this.addRenderObject(L.SubmitCMD.create(null,G.RenderTexture2D.popRT,this)),this.breakNextMerge()}useRT(t){this.addRenderObject(L.SubmitCMD.create([t],(function(t){if(!t)throw"error useRT";t.start(),t.clear(0,0,0,0)}),this)),this.breakNextMerge()}RTRestore(t){this.addRenderObject(L.SubmitCMD.create([t],(function(t){t.restore()}),this)),this.breakNextMerge()}breakNextMerge(){this._curSubmit=w.SubmitBase.RENDERBASE}_repaintSprite(){this.sprite&&this.sprite.repaint()}drawTextureWithTransform(t,e,i,r,s,a,o,l,h,u,c=null,_){var d,f=this._curMat;u&&(d=this.globalCompositeOperation,this.globalCompositeOperation=u);var p=this._colorFiler;if(c&&this.setColorFilter(c),!a)return this._drawTextureM(t,e+o,i+l,r,s,f,h,_),u&&(this.globalCompositeOperation=d),void(c&&this.setColorFilter(p));var m=this._tmpMatrix;m.a=a.a,m.b=a.b,m.c=a.c,m.d=a.d,m.tx=a.tx+o,m.ty=a.ty+l,m._bTransform=a._bTransform,a&&f._bTransform?(n.Matrix.mul(m,f,m),(a=m)._bTransform=!0):(m.tx+=f.tx,m.ty+=f.ty,a=m),this._drawTextureM(t,e,i,r,s,a,h,_),u&&(this.globalCompositeOperation=d),c&&this.setColorFilter(p)}_flushToTarget(t,e){U.RenderState2D.worldScissorTest=!1;var i=s.LayaGL.instance;i.disable(i.SCISSOR_TEST);var r=U.RenderState2D.worldAlpha,a=U.RenderState2D.worldMatrix4,o=U.RenderState2D.worldMatrix;U.RenderState2D.worldShaderDefines;U.RenderState2D.worldMatrix=n.Matrix.EMPTY,U.RenderState2D.restoreTempArray(),U.RenderState2D.worldMatrix4=U.RenderState2D.TEMPMAT4_ARRAY,U.RenderState2D.worldAlpha=1,y.BaseShader.activeShader=null,e.start(),t._submits._length>0&&e.clear(0,0,0,0),t._curSubmit=w.SubmitBase.RENDERBASE,t.flush(),t.clear(),e.restore(),t._curSubmit=w.SubmitBase.RENDERBASE,y.BaseShader.activeShader=null,U.RenderState2D.worldAlpha=r,U.RenderState2D.worldMatrix4=a,U.RenderState2D.worldMatrix=o}drawCanvas(t,e,i,r,s){if(t){var a,l=t.context;if(l._targets)l._submits._length>0&&(a=L.SubmitCMD.create([l,l._targets],this._flushToTarget,this),this._submits[this._submits._length++]=a),this._drawRenderTexture(l._targets,e,i,r,s,null,1,G.RenderTexture2D.flipyuv),this._curSubmit=w.SubmitBase.RENDERBASE;else{var h=t;h.touches&&h.touches.forEach((function(t){t.touch()})),a=M.SubmitCanvas.create(t,this._shader2D.ALPHA,this._shader2D.filters),this._submits[this._submits._length++]=a,a._key.clear();var u=a._matrix;this._curMat.copyTo(u);var c=u.tx,_=u.ty;u.tx=u.ty=0,u.transformPoint(o.Point.TEMP.setTo(e,i)),u.translate(o.Point.TEMP.x+c,o.Point.TEMP.y+_),n.Matrix.mul(h.invMat,u,u),this._curSubmit=w.SubmitBase.RENDERBASE}}}drawTarget(t,e,i,r,s,a,n,o=null,l=-1){this._drawCount++;if(this._mesh.vertNum+4>z._MAXVERTNUM&&(this._mesh=O.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh)),this.transformQuad(e,i,r,s,0,a||this._curMat,this._transedPoints),!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,o||Y.Texture.DEF_UV,4294967295,!0);var h=this._curSubmit=A.SubmitTarget.create(this,this._mesh,n,t);return h.blendType=-1==l?this._nBlendType:l,this._copyClipInfo(h,this._globalClipMatrix),h._numEle=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,this._submits[this._submits._length++]=h,this._curSubmit=w.SubmitBase.RENDERBASE,!0}return this._curSubmit=w.SubmitBase.RENDERBASE,!1}drawTriangles(t,e,i,s,a,o,l,h,u,c,_=4294967295){var d=null;if(c&&(d=this.globalCompositeOperation,this.globalCompositeOperation=c),t._getSource()){this._drawCount++;var f=this._tmpMatrix,p=this._triangleMesh,m=null,g=!1;u&&(m=this._colorFiler,this._colorFiler=u,this._curSubmit=w.SubmitBase.RENDERBASE,g=m!=u);var v=t.bitmap,y=this._curSubmit._key,x=y.submitType===w.SubmitBase.KEY_TRIANGLES&&y.other===v.id&&y.blendShader==this._nBlendType;if(p.vertNum+s.length/2>z._MAXVERTNUM&&(p=this._triangleMesh=F.MeshTexture.getAMesh(this.isMain),this.meshlist.push(p),x=!1),!x){var b=this._curSubmit=P.SubmitTexture.create(this,p,E.Value2D.create(T.ShaderDefines2D.TEXTURE2D,0));b.shaderValue.textureHost=t,b._renderType=w.SubmitBase.TYPE_TEXTURE,b._key.submitType=w.SubmitBase.KEY_TRIANGLES,b._key.other=v.id,this._copyClipInfo(b,this._globalClipMatrix),this._submits[this._submits._length++]=b}var C=this._mixRGBandAlpha(_,this._shader2D.ALPHA*h);this._drawTriUseAbsMatrix?p.addData(s,a,o,l,C):(l?(f.a=l.a,f.b=l.b,f.c=l.c,f.d=l.d,f.tx=l.tx+e,f.ty=l.ty+i):(f.a=1,f.b=0,f.c=0,f.d=1,f.tx=e,f.ty=i),n.Matrix.mul(f,this._curMat,f),p.addData(s,a,o,f||this._curMat,C)),this._curSubmit._numEle+=o.length,g&&(this._colorFiler=m,this._curSubmit=w.SubmitBase.RENDERBASE),c&&(this.globalCompositeOperation=d)}else this.sprite&&r.ILaya.systemTimer.callLater(this,this._repaintSprite)}transform(t,e,i,r,s,a){m.SaveTransform.save(this),n.Matrix.mul(n.Matrix.TEMP.setTo(t,e,i,r,s,a),this._curMat,this._curMat),this._curMat._checkTransform()}_transformByMatrix(t,e,i){t.setTranslate(e,i),n.Matrix.mul(t,this._curMat,this._curMat),t.setTranslate(0,0),this._curMat._bTransform=!0}setTransformByMatrix(t){t.copyTo(this._curMat)}rotate(t){m.SaveTransform.save(this),this._curMat.rotateEx(t)}scale(t,e){m.SaveTransform.save(this),this._curMat.scaleEx(t,e)}clipRect(t,e,i,r){f.SaveClipRect.save(this),this._clipRect==z.MAXCLIPRECT?this._clipRect=new l.Rectangle(t,e,i,r):(this._clipRect.width=i,this._clipRect.height=r,this._clipRect.x=t,this._clipRect.y=e),this._clipID_Gen++,this._clipID_Gen%=1e4,this._clipInfoID=this._clipID_Gen;var s=this._globalClipMatrix,a=s.tx,n=s.ty,o=a+s.a,h=n+s.d;if(this._clipRect.width>=z._MAXSIZE?(s.a=s.d=z._MAXSIZE,s.b=s.c=s.tx=s.ty=0):(this._curMat._bTransform?(s.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx,s.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty,s.a=this._clipRect.width*this._curMat.a,s.b=this._clipRect.width*this._curMat.b,s.c=this._clipRect.height*this._curMat.c,s.d=this._clipRect.height*this._curMat.d):(s.tx=this._clipRect.x+this._curMat.tx,s.ty=this._clipRect.y+this._curMat.ty,s.a=this._clipRect.width,s.b=s.c=0,s.d=this._clipRect.height),this._incache&&(this._clipInCache=!0)),s.a>0&&s.d>0){var u=s.tx+s.a,c=s.ty+s.d;u<=a||c<=n||s.tx>=o||s.ty>=h?(s.a=-.1,s.d=-.1):(s.tx<a&&(s.a-=a-s.tx,s.tx=a),u>o&&(s.a-=u-o),s.ty<n&&(s.d-=n-s.ty,s.ty=n),c>h&&(s.d-=c-h),s.a<=0&&(s.a=-.1),s.d<=0&&(s.d=-.1))}}drawMesh(t,e,i,r,s,a,n,o,l=0){}addRenderObject(t){this._submits[this._submits._length++]=t}submitElement(t,e){this.isMain;var i=this._submits,r=i._length;e<0&&(e=i._length);for(var s=w.SubmitBase.RENDERBASE;t<e;)this._renderNextSubmitIndex=t+1,i[t]!==w.SubmitBase.RENDERBASE?(w.SubmitBase.preRender=s,t+=(s=i[t]).renderSubmit()):t++;return r}flush(){this._clipID_Gen=0;var t=this.submitElement(0,this._submits._length);this._path&&this._path.reset(),b.SkinMeshBuffer.instance&&b.SkinMeshBuffer.getInstance().reset(),this._curSubmit=w.SubmitBase.RENDERBASE;for(var e=0,i=this.meshlist.length;e<i;e++){var r=this.meshlist[e];r.canReuse?r.releaseMesh():r.destroy()}return this.meshlist.length=0,this._mesh=O.MeshQuadTexture.getAMesh(this.isMain),this._pathMesh=N.MeshVG.getAMesh(this.isMain),this._triangleMesh=F.MeshTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh),this._flushCnt++,this._flushCnt%60==0&&this.isMain&&B.TextRender.textRenderInst&&B.TextRender.textRenderInst.GC(),t}beginPath(t=!1){this._getPath().beginPath(t)}closePath(){this._path.closePath()}addPath(t,e,i,r,s){for(var a=0,n=0,o=t.length/2;n<o;n++){var l=t[a]+r,h=t[a+1]+s;t[a]=l,t[a+1]=h,a+=2}this._getPath().push(t,i)}fill(){var t=this._curMat,e=this._getPath(),i=this._curSubmit,r=i._key.submitType===w.SubmitBase.KEY_VG&&i._key.blendShader===this._nBlendType;r&&(r=r&&this.isSameClipInfo(i)),r||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var s,a=this.mixRGBandAlpha(this.fillStyle.toInt()),n=0,o=0,l=e.paths.length;o<l;o++){var h=e.paths[o],u=h.path.length/2;if(!(u<3||3==u&&!h.convex)){var c,_,d,f,p=h.path.concat(),m=0;if(t._bTransform)for(m=0;m<u;m++)_=(c=m<<1)+1,d=p[c],f=p[_],p[c]=t.a*d+t.c*f+t.tx,p[_]=t.b*d+t.d*f+t.ty;else for(m=0;m<u;m++)_=(c=m<<1)+1,d=p[c],f=p[_],p[c]=d+t.tx,p[_]=f+t.ty;this._pathMesh.vertNum+u>z._MAXVERTNUM&&(this._curSubmit._numEle+=n,n=0,this._pathMesh=N.MeshVG.getAMesh(this.isMain),this._curSubmit=this.addVGSubmit(this._pathMesh));var g=this._pathMesh.vertNum;if(h.convex){var v=u-2;s=new Array(3*v);for(var y=0,x=0;x<v;x++)s[y++]=g,s[y++]=x+1+g,s[y++]=x+2+g}else if(s=S.Earcut.earcut(p,null,2),g>0)for(var T=0;T<s.length;T++)s[T]+=g;this._pathMesh.addVertAndIBToMesh(this,p,a,s),n+=s.length}}this._curSubmit._numEle+=n}addVGSubmit(t){var e=R.Submit.createShape(this,t,0,E.Value2D.create(T.ShaderDefines2D.PRIMITIVE,0));return e._key.submitType=w.SubmitBase.KEY_VG,this._submits[this._submits._length++]=e,this._copyClipInfo(e,this._globalClipMatrix),e}stroke(){if(this.lineWidth>0){var t=this.mixRGBandAlpha(this.strokeStyle._color.numColor),e=this._getPath(),i=this._curSubmit,r=i._key.submitType===w.SubmitBase.KEY_VG&&i._key.blendShader===this._nBlendType;r&&(r=r&&this.isSameClipInfo(i)),r||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var s=0,a=0,n=e.paths.length;a<n;a++){var o=e.paths[a];if(!(o.path.length<=0)){var l=[],h=[],u=2*o.path.length;if(!(u<2)){this._pathMesh.vertNum+u>z._MAXVERTNUM&&(this._curSubmit._numEle+=s,s=0,this._pathMesh=N.MeshVG.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._curSubmit=this.addVGSubmit(this._pathMesh)),C.BasePoly.createLine2(o.path,l,this.lineWidth,this._pathMesh.vertNum,h,o.loop);var c,_,d,f,p=h.length/2,m=this._curMat,g=0;if(m._bTransform)for(g=0;g<p;g++)_=(c=g<<1)+1,d=h[c],f=h[_],h[c]=m.a*d+m.c*f+m.tx,h[_]=m.b*d+m.d*f+m.ty;else for(g=0;g<p;g++)_=(c=g<<1)+1,d=h[c],f=h[_],h[c]=d+m.tx,h[_]=f+m.ty;this._pathMesh.addVertAndIBToMesh(this,h,t,l),s+=l.length}}}this._curSubmit._numEle+=s}}moveTo(t,e){var i=this._getPath();i.newPath(),i._lastOriX=t,i._lastOriY=e,i.addPoint(t,e)}lineTo(t,e){var i=this._getPath();Math.abs(t-i._lastOriX)<.001&&Math.abs(e-i._lastOriY)<.001||(i._lastOriX=t,i._lastOriY=e,i.addPoint(t,e))}arcTo(t,e,i,r,s){var a=0,n=0,o=0,l=this._path._lastOriX-t,h=this._path._lastOriY-e,u=Math.sqrt(l*l+h*h);if(!(u<=1e-6)){var c=l/u,_=h/u,d=i-t,f=r-e,p=d*d+f*f,m=Math.sqrt(p);if(!(m<=1e-6)){var g=d/m,v=f/m,y=c+g,x=_+v,T=Math.sqrt(y*y+x*x);if(!(T<=1e-6)){var b=y/T,E=x/T,C=Math.acos(b*c+E*_),S=Math.PI/2-C,R=(u=s/Math.tan(S))*c+t,w=u*_+e,M=Math.sqrt(u*u+s*s),L=t+b*M,I=e+E*M,A=0,P=0;if(c*v-_*g>=0){var D=2*S/z.SEGNUM;A=Math.sin(D),P=Math.cos(D)}else D=2*-S/z.SEGNUM,A=Math.sin(D),P=Math.cos(D);var B=this._path._lastOriX,O=this._path._lastOriY,F=R,N=w;(Math.abs(F-this._path._lastOriX)>.1||Math.abs(N-this._path._lastOriY)>.1)&&(n=F,o=N,B=F,O=N,this._path._lastOriX=n,this._path._lastOriY=o,this._path.addPoint(n,o));var U=R-L,k=w-I;for(a=0;a<z.SEGNUM;a++){var G=U*P+k*A,W=-U*A+k*P;n=G+L,o=W+I,(Math.abs(B-n)>.1||Math.abs(O-o)>.1)&&(this._path._lastOriX=n,this._path._lastOriY=o,this._path.addPoint(n,o),B=n,O=o),U=G,k=W}}}}}arc(t,e,i,r,s,a=!1,n=!0){var o,l,h,u=0,c=0,_=0,d=0,f=0,p=0;if(c=s-r,a)if(Math.abs(c)>=2*Math.PI)c=2*-Math.PI;else for(;c>0;)c-=2*Math.PI;else if(Math.abs(c)>=2*Math.PI)c=2*Math.PI;else for(;c<0;)c+=2*Math.PI;var m=this.getMatScaleX(),g=this.getMatScaleY(),v=i*(m>g?m:g),y=2*Math.PI*v;o=c/(h=0|Math.max(y/10,10))/2,_=Math.abs(4/3*(1-Math.cos(o))/Math.sin(o)),a&&(_=-_);var x=this._getPath();for(l=0;l<=h;l++)u=r+c*(l/h),d=Math.cos(u),p=e+Math.sin(u)*i,(f=t+d*i)==this._path._lastOriX&&p==this._path._lastOriY||x.addPoint(f,p);d=Math.cos(s),p=e+Math.sin(s)*i,(f=t+d*i)==this._path._lastOriX&&p==this._path._lastOriY||x.addPoint(f,p)}quadraticCurveTo(t,e,i,r){for(var s=a.Bezier.I.getBezierPoints([this._path._lastOriX,this._path._lastOriY,t,e,i,r],30,2),n=0,o=s.length/2;n<o;n++)this.lineTo(s[2*n],s[2*n+1]);this.lineTo(i,r)}mixRGBandAlpha(t){return this._mixRGBandAlpha(t,this._shader2D.ALPHA)}_mixRGBandAlpha(t,e){if(e>=1)return t;var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24}strokeRect(t,e,i,r,s){if(this.lineWidth>0){var a=this.mixRGBandAlpha(this.strokeStyle._color.numColor),n=this.lineWidth/2;this._fillRect(t-n,e-n,i+this.lineWidth,this.lineWidth,a),this._fillRect(t-n,e-n+r,i+this.lineWidth,this.lineWidth,a),this._fillRect(t-n,e+n,this.lineWidth,r-this.lineWidth,a),this._fillRect(t-n+i,e+n,this.lineWidth,r-this.lineWidth,a)}}clip(){}drawParticle(t,e,i){i.x=t,i.y=e,this._submits[this._submits._length++]=i}_getPath(){return this._path||(this._path=new _.Path)}get canvas(){return this._canvas}_fillTexture_h(t,e,i,r,s,a,n,o){r<=0&&console.error("_fillTexture_h error: oriw must>0");for(var l=a,h=Math.floor(o/r),u=o%r,c=0;c<h;c++)this._inner_drawTexture(t,e,l,n,r,s,this._curMat,i,1,!1),l+=r;if(u>0){var _=i[2]-i[0],d=i[0]+_*(u/r),f=z.tmpuv1;f[0]=i[0],f[1]=i[1],f[2]=d,f[3]=i[3],f[4]=d,f[5]=i[5],f[6]=i[6],f[7]=i[7],this._inner_drawTexture(t,e,l,n,u,s,this._curMat,f,1,!1)}}_fillTexture_v(t,e,i,r,s,a,n,o){s<=0&&console.error("_fillTexture_v error: orih must>0");for(var l=n,h=Math.floor(o/s),u=o%s,c=0;c<h;c++)this._inner_drawTexture(t,e,a,l,r,s,this._curMat,i,1,!1),l+=s;if(u>0){var _=i[7]-i[1],d=i[1]+_*(u/s),f=z.tmpuv1;f[0]=i[0],f[1]=i[1],f[2]=i[2],f[3]=i[3],f[4]=i[4],f[5]=d,f[6]=i[6],f[7]=d,this._inner_drawTexture(t,e,a,l,r,u,this._curMat,f,1,!1)}}drawTextureWithSizeGrid(t,e,i,r,s,a,n,o){if(t._getSource()){e+=n,i+=o;var l=t.uv,h=t.bitmap.width,u=t.bitmap.height,c=a[0],_=a[3],d=c/u,f=_/h,p=a[1],m=a[2],g=p/h,v=m/u,y=a[4],x=!1;if(r==h&&(_=p=0),s==u&&(c=m=0),_+p>r){var T=r;x=!0,r=_+p,this.save(),this.clipRect(0+e,0+i,T,s)}var b=t.bitmap.id,E=this._curMat,C=this._tempUV,S=l[0],R=l[1],w=l[4],M=l[5],L=S,I=R,A=w,P=M;if(_&&c&&(A=S+f,P=R+d,C[0]=S,C[1]=R,C[2]=A,C[3]=R,C[4]=A,C[5]=P,C[6]=S,C[7]=P,this._inner_drawTexture(t,b,e,i,_,c,E,C,1,!1)),p&&c&&(L=w-g,I=R,A=w,P=R+d,C[0]=L,C[1]=I,C[2]=A,C[3]=I,C[4]=A,C[5]=P,C[6]=L,C[7]=P,this._inner_drawTexture(t,b,r-p+e,0+i,p,c,E,C,1,!1)),_&&m&&(L=S,I=M-v,A=S+f,P=M,C[0]=L,C[1]=I,C[2]=A,C[3]=I,C[4]=A,C[5]=P,C[6]=L,C[7]=P,this._inner_drawTexture(t,b,0+e,s-m+i,_,m,E,C,1,!1)),p&&m&&(L=w-g,I=M-v,A=w,P=M,C[0]=L,C[1]=I,C[2]=A,C[3]=I,C[4]=A,C[5]=P,C[6]=L,C[7]=P,this._inner_drawTexture(t,b,r-p+e,s-m+i,p,m,E,C,1,!1)),c&&(L=S+f,I=R,A=w-g,P=R+d,C[0]=L,C[1]=I,C[2]=A,C[3]=I,C[4]=A,C[5]=P,C[6]=L,C[7]=P,y?this._fillTexture_h(t,b,C,t.width-_-p,c,_+e,i,r-_-p):this._inner_drawTexture(t,b,_+e,i,r-_-p,c,E,C,1,!1)),m&&(L=S+f,I=M-v,A=w-g,P=M,C[0]=L,C[1]=I,C[2]=A,C[3]=I,C[4]=A,C[5]=P,C[6]=L,C[7]=P,y?this._fillTexture_h(t,b,C,t.width-_-p,m,_+e,s-m+i,r-_-p):this._inner_drawTexture(t,b,_+e,s-m+i,r-_-p,m,E,C,1,!1)),_&&(L=S,I=R+d,A=S+f,P=M-v,C[0]=L,C[1]=I,C[2]=A,C[3]=I,C[4]=A,C[5]=P,C[6]=L,C[7]=P,y?this._fillTexture_v(t,b,C,_,t.height-c-m,e,c+i,s-c-m):this._inner_drawTexture(t,b,e,c+i,_,s-c-m,E,C,1,!1)),p&&(L=w-g,I=R+d,A=w,P=M-v,C[0]=L,C[1]=I,C[2]=A,C[3]=I,C[4]=A,C[5]=P,C[6]=L,C[7]=P,y?this._fillTexture_v(t,b,C,p,t.height-c-m,r-p+e,c+i,s-c-m):this._inner_drawTexture(t,b,r-p+e,c+i,p,s-c-m,E,C,1,!1)),L=S+f,I=R+d,A=w-g,P=M-v,C[0]=L,C[1]=I,C[2]=A,C[3]=I,C[4]=A,C[5]=P,C[6]=L,C[7]=P,y){var D=z.tmpUVRect;D[0]=L,D[1]=I,D[2]=A-L,D[3]=P-I,this._fillTexture(t,t.width-_-p,t.height-c-m,D,_+e,c+i,r-_-p,s-c-m,"repeat",0,0)}else this._inner_drawTexture(t,b,_+e,c+i,r-_-p,s-c-m,E,C,1,!1);x&&this.restore()}}}e.Context=z,z.ENUM_TEXTALIGN_DEFAULT=0,z.ENUM_TEXTALIGN_CENTER=1,z.ENUM_TEXTALIGN_RIGHT=2,z._SUBMITVBSIZE=32e3,z._MAXSIZE=99999999,z._MAXVERTNUM=65535,z.MAXCLIPRECT=null,z._COUNT=0,z.SEGNUM=32,z._contextcount=0,z.PI2=2*Math.PI,z._textRender=null,z.tmpuv1=[0,0,0,0,0,0,0,0],z.tmpUV=[0,0,0,0,0,0,0,0],z.tmpUVRect=[0,0,0,0];class H{constructor(){this.lineWidth=1}clear(){this.lineWidth=1,this.textAlign=this.textBaseline=null}make(){return this===H.DEFAULT?new H:this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(21);class s{constructor(){}static _createArray(){var t=[];return t._length=0,t}static _init(){var t=s._namemap={};return t[s.TYPE_ALPHA]="ALPHA",t[s.TYPE_FILESTYLE]="fillStyle",t[s.TYPE_FONT]="font",t[s.TYPE_LINEWIDTH]="lineWidth",t[s.TYPE_STROKESTYLE]="strokeStyle",t[s.TYPE_ENABLEMERGE]="_mergeID",t[s.TYPE_MARK]=t[s.TYPE_TRANSFORM]=t[s.TYPE_TRANSLATE]=[],t[s.TYPE_TEXTBASELINE]="textBaseline",t[s.TYPE_TEXTALIGN]="textAlign",t[s.TYPE_GLOBALCOMPOSITEOPERATION]="_nBlendType",t[s.TYPE_SHADER]="shader",t[s.TYPE_FILTERS]="filters",t[s.TYPE_COLORFILTER]="_colorFiler",t}isSaveMark(){return!1}restore(t){this._dataObj[this._valueName]=this._value,s.POOL[s.POOL._length++]=this,this._newSubmit&&(t._curSubmit=r.SubmitBase.RENDERBASE)}static save(t,e,i,r){if((t._saveMark._saveuse&e)!==e){t._saveMark._saveuse|=e;var a=s.POOL,n=a._length>0?a[--a._length]:new s;n._value=i[n._valueName=s._namemap[e]],n._dataObj=i,n._newSubmit=r;var o=t._save;o[o._length++]=n}}}e.SaveBase=s,s.TYPE_ALPHA=1,s.TYPE_FILESTYLE=2,s.TYPE_FONT=8,s.TYPE_LINEWIDTH=256,s.TYPE_STROKESTYLE=512,s.TYPE_MARK=1024,s.TYPE_TRANSFORM=2048,s.TYPE_TRANSLATE=4096,s.TYPE_ENABLEMERGE=8192,s.TYPE_TEXTBASELINE=16384,s.TYPE_TEXTALIGN=32768,s.TYPE_GLOBALCOMPOSITEOPERATION=65536,s.TYPE_CLIPRECT=131072,s.TYPE_CLIPRECT_STENCIL=262144,s.TYPE_IBVB=524288,s.TYPE_SHADER=1048576,s.TYPE_FILTERS=2097152,s.TYPE_FILTERS_TYPE=4194304,s.TYPE_COLORFILTER=8388608,s.POOL=s._createArray(),s._namemap=s._init()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{}e.CONST3D2D=r,r.BYTES_PE=4,r.BYTES_PIDX=2,r.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],r.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],r._TMPARRAY=[],r._OFFSETX=0,r._OFFSETY=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(28),s=i(27),a=i(153),n=i(2),o=i(5),l=i(10),h=i(54),u=i(0),c=i(9);class _ extends r.Sprite{constructor(){super(),this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=0,this._startY=0,this._charSize={},this._valign="top",this._fontSize=_.defaultFontSize,this._font=_.defaultFont,this._color="#000000",this._singleCharRender=!1,this.overflow=_.VISIBLE,this._style=a.TextStyle.EMPTY}static defaultFontStr(){return _.defaultFontSize+"px "+_.defaultFont}getStyle(){return this._style===a.TextStyle.EMPTY&&(this._style=a.TextStyle.create()),this._style}_getTextStyle(){return this._style===a.TextStyle.EMPTY&&(this._style=a.TextStyle.create()),this._style}static registerBitmapFont(t,e){_._bitmapFonts||(_._bitmapFonts={}),_._bitmapFonts[t]=e}static unregisterBitmapFont(t,e=!0){if(_._bitmapFonts&&_._bitmapFonts[t]){var i=_._bitmapFonts[t];e&&i.destroy(),delete _._bitmapFonts[t]}}destroy(t=!0){super.destroy(t),this._clipPoint=null,this._lines=null,this._lineWidths=null,this._words&&this._words.forEach((function(t){t.cleanCache()})),this._words=null,this._charSize=null}_getBoundPointsM(t=!1){var e=l.Rectangle.TEMP;return e.setTo(0,0,this.width,this.height),e._getBoundPoints()}getGraphicBounds(t=!1){var e=l.Rectangle.TEMP;return e.setTo(0,0,this.width,this.height),e}get width(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]}set width(t){t!=this._width&&(super.set_width(t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}_getCSSStyle(){return this._style}get height(){return this._height?this._height:this.textHeight}set height(t){t!=this._height&&(super.set_height(t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}get textWidth(){return this._isChanged&&u.ILaya.systemTimer.runCallLater(this,this.typeset),this._textWidth}get textHeight(){return this._isChanged&&u.ILaya.systemTimer.runCallLater(this,this.typeset),this._textHeight}get text(){return this._text||""}get_text(){return this._text||""}set_text(t){this._text!==t&&(this.lang(t+""),this.isChanged=!0,this.event(n.Event.CHANGE),this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}set text(t){this.set_text(t)}lang(t,e=null,i=null,r=null,s=null,a=null,n=null,o=null,l=null,h=null,u=null){if(t=_.langPacks&&_.langPacks[t]?_.langPacks[t]:t,arguments.length<2)this._text=t;else{for(var c=0,d=arguments.length;c<d;c++)t=t.replace("{"+c+"}",arguments[c+1]);this._text=t}}get font(){return this._font}set font(t){this._style.currBitmapFont&&(this._getTextStyle().currBitmapFont=null,this.scale(1,1)),_._bitmapFonts&&_._bitmapFonts[t]&&(this._getTextStyle().currBitmapFont=_._bitmapFonts[t]),this._font=t,this.isChanged=!0}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!=t&&(this._fontSize=t,this.isChanged=!0)}get bold(){return this._style.bold}set bold(t){this._getTextStyle().bold=t,this.isChanged=!0}get color(){return this._color}set color(t){this.set_color(t)}get_color(){return this._color}set_color(t){this._color!=t&&(this._color=t,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}get italic(){return this._style.italic}set italic(t){this._getTextStyle().italic=t,this.isChanged=!0}get align(){return this._style.align}set align(t){this._getTextStyle().align=t,this.isChanged=!0}get valign(){return this._valign}set valign(t){this._valign=t,this.isChanged=!0}get wordWrap(){return this._style.wordWrap}set wordWrap(t){this._getTextStyle().wordWrap=t,this.isChanged=!0}get leading(){return this._style.leading}set leading(t){this._getTextStyle().leading=t,this.isChanged=!0}get padding(){return this._style.padding}set padding(t){if("string"==typeof t){var e,i,r;for(r=(e=t.split(",")).length;e.length<4;)e.push(0);for(i=0;i<r;i++)e[i]=parseFloat(e[i])||0;t=e}this._getTextStyle().padding=t,this.isChanged=!0}get bgColor(){return this._style.bgColor}set bgColor(t){this.set_bgColor(t)}set_bgColor(t){this._getTextStyle().bgColor=t,this._renderType|=s.SpriteConst.STYLE,this._setBgStyleColor(0,0,this.width,this.height,t),this._setRenderType(this._renderType),this.isChanged=!0}get_bgColor(){return this._style.bgColor}get borderColor(){return this._style.borderColor}set borderColor(t){this._getTextStyle().borderColor=t,this._renderType|=s.SpriteConst.STYLE,this._setBorderStyleColor(0,0,this.width,this.height,t,1),this._setRenderType(this._renderType),this.isChanged=!0}get stroke(){return this._style.stroke}set stroke(t){this._getTextStyle().stroke=t,this.isChanged=!0}get strokeColor(){return this._style.strokeColor}set strokeColor(t){this._getTextStyle().strokeColor=t,this.isChanged=!0}set isChanged(t){this._isChanged!==t&&(this._isChanged=t,t&&u.ILaya.systemTimer.callLater(this,this.typeset))}_getContextFont(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(u.ILaya.Browser.onIPhone&&_.fontFamilyMap[this.font]||this.font)}_isPassWordMode(){var t=this._style.asPassword;return"prompt"in this&&this.prompt==this._text&&(t=!1),t}_getPassWordTxt(t){var e;e="";for(var i=t.length;i>0;i--)e+="●";return e}_renderText(){var t=this.padding,e=this._lines.length;this.overflow!=_.VISIBLE&&(e=Math.min(e,Math.floor((this.height-t[0]-t[2])/(this.leading+this._charSize.height))+1));var i=this.scrollY/(this._charSize.height+this.leading)|0,r=this.graphics;r.clear(!0);var s=this._getContextFont();u.ILaya.Browser.context.font=s;var a=t[3],n="left",o=this._lines,l=this.leading+this._charSize.height,c=this._style.currBitmapFont;c&&(l=this.leading+c.getMaxHeight());var d=t[0];if(!c&&this._width>0&&this._textWidth<=this._width&&("right"==this.align?(n="right",a=this._width-t[1]):"center"==this.align&&(n="center",a=.5*this._width+t[3]-t[1])),this._height>0){var f=this._textHeight>this._height?"top":this.valign;"middle"===f?d=.5*(this._height-e*l)+t[0]-t[2]:"bottom"===f&&(d=this._height-e*l-t[2])}var p=this._style;if(c&&c.autoScaleSize)var m=c.fontSize/this.fontSize;if(this._clipPoint){var g,v;if(r.save(),c&&c.autoScaleSize)g=this._width?this._width-t[3]-t[1]:this._textWidth,v=this._height?this._height-t[0]-t[2]:this._textHeight,g*=m,v*=m,r.clipRect(t[3],t[0],g,v);else r.clipRect(t[3],t[0],this._width?this._width-t[3]-t[1]:this._textWidth,this._height?this._height-t[0]-t[2]:this._textHeight);this.repaint()}var y=p.asPassword;"prompt"in this&&this.prompt==this._text&&(y=!1);for(var x=0,T=0,b=Math.min(this._lines.length,e+i)||1,E=i;E<b;E++){var C,S=o[E];if(y){var R=S.length;S="";for(var w=R;w>0;w--)S+="●"}if(null==S&&(S=""),x=a-(this._clipPoint?this._clipPoint.x:0),T=d+l*E-(this._clipPoint?this._clipPoint.y:0),this.underline&&this._drawUnderline(n,x,T,E),c){var M=this.width;c.autoScaleSize&&(M=this.width*m),c._drawText(S,this,x,T,this.align,M)}else this._words||(this._words=[]),this._words.length>E-i?C=this._words[E-i]:(C=new h.WordText,this._words.push(C)),C.setText(S),C.splitRender=this._singleCharRender,p.stroke?r.fillBorderText(C,x,T,s,this.color,p.strokeColor,p.stroke,n):r.fillText(C,x,T,s,this.color,n)}if(c&&c.autoScaleSize){var L=1/m;this.scale(L,L)}this._clipPoint&&r.restore(),this._startX=a,this._startY=d}_drawUnderline(t,e,i,r){var s=this._lineWidths[r];switch(t){case"center":e-=s/2;break;case"right":e-=s}i+=this._charSize.height,this._graphics.drawLine(e,i,e+s,i,this.underlineColor||this.color,1)}typeset(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);u.ILaya.Render.isConchApp?window.conchTextCanvas.font=this._getContextFont():u.ILaya.Browser.context.font=this._getContextFont(),this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this._parseLines(this._getPassWordTxt(this._text)):this._parseLines(this._text),this._evalTextSize(),this._checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new o.Point(0,0)):this._clipPoint=null,this._renderText()}_evalTextSize(){var t,e;t=Math.max.apply(this,this._lineWidths),e=this._style.currBitmapFont?this._lines.length*(this._style.currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],t==this._textWidth&&e==this._textHeight||(this._textWidth=t,this._textHeight=e)}_checkEnabledViewportOrNot(){return this.overflow==_.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)}changeText(t){this._text!==t&&(this.lang(t+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())}_parseLines(t){var e=this.wordWrap||this.overflow==_.HIDDEN;if(e)var i=this._getWordWrapWidth();var r=this._style.currBitmapFont;if(r)this._charSize.width=r.getMaxWidth(),this._charSize.height=r.getMaxHeight();else{var s=null;(s=u.ILaya.Render.isConchApp?window.conchTextCanvas.measureText(_._testWord):u.ILaya.Browser.context.measureText(_._testWord))||(s={width:100}),this._charSize.width=s.width,this._charSize.height=s.height||this.fontSize}for(var a=t.replace(/\r\n/g,"\n").split("\n"),n=0,o=a.length;n<o;n++){var l=a[n];e?this._parseLine(l,i):(this._lineWidths.push(this._getTextWidth(l)),this._lines.push(l))}}_parseLine(t,e){var i=this._lines,r=0,s=0,a=0,n=0;if((s=this._getTextWidth(t))<=e)return i.push(t),void this._lineWidths.push(s);s=this._charSize.width,0==(r=Math.floor(e/s))&&(r=1),a=s=this._getTextWidth(t.substring(0,r));for(var o=r,l=t.length;o<l;o++)if((a+=s=this._getTextWidth(t.charAt(o)))>e)if(this.wordWrap){var h=t.substring(n,o);if(h.charCodeAt(h.length-1)<255){var u=/(?:\w|-)+$/.exec(h);u&&(o=u.index+n,0==u.index?o+=h.length:h=t.substring(n,o))}if(i.push(h),this._lineWidths.push(a-s),n=o,!(o+r<l)){i.push(t.substring(n,l)),this._lineWidths.push(this._getTextWidth(i[i.length-1])),n=-1;break}o+=r,a=s=this._getTextWidth(t.substring(n,o)),o--}else if(this.overflow==_.HIDDEN)return i.push(t.substring(0,o)),void this._lineWidths.push(this._getTextWidth(i[i.length-1]));this.wordWrap&&-1!=n&&(i.push(t.substring(n,l)),this._lineWidths.push(this._getTextWidth(i[i.length-1])))}_getTextWidth(t){var e=this._style.currBitmapFont;if(e)return e.getTextWidth(t);if(u.ILaya.Render.isConchApp)return window.conchTextCanvas.measureText(t).width;return(u.ILaya.Browser.context.measureText(t)||{width:100}).width}_getWordWrapWidth(){var t,e=this.padding,i=this._style.currBitmapFont;return(t=i&&i.autoScaleSize?this._width*(i.fontSize/this.fontSize):this._width)<=0&&(t=this.wordWrap?100:u.ILaya.Browser.width),t<=0&&(t=100),t-e[3]-e[1]}getCharPoint(t,e=null){this._isChanged&&u.ILaya.systemTimer.runCallLater(this,this.typeset);for(var i=0,r=this._lines,s=0,a=0,n=r.length;a<n;a++){if(t<(i+=r[a].length)){var l=a;break}s=i}var h=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;u.ILaya.Browser.context.font=h;var c=this._getTextWidth(this._text.substring(s,t));return(e||new o.Point).setTo(this._startX+c-(this._clipPoint?this._clipPoint.x:0),this._startY+l*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))}set scrollX(t){if(!(this.overflow!=_.SCROLL||this.textWidth<this._width)&&this._clipPoint){t=t<this.padding[3]?this.padding[3]:t;var e=this._textWidth-this._width;t=t>e?e:t,this._clipPoint.x=t,this._renderText()}}get scrollX(){return this._clipPoint?this._clipPoint.x:0}set scrollY(t){if(!(this.overflow!=_.SCROLL||this.textHeight<this._height)&&this._clipPoint){t=t<this.padding[0]?this.padding[0]:t;var e=this._textHeight-this._height;t=t>e?e:t,this._clipPoint.y=t,this._renderText()}}get scrollY(){return this._clipPoint?this._clipPoint.y:0}get maxScrollX(){return this.textWidth<this._width?0:this._textWidth-this._width}get maxScrollY(){return this.textHeight<this._height?0:this._textHeight-this._height}get lines(){return this._isChanged&&this.typeset(),this._lines}get underlineColor(){return this._style.underlineColor}set underlineColor(t){this._getTextStyle().underlineColor=t,this._isChanged||this._renderText()}get underline(){return this._style.underline}set underline(t){this._getTextStyle().underline=t}set singleCharRender(t){this._singleCharRender=t}get singleCharRender(){return this._singleCharRender}}e.Text=_,_.VISIBLE="visible",_.SCROLL="scroll",_.HIDDEN="hidden",_.defaultFontSize=12,_.defaultFont="Arial",_.isComplexText=!1,_.fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"},_._testWord="游",_.CharacterCache=!0,_.RightToLeft=!1,u.ILaya.regClass(_),c.ClassUtils.regClass("laya.display.Text",_),c.ClassUtils.regClass("Laya.Text",_)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(44),s=i(20);class a extends r.Filter{constructor(t=null){super(),t||(t=this._copyMatrix(a.IDENTITY_MATRIX)),this._mat=new Float32Array(16),this._alpha=new Float32Array(4),this.setByMatrix(t)}gray(){return this.setByMatrix(a.GRAY_MATRIX)}color(t=0,e=0,i=0,r=1){return this.setByMatrix([1,0,0,0,t,0,1,0,0,e,0,0,1,0,i,0,0,0,1,r])}setColor(t){var e=s.ColorUtils.create(t).arrColor,i=[0,0,0,0,256*e[0],0,0,0,0,256*e[1],0,0,0,0,256*e[2],0,0,0,1,0];return this.setByMatrix(i)}setByMatrix(t){this._matrix!=t&&this._copyMatrix(t);for(var e=0,i=0,r=0;r<20;r++)r%5!=4?this._mat[e++]=t[r]:this._alpha[i++]=t[r];return this}get type(){return r.Filter.COLOR}adjustColor(t,e,i,r){return this.adjustHue(r),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i),this}adjustBrightness(t){return 0==(t=this._clampValue(t,100))||isNaN(t)?this:this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}adjustContrast(t){if(0==(t=this._clampValue(t,100))||isNaN(t))return this;var e,i=(e=t<0?127+t/100*127:127*(e=0==(e=t%1)?a.DELTA_INDEX[t]:a.DELTA_INDEX[t<<0]*(1-e)+a.DELTA_INDEX[1+(t<<0)]*e)+127)/127,r=.5*(127-e);return this._multiplyMatrix([i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0,0,0,0,0,1])}adjustSaturation(t){if(0==(t=this._clampValue(t,100))||isNaN(t))return this;var e=1+(t>0?3*t/100:t/100),i=1-e,r=.3086*i,s=.6094*i,a=.082*i;return this._multiplyMatrix([r+e,s,a,0,0,r,s+e,a,0,0,r,s,a+e,0,0,0,0,0,1,0,0,0,0,0,1])}adjustHue(t){if(0==(t=this._clampValue(t,180)/180*Math.PI)||isNaN(t))return this;var e=Math.cos(t),i=Math.sin(t),r=.213,s=.715,a=.072;return this._multiplyMatrix([r+e*(1-r)+i*-r,s+e*-s+i*-s,a+e*-a+i*(1-a),0,0,r+e*-r+.143*i,s+e*(1-s)+.14*i,a+e*-a+-.283*i,0,0,r+e*-r+-.787*i,s+e*-s+i*s,a+e*(1-a)+i*a,0,0,0,0,0,1,0,0,0,0,0,1])}reset(){return this.setByMatrix(this._copyMatrix(a.IDENTITY_MATRIX))}_multiplyMatrix(t){var e=[];this._matrix=this._fixMatrix(this._matrix);for(var i=0;i<5;i++){for(var r=0;r<5;r++)e[r]=this._matrix[r+5*i];for(r=0;r<5;r++){for(var s=0,a=0;a<5;a++)s+=t[r+5*a]*e[a];this._matrix[r+5*i]=s}}return this.setByMatrix(this._matrix)}_clampValue(t,e){return Math.min(e,Math.max(-e,t))}_fixMatrix(t=null){return null==t?a.IDENTITY_MATRIX:(t.length<a.LENGTH?t=t.slice(0,t.length).concat(a.IDENTITY_MATRIX.slice(t.length,a.LENGTH)):t.length>a.LENGTH&&(t=t.slice(0,a.LENGTH)),t)}_copyMatrix(t){var e=a.LENGTH;this._matrix||(this._matrix=[]);for(var i=0;i<e;i++)this._matrix[i]=t[i];return this._matrix}}e.ColorFilter=a,a.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],a.GRAY_MATRIX=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0],a.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],a.LENGTH=25},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(23),s=i(3),a=i(39),n=i(7),o=i(30),l=i(18),h=i(0),u=i(47);class c extends a.BaseTexture{constructor(t,e,i=u.RenderTextureFormat.R8G8B8,r=u.RenderTextureDepthFormat.DEPTH_16){super(i,!1),this._mgrKey=0,this._glTextureType=s.LayaGL.instance.TEXTURE_2D,this._width=t,this._height=e,this._depthStencilFormat=r,this._create(t,e),this.lock=!0}static get currentActive(){return c._currentActive}get depthStencilFormat(){return this._depthStencilFormat}get defaulteTexture(){return r.Texture2D.grayTexture}getIsReady(){return!0}get sourceWidth(){return this._width}get sourceHeight(){return this._height}get offsetX(){return 0}get offsetY(){return 0}_create(t,e){var i=s.LayaGL.instance;this._frameBuffer=i.createFramebuffer(),n.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture);var r=this._getGLFormat();if(i.texImage2D(this._glTextureType,0,r,t,e,0,r,i.UNSIGNED_BYTE,null),this._setGPUMemory(t*e*4),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this._glTexture,0),this._depthStencilFormat!==u.RenderTextureDepthFormat.DEPTHSTENCIL_NONE)switch(this._depthStencilBuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this._depthStencilBuffer),this._depthStencilFormat){case u.RenderTextureDepthFormat.DEPTH_16:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case u.RenderTextureDepthFormat.STENCIL_8:i.renderbufferStorage(i.RENDERBUFFER,i.STENCIL_INDEX8,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case u.RenderTextureDepthFormat.DEPTHSTENCIL_16_8:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer)}i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindRenderbuffer(i.RENDERBUFFER,null),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel),this._readyed=!0,this._activeResource()}generateMipmap(){this._isPot(this.width)&&this._isPot(this.height)?(this._mipmap=!0,s.LayaGL.instance.generateMipmap(this._glTextureType),this._setFilterMode(this._filterMode),this._setGPUMemory(this.width*this.height*4*(1+1/3))):(this._mipmap=!1,this._setGPUMemory(this.width*this.height*4))}static pushRT(){c.rtStack.push({rt:c._currentActive,w:l.RenderState2D.width,h:l.RenderState2D.height})}static popRT(){var t=s.LayaGL.instance,e=c.rtStack.pop();e&&(c._currentActive!=e.rt&&(s.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,e.rt?e.rt._frameBuffer:null),c._currentActive=e.rt),t.viewport(0,0,e.w,e.h),l.RenderState2D.width=e.w,l.RenderState2D.height=e.h)}start(){var t=s.LayaGL.instance;s.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),this._lastRT=c._currentActive,c._currentActive=this,this._readyed=!0,t.viewport(0,0,this._width,this._height),this._lastWidth=l.RenderState2D.width,this._lastHeight=l.RenderState2D.height,l.RenderState2D.width=this._width,l.RenderState2D.height=this._height,o.BaseShader.activeShader=null}end(){var t=s.LayaGL.instance;t.bindFramebuffer(t.FRAMEBUFFER,null),c._currentActive=null,this._readyed=!0}restore(){var t=s.LayaGL.instance;this._lastRT!=c._currentActive&&(s.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,this._lastRT?this._lastRT._frameBuffer:null),c._currentActive=this._lastRT),this._readyed=!0,t.viewport(0,0,this._lastWidth,this._lastHeight),l.RenderState2D.width=this._lastWidth,l.RenderState2D.height=this._lastHeight,o.BaseShader.activeShader=null}clear(t=0,e=0,i=0,r=1){var a=s.LayaGL.instance;a.clearColor(t,e,i,r);var n=a.COLOR_BUFFER_BIT;switch(this._depthStencilFormat){case a.DEPTH_COMPONENT16:n|=a.DEPTH_BUFFER_BIT;break;case a.STENCIL_INDEX8:n|=a.STENCIL_BUFFER_BIT;break;case a.DEPTH_STENCIL:n|=a.DEPTH_BUFFER_BIT,n|=a.STENCIL_BUFFER_BIT}a.clear(n)}getData(t,e,i,r){if(h.ILaya.Render.isConchApp&&2==window.conchConfig.threadMode)throw"native 2 thread mode use getDataAsync";var a=s.LayaGL.instance;if(a.bindFramebuffer(a.FRAMEBUFFER,this._frameBuffer),!(a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE))return a.bindFramebuffer(a.FRAMEBUFFER,null),null;var n=new Uint8Array(this._width*this._height*4),o=this._getGLFormat();return a.readPixels(t,e,i,r,o,a.UNSIGNED_BYTE,n),a.bindFramebuffer(a.FRAMEBUFFER,null),n}getDataAsync(t,e,i,r,a){var n=s.LayaGL.instance;n.bindFramebuffer(n.FRAMEBUFFER,this._frameBuffer),n.readPixelsAsync(t,e,i,r,n.RGBA,n.UNSIGNED_BYTE,(function(t){a(new Uint8Array(t))})),n.bindFramebuffer(n.FRAMEBUFFER,null)}recycle(){}_disposeResource(){if(this._frameBuffer){var t=s.LayaGL.instance;t.deleteTexture(this._glTexture),t.deleteFramebuffer(this._frameBuffer),t.deleteRenderbuffer(this._depthStencilBuffer),this._glTexture=null,this._frameBuffer=null,this._depthStencilBuffer=null,this._setGPUMemory(0)}}}e.RenderTexture2D=c,c.rtStack=[],c.defuv=[0,0,1,0,1,1,0,1],c.flipyuv=[0,1,1,1,1,0,0,0]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3),s=i(7),a=i(45),n=i(46);class o extends a.Bitmap{constructor(t,e){super(),this._wrapModeU=o.WARPMODE_REPEAT,this._wrapModeV=o.WARPMODE_REPEAT,this._filterMode=o.FILTERMODE_BILINEAR,this._readyed=!1,this._width=-1,this._height=-1,this._format=t,this._mipmap=e,this._anisoLevel=1,this._glTexture=r.LayaGL.instance.createTexture()}get mipmap(){return this._mipmap}get format(){return this._format}get wrapModeU(){return this._wrapModeU}set wrapModeU(t){this._wrapModeU!==t&&(this._wrapModeU=t,-1!==this._width&&this._setWarpMode(r.LayaGL.instance.TEXTURE_WRAP_S,t))}get wrapModeV(){return this._wrapModeV}set wrapModeV(t){this._wrapModeV!==t&&(this._wrapModeV=t,-1!==this._height&&this._setWarpMode(r.LayaGL.instance.TEXTURE_WRAP_T,t))}get filterMode(){return this._filterMode}set filterMode(t){t!==this._filterMode&&(this._filterMode=t,-1!==this._width&&-1!==this._height&&this._setFilterMode(t))}get anisoLevel(){return this._anisoLevel}set anisoLevel(t){t!==this._anisoLevel&&(this._anisoLevel=Math.max(1,Math.min(16,t)),-1!==this._width&&-1!==this._height&&this._setAnisotropy(t))}get mipmapCount(){return this._mipmapCount}get defaulteTexture(){throw"BaseTexture:must override it."}_getFormatByteCount(){switch(this._format){case n.TextureFormat.R8G8B8:return 3;case n.TextureFormat.R8G8B8A8:return 4;case n.TextureFormat.Alpha8:return 1;case n.TextureFormat.R32G32B32A32:return 4;default:throw"Texture2D: unknown format."}}_isPot(t){return 0==(t&t-1)}_getGLFormat(){var t,e=r.LayaGL.instance,i=r.LayaGL.layaGPUInstance;switch(this._format){case n.TextureFormat.R8G8B8:t=e.RGB;break;case n.TextureFormat.R8G8B8A8:t=e.RGBA;break;case n.TextureFormat.Alpha8:t=e.ALPHA;break;case n.TextureFormat.R32G32B32A32:t=e.RGBA;break;case n.TextureFormat.DXT1:if(!i._compressedTextureS3tc)throw"BaseTexture: not support DXT1 format.";t=i._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case n.TextureFormat.DXT5:if(!i._compressedTextureS3tc)throw"BaseTexture: not support DXT5 format.";t=i._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case n.TextureFormat.ETC1RGB:if(!i._compressedTextureEtc1)throw"BaseTexture: not support ETC1RGB format.";t=i._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;break;case n.TextureFormat.PVRTCRGB_2BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_2BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case n.TextureFormat.PVRTCRGBA_2BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;break;case n.TextureFormat.PVRTCRGB_4BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_4BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case n.TextureFormat.PVRTCRGBA_4BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;default:throw"BaseTexture: unknown texture format."}return t}_setFilterMode(t){var e=r.LayaGL.instance;switch(s.WebGLContext.bindTexture(e,this._glTextureType,this._glTexture),t){case o.FILTERMODE_POINT:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.NEAREST);break;case o.FILTERMODE_BILINEAR:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;case o.FILTERMODE_TRILINEAR:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;default:throw new Error("BaseTexture:unknown filterMode value.")}}_setWarpMode(t,e){var i=r.LayaGL.instance;if(s.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture),this._isPot(this._width)&&this._isPot(this._height))switch(e){case o.WARPMODE_REPEAT:i.texParameteri(this._glTextureType,t,i.REPEAT);break;case o.WARPMODE_CLAMP:i.texParameteri(this._glTextureType,t,i.CLAMP_TO_EDGE)}else i.texParameteri(this._glTextureType,t,i.CLAMP_TO_EDGE)}_setAnisotropy(t){var e=r.LayaGL.layaGPUInstance._extTextureFilterAnisotropic;if(e){t=Math.max(t,1);var i=r.LayaGL.instance;s.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture),t=Math.min(i.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT),t),i.texParameterf(this._glTextureType,e.TEXTURE_MAX_ANISOTROPY_EXT,t)}}_disposeResource(){this._glTexture&&(r.LayaGL.instance.deleteTexture(this._glTexture),this._glTexture=null,this._setGPUMemory(0))}_getSource(){return this._readyed?this._glTexture:null}generateMipmap(){this._isPot(this.width)&&this._isPot(this.height)&&r.LayaGL.instance.generateMipmap(this._glTextureType)}}e.BaseTexture=o,o.WARPMODE_REPEAT=0,o.WARPMODE_CLAMP=1,o.FILTERMODE_POINT=0,o.FILTERMODE_BILINEAR=1,o.FILTERMODE_TRILINEAR=2,o.FORMAT_R8G8B8=0,o.FORMAT_R8G8B8A8=1,o.FORMAT_ALPHA8=2,o.FORMAT_DXT1=3,o.FORMAT_DXT5=4,o.FORMAT_ETC1RGB=5,o.FORMAT_PVRTCRGB_2BPPV=9,o.FORMAT_PVRTCRGBA_2BPPV=10,o.FORMAT_PVRTCRGB_4BPPV=11,o.FORMAT_PVRTCRGBA_4BPPV=12,o.RENDERTEXTURE_FORMAT_RGBA_HALF_FLOAT=14,o.FORMAT_R32G32B32A32=15,o.FORMAT_DEPTH_16=0,o.FORMAT_STENCIL_8=1,o.FORMAT_DEPTHSTENCIL_16_8=2,o.FORMAT_DEPTHSTENCIL_NONE=3},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SubmitKey=class{constructor(){this.clear()}clear(){this.submitType=-1,this.blendShader=this.other=0}copyFrom(t){this.other=t.other,this.blendShader=t.blendShader,this.submitType=t.submitType}copyFrom2(t,e,i){this.other=i,this.submitType=e}equal3_2(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader}equal4_2(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader}equal_3(t){return this.submitType===t.submitType&&this.blendShader===t.blendShader}equal(t){return this.other===t.other&&this.submitType===t.submitType&&this.blendShader===t.blendShader}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3),s=i(123),a=i(32),n=i(84),o=i(85);class l{constructor(t,e,i){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._quadNum=0,this.canReuse=!1,this._stride=t,this._vb=new o.VertexBuffer2D(t,r.LayaGL.instance.DYNAMIC_DRAW),e?this._vb._resizeBuffer(e,!1):a.Config.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(65536*t,!1),this._ib=new n.IndexBuffer2D,i&&this._ib._resizeBuffer(i,!1)}cloneWithNewVB(){var t=new l(this._stride,0,0);return t._ib=this._ib,t._quadNum=this._quadNum,t._attribInfo=this._attribInfo,t}cloneWithNewVBIB(){var t=new l(this._stride,0,0);return t._attribInfo=this._attribInfo,t}getVBW(){return this._vb.setNeedUpload(),this._vb}getVBR(){return this._vb}getIBR(){return this._ib}getIBW(){return this._ib.setNeedUpload(),this._ib}createQuadIB(t){this._quadNum=t,this._ib._resizeBuffer(6*t*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var e=this._ib.getUint16Array(),i=0,r=0,s=0;s<t;s++)e[i++]=r,e[i++]=r+2,e[i++]=r+1,e[i++]=r,e[i++]=r+3,e[i++]=r+2,r+=4;this._ib.setNeedUpload()}setAttributes(t){if(this._attribInfo=t,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"}configVAO(t){if(!this._applied){this._applied=!0,this._vao||(this._vao=new s.BufferState2D),this._vao.bind(),this._vb._bindForVAO(),this._ib.setNeedUpload(),this._ib._bind_uploadForVAO();for(var e=this._attribInfo.length/3,i=0,r=0;r<e;r++){var a=this._attribInfo[i+1],n=this._attribInfo[i],o=this._attribInfo[i+2];t.enableVertexAttribArray(r),t.vertexAttribPointer(r,a,n,!1,this._stride,o),i+=3}this._vao.unBind()}}useMesh(t){this._applied||this.configVAO(t),this._vao.bind(),this._vb.bind(),this._ib._bind_upload()||this._ib.bind(),this._vb._bind_upload()||this._vb.bind()}getEleNum(){return this._ib.getBuffer().byteLength/2}releaseMesh(){}destroy(){}clearVB(){this._vb.clear()}}e.Mesh2D=l,l._gvaoid=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(45),s=i(17),a=i(23),n=i(0),o=i(8);class l extends r.Bitmap{constructor(t=!1){super(),this._source=t?o.Browser.createElement("canvas"):this,this.lock=!0}get source(){return this._source}_getSource(){return this._source}clear(){this._ctx&&this._ctx.clear&&this._ctx.clear(),this._texture&&(this._texture.destroy(),this._texture=null)}destroy(){super.destroy(),this._setCPUMemory(0),this._ctx&&this._ctx.destroy&&this._ctx.destroy(),this._ctx=null}release(){}get context(){return this._ctx?this._ctx:(this._source==this?this._ctx=new n.ILaya.Context:this._ctx=this._source.getContext(n.ILaya.Render.isConchApp?"layagl":"2d"),this._ctx._canvas=this,this._ctx)}_setContext(t){this._ctx=t}getContext(t,e=null){return this.context}getMemSize(){return 0}size(t,e){(this._width!=t||this._height!=e||this._source&&(this._source.width!=t||this._source.height!=e))&&(this._width=t,this._height=e,this._setCPUMemory(t*e*4),this._ctx&&this._ctx.size&&this._ctx.size(t,e),this._source&&(this._source.height=e,this._source.width=t),this._texture&&(this._texture.destroy(),this._texture=null))}getTexture(){if(!this._texture){var t=new a.Texture2D;t.loadImageSource(this.source),this._texture=new s.Texture(t)}return this._texture}toBase64(t,e){if(this._source){if(n.ILaya.Render.isConchApp){var i=window;if(2==i.conchConfig.threadMode)throw"native 2 thread mode use toBase64Async";var r=this._ctx._targets.sourceWidth,s=this._ctx._targets.sourceHeight,a=this._ctx._targets.getData(0,0,r,s);return i.conchToBase64FlipY?i.conchToBase64FlipY(t,e,a.buffer,r,s):i.conchToBase64(t,e,a.buffer,r,s)}return this._source.toDataURL(t,e)}return null}toBase64Async(t,e,i){var r=this._ctx._targets.sourceWidth,s=this._ctx._targets.sourceHeight;this._ctx._targets.getDataAsync(0,0,r,s,(function(a){let n=window;var o=n.conchToBase64FlipY?n.conchToBase64FlipY(t,e,a.buffer,r,s):n.conchToBase64(t,e,a.buffer,r,s);i(o)}))}}e.HTMLCanvas=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(61),s=i(27),a=i(62),n=i(145),o=i(94),l=i(63),h=i(64),u=i(65),c=i(66),_=i(67),d=i(68),f=i(69),p=i(70),m=i(71),g=i(72),v=i(146),y=i(93),x=i(147),T=i(74),b=i(75),E=i(76),C=i(148),S=i(77),R=i(78),w=i(79),M=i(2),L=i(5),I=i(25),A=i(17),P=i(6),D=i(95),B=i(0);e.Graphics=class{constructor(){this._sp=null,this._one=null,this._render=this._renderEmpty,this._cmds=null,this._vectorgraphArray=null,this._graphicBounds=null,this.autoDestroy=!1,this._createData()}_createData(){}_clearData(){}_destroyData(){}destroy(){this.clear(!0),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0,this._sp._setRenderType(0),this._sp=null),this._destroyData()}clear(t=!0){if(t){var e=this._one;if(this._cmds){var i,r=this._cmds.length;for(i=0;i<r;i++)(e=this._cmds[i]).recover();this._cmds.length=0}else e&&e.recover()}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._clearData(),this._sp&&(this._sp._renderType&=~s.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._repaint(),this._vectorgraphArray){for(i=0,r=this._vectorgraphArray.length;i<r;i++)D.VectorGraphManager.getInstance().deleteShape(this._vectorgraphArray[i]);this._vectorgraphArray.length=0}}_clearBoundsCache(){this._graphicBounds&&this._graphicBounds.reset()}_initGraphicBounds(){this._graphicBounds||(this._graphicBounds=r.GraphicsBounds.create(),this._graphicBounds._graphics=this)}_repaint(){this._clearBoundsCache(),this._sp&&this._sp.repaint()}_isOnlyOne(){return!this._cmds||0===this._cmds.length}get cmds(){return this._cmds}set cmds(t){this._sp&&(this._sp._renderType|=s.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._cmds=t,this._render=this._renderAll,this._repaint()}getBounds(t=!1){return this._initGraphicBounds(),this._graphicBounds.getBounds(t)}getBoundPoints(t=!1){return this._initGraphicBounds(),this._graphicBounds.getBoundPoints(t)}drawImage(t,e=0,i=0,r=0,a=0){if(!t)return null;if(r||(r=t.sourceWidth),a||(a=t.sourceHeight),t.getIsReady()){var n=r/t.sourceWidth,o=a/t.sourceHeight;if(r=t.width*n,a=t.height*o,r<=0||a<=0)return null;e+=t.offsetX*n,i+=t.offsetY*o}this._sp&&(this._sp._renderType|=s.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType));var l=u.DrawImageCmd.create.call(this,t,e,i,r,a);return null==this._one?(this._one=l,this._render=this._renderOneImg):this._saveToCmd(null,l),this._repaint(),l}drawTexture(t,e=0,i=0,r=0,a=0,n=null,o=1,l=null,h=null,u){if(!t||o<.01)return null;if(!t.getIsReady())return null;if(r||(r=t.sourceWidth),a||(a=t.sourceHeight),t.getIsReady()){var c=r/t.sourceWidth,_=a/t.sourceHeight;if(r=t.width*c,a=t.height*_,r<=0||a<=0)return null;e+=t.offsetX*c,i+=t.offsetY*_}this._sp&&(this._sp._renderType|=s.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType));var d=g.DrawTextureCmd.create.call(this,t,e,i,r,a,n,o,l,h,u);return this._repaint(),this._saveToCmd(null,d)}drawTextures(t,e){return t?this._saveToCmd(I.Render._context.drawTextures,v.DrawTexturesCmd.create.call(this,t,e)):null}drawTriangles(t,e,i,r,s,a,n=null,o=1,l=null,h=null,u){return this._saveToCmd(I.Render._context.drawTriangles,y.DrawTrianglesCmd.create.call(this,t,e,i,r,s,a,n,o,l,h,u))}fillTexture(t,e,i,r=0,s=0,a="repeat",n=null){return t&&t.getIsReady()?this._saveToCmd(I.Render._context._fillTexture,T.FillTextureCmd.create.call(this,t,e,i,r,s,a,n||L.Point.EMPTY,{})):null}_saveToCmd(t,e){return this._sp&&(this._sp._renderType|=s.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),null==this._one?(this._one=e,this._render=this._renderOne):(this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(e)),this._repaint(),e}clipRect(t,e,i,r){return this._saveToCmd(I.Render._context.clipRect,n.ClipRectCmd.create.call(this,t,e,i,r))}fillText(t,e,i,r,s,a){return this._saveToCmd(I.Render._context.fillText,x.FillTextCmd.create.call(this,t,null,e,i,r||B.ILaya.Text.defaultFontStr(),s,a,0,""))}fillBorderText(t,e,i,r,s,a,n,o){return this._saveToCmd(I.Render._context.fillText,x.FillTextCmd.create.call(this,t,null,e,i,r||B.ILaya.Text.defaultFontStr(),s,o,n,a))}fillWords(t,e,i,r,s){return this._saveToCmd(I.Render._context.fillText,x.FillTextCmd.create.call(this,null,t,e,i,r||B.ILaya.Text.defaultFontStr(),s))}fillBorderWords(t,e,i,r,s,a,n){return this._saveToCmd(I.Render._context.fillText,x.FillTextCmd.create.call(this,null,t,e,i,r||B.ILaya.Text.defaultFontStr(),s,"",n,a))}strokeText(t,e,i,r,s,a,n){return this._saveToCmd(I.Render._context.fillText,x.FillTextCmd.create.call(this,t,null,e,i,r||B.ILaya.Text.defaultFontStr(),null,n,a,s))}alpha(t){return this._saveToCmd(I.Render._context.alpha,a.AlphaCmd.create.call(this,t))}transform(t,e=0,i=0){return this._saveToCmd(I.Render._context._transform,R.TransformCmd.create.call(this,t,e,i))}rotate(t,e=0,i=0){return this._saveToCmd(I.Render._context._rotate,E.RotateCmd.create.call(this,t,e,i))}scale(t,e,i=0,r=0){return this._saveToCmd(I.Render._context._scale,S.ScaleCmd.create.call(this,t,e,i,r))}translate(t,e){return this._saveToCmd(I.Render._context.translate,w.TranslateCmd.create.call(this,t,e))}save(){return this._saveToCmd(I.Render._context._save,C.SaveCmd.create.call(this))}restore(){return this._saveToCmd(I.Render._context.restore,b.RestoreCmd.create.call(this))}replaceText(t){this._repaint();var e=this._cmds;if(e){for(var i=e.length-1;i>-1;i--)if(this._isTextCmd(e[i]))return e[i].text=t,!0}else if(this._one&&this._isTextCmd(this._one))return this._one.text=t,!0;return!1}_isTextCmd(t){return t.cmdID==x.FillTextCmd.ID}replaceTextColor(t){this._repaint();var e=this._cmds;if(e)for(var i=e.length-1;i>-1;i--)this._isTextCmd(e[i])&&this._setTextCmdColor(e[i],t);else this._one&&this._isTextCmd(this._one)&&this._setTextCmdColor(this._one,t)}_setTextCmdColor(t,e){switch(t.cmdID){case x.FillTextCmd.ID:t.color=e}}loadImage(t,e=0,i=0,r=0,s=0,a=null){var n=B.ILaya.Loader.getRes(t);n?n.getIsReady()?this.drawImage(n,e,i,r,s):n.once(M.Event.READY,this,this.drawImage,[n,e,i,r,s]):((n=new A.Texture).load(t),B.ILaya.Loader.cacheTexture(t,n),n.once(M.Event.READY,this,this.drawImage,[n,e,i,r,s])),null!=a&&(n.getIsReady()?a.call(this._sp):n.on(M.Event.READY,this._sp,a))}_renderEmpty(t,e,i,r){}_renderAll(t,e,i,r){for(var s=this._cmds,a=0,n=s.length;a<n;a++)s[a].run(e,i,r)}_renderOne(t,e,i,r){e.sprite=t,this._one.run(e,i,r)}_renderOneImg(t,e,i,r){e.sprite=t,this._one.run(e,i,r)}drawLine(t,e,i,r,s,a=1){var n=a<1||a%2==0?0:.5;return this._saveToCmd(I.Render._context._drawLine,c.DrawLineCmd.create.call(this,t+n,e+n,i+n,r+n,s,a,0))}drawLines(t,e,i,r,s=1){if(!i||i.length<4)return null;var a=s<1||s%2==0?0:.5;return this._saveToCmd(I.Render._context._drawLines,_.DrawLinesCmd.create.call(this,t+a,e+a,i,r,s,0))}drawCurves(t,e,i,r,s=1){return this._saveToCmd(I.Render._context.drawCurves,h.DrawCurvesCmd.create.call(this,t,e,i,r,s))}drawRect(t,e,i,r,s,a=null,n=1){var o=n>=1&&a?n/2:0,l=a?n:0;return this._saveToCmd(I.Render._context.drawRect,m.DrawRectCmd.create.call(this,t+o,e+o,i-l,r-l,s,a,n))}drawCircle(t,e,i,r,s=null,a=1){var n=a>=1&&s?a/2:0;return this._saveToCmd(I.Render._context._drawCircle,l.DrawCircleCmd.create.call(this,t,e,i-n,r,s,a,0))}drawPie(t,e,i,r,s,a,n=null,o=1){var l=o>=1&&n?o/2:0,h=n?o:0;return this._saveToCmd(I.Render._context._drawPie,f.DrawPieCmd.create.call(this,t+l,e+l,i-h,P.Utils.toRadian(r),P.Utils.toRadian(s),a,n,o,0))}drawPoly(t,e,i,r,s=null,a=1){var n=!1;n=!(i.length>6);var o=a>=1&&s?a%2==0?0:.5:0;return this._saveToCmd(I.Render._context._drawPoly,p.DrawPolyCmd.create.call(this,t+o,e+o,i,r,s,a,n,0))}drawPath(t,e,i,r=null,s=null){return this._saveToCmd(I.Render._context._drawPath,d.DrawPathCmd.create.call(this,t,e,i,r,s))}draw9Grid(t,e=0,i=0,r=0,s=0,a=null){this._saveToCmd(null,o.Draw9GridTexture.create(t,e,i,r,s,a))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(4),s=i(5),a=i(10),n=i(38),o=i(73),l=i(19),h=i(11),u=i(13),c=i(48);class _{constructor(){}get type(){return-1}}e.Filter=_,_.BLUR=16,_.COLOR=32,_.GLOW=8,_._filter=function(t,e,i,d){var f=e,p=this._next;if(p){var m=t.filters,g=m.length;if(1==g&&m[0].type==_.COLOR)return e.save(),e.setColorFilter(m[0]),p._fun.call(p,t,e,i,d),void e.restore();var v,y=u.Value2D.create(h.ShaderDefines2D.TEXTURE2D,0),x=s.Point.TEMP,T=f._curMat,b=r.Matrix.create();T.copyTo(b);var E=0,C=0,S=null,R=t._cacheStyle.filterCache||null;if(R&&0==t.getRepaint()){if((t._cacheStyle.hasGlowFilter||!1)&&(E=50,C=25),(v=t.getBounds()).width<=0||v.height<=0)return;v.width+=E,v.height+=E,x.x=v.x*b.a+v.y*b.c,x.y=v.y*b.d+v.x*b.b,v.x=x.x,v.y=x.y,x.x=v.width*b.a+v.height*b.c,x.y=v.height*b.d+v.width*b.b,v.width=x.x,v.height=x.y}else{t._isHaveGlowFilter()&&(E=50,C=25),(v=new a.Rectangle).copyFrom(t.getSelfBounds()),v.x+=t.x,v.y+=t.y,v.x-=t.pivotX+4,v.y-=t.pivotY+4;var w=v.x,M=v.y;if(v.width+=E+8,v.height+=E+8,x.x=v.x*b.a+v.y*b.c,x.y=v.y*b.d+v.x*b.b,v.x=x.x,v.y=x.y,x.x=v.width*b.a+v.height*b.c,x.y=v.height*b.d+v.width*b.b,v.width=x.x,v.height=x.y,v.width<=0||v.height<=0)return;R&&o.WebGLRTMgr.releaseRT(R),S=o.WebGLRTMgr.getRT(v.width,v.height);var L=R=o.WebGLRTMgr.getRT(v.width,v.height);t._getCacheStyle().filterCache=R,f.pushRT(),f.useRT(S);var I=t.x-w+C,A=t.y-M+C;p._fun.call(p,t,e,I,A),f.useRT(L);for(var P=0;P<g;P++){0!=P&&(f.useRT(S),f.drawTarget(L,0,0,v.width,v.height,r.Matrix.TEMP.identity(),y,null,l.BlendMode.TOINT.overlay),f.useRT(L));var D=m[P];switch(D.type){case _.BLUR:case _.GLOW:D._glRender&&D._glRender.render(S,e,v.width,v.height,D);break;case _.COLOR:f.setColorFilter(D),f.drawTarget(S,0,0,v.width,v.height,r.Matrix.EMPTY.identity(),u.Value2D.create(h.ShaderDefines2D.TEXTURE2D,0)),f.setColorFilter(null)}}f.popRT()}if(i=i-C-t.x,d=d-C-t.y,x.setTo(i,d),b.transformPoint(x),i=x.x+v.x,d=x.y+v.y,f._drawRenderTexture(R,i,d,v.width,v.height,r.Matrix.TEMP.identity(),1,n.RenderTexture2D.defuv),S){var B=c.SubmitCMD.create([S],(function(t){t.destroy()}),this);S=null,e.addRenderObject(B)}b.destroy()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(24);class s extends r.Resource{constructor(){super(),this._width=-1,this._height=-1}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}_getSource(){throw"Bitmap: must override it."}}e.Bitmap=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.R8G8B8=0]="R8G8B8",t[t.R8G8B8A8=1]="R8G8B8A8",t[t.Alpha8=2]="Alpha8",t[t.DXT1=3]="DXT1",t[t.DXT5=4]="DXT5",t[t.ETC1RGB=5]="ETC1RGB",t[t.PVRTCRGB_2BPPV=9]="PVRTCRGB_2BPPV",t[t.PVRTCRGBA_2BPPV=10]="PVRTCRGBA_2BPPV",t[t.PVRTCRGB_4BPPV=11]="PVRTCRGB_4BPPV",t[t.PVRTCRGBA_4BPPV=12]="PVRTCRGBA_4BPPV",t[t.R32G32B32A32=15]="R32G32B32A32"}(e.TextureFormat||(e.TextureFormat={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.R8G8B8=0]="R8G8B8",t[t.R8G8B8A8=1]="R8G8B8A8",t[t.Alpha8=2]="Alpha8",t[t.R16G16B16A16=14]="R16G16B16A16"}(e.RenderTextureFormat||(e.RenderTextureFormat={})),function(t){t[t.DEPTH_16=0]="DEPTH_16",t[t.STENCIL_8=1]="STENCIL_8",t[t.DEPTHSTENCIL_16_8=2]="DEPTHSTENCIL_16_8",t[t.DEPTHSTENCIL_NONE=3]="DEPTHSTENCIL_NONE"}(e.RenderTextureDepthFormat||(e.RenderTextureDepthFormat={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(40);class s{constructor(){this._ref=1,this._key=new r.SubmitKey}renderSubmit(){return this.fun.apply(this._this,this.args),1}getRenderType(){return 0}releaseRender(){if(--this._ref<1){var t=s.POOL;t[t._length++]=this}}static create(t,e,i){var r=s.POOL._length?s.POOL[--s.POOL._length]:new s;return r.fun=e,r.args=t,r._this=i,r._ref=1,r._key.clear(),r}}e.SubmitCMD=s,s.POOL=[],s.POOL._length=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(41);class s extends r.Mesh2D{constructor(){super(s.const_stride,4,4),this.canReuse=!0,this.setAttributes(s._fixattriInfo),s._fixib?(this._ib=s._fixib,this._quadNum=s._maxIB):(this.createQuadIB(s._maxIB),s._fixib=this._ib)}static __int__(){s._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}static getAMesh(t){var e=null;return e=s._POOL.length?s._POOL.pop():new s,t&&e._vb._resizeBuffer(65536*s.const_stride,!1),e}releaseMesh(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,s._POOL.push(this)}destroy(){this._vb.destroy(),this._vb.deleteBuffer()}addQuad(t,e,i,r){var a=this._vb,n=a._byteLength>>2;a.setByteLength(n+s.const_stride<<2);var o=a._floatArray32||a.getFloat32Array(),l=a._uint32Array,h=n,u=r?255:0;o[h++]=t[0],o[h++]=t[1],o[h++]=e[0],o[h++]=e[1],l[h++]=i,l[h++]=u,o[h++]=t[2],o[h++]=t[3],o[h++]=e[2],o[h++]=e[3],l[h++]=i,l[h++]=u,o[h++]=t[4],o[h++]=t[5],o[h++]=e[4],o[h++]=e[5],l[h++]=i,l[h++]=u,o[h++]=t[6],o[h++]=t[7],o[h++]=e[6],o[h++]=e[7],l[h++]=i,l[h++]=u,a._upload=!0}}e.MeshQuadTexture=s,s.const_stride=24,s._maxIB=16384,s._POOL=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3);e.Buffer=class{constructor(){this._byteLength=0,this._glBuffer=r.LayaGL.instance.createBuffer()}get bufferUsage(){return this._bufferUsage}_bindForVAO(){}bind(){return!1}destroy(){this._glBuffer&&(r.LayaGL.instance.deleteBuffer(this._glBuffer),this._glBuffer=null)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3),s=i(26),a=i(30),n=i(50);class o extends n.Buffer{constructor(){super(),this._maxsize=0,this._upload=!0,this._uploadSize=0,this._bufferSize=0,this._u8Array=null}static __int__(t){}get bufferLength(){return this._buffer.byteLength}set byteLength(t){this.setByteLength(t)}setByteLength(t){this._byteLength!==t&&(t<=this._bufferSize||this._resizeBuffer(2*t+256,!0),this._byteLength=t)}needSize(t){var e=this._byteLength;if(t){var i=this._byteLength+t;i<=this._bufferSize||this._resizeBuffer(i<<1,!0),this._byteLength=i}return e}_bufferData(){this._maxsize=Math.max(this._maxsize,this._byteLength),s.RenderInfo.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,r.LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),r.LayaGL.instance.bufferSubData(this._bufferType,0,new Uint8Array(this._buffer,0,this._byteLength))}_bufferSubData(t=0,e=0,i=0){if(this._maxsize=Math.max(this._maxsize,this._byteLength),s.RenderInfo.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,r.LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),e||i){var a=this._buffer.slice(e,i);r.LayaGL.instance.bufferSubData(this._bufferType,t,a)}else r.LayaGL.instance.bufferSubData(this._bufferType,t,this._buffer)}_checkArrayUse(){}_bind_uploadForVAO(){return!!this._upload&&(this._upload=!1,this._bindForVAO(),this._bufferData(),!0)}_bind_upload(){return!!this._upload&&(this._upload=!1,this.bind(),this._bufferData(),!0)}_bind_subUpload(t=0,e=0,i=0){return!!this._upload&&(this._upload=!1,this.bind(),this._bufferSubData(t,e,i),!0)}_resizeBuffer(t,e){var i=this._buffer;if(t<=i.byteLength)return this;var r=this._u8Array;if(e&&i&&i.byteLength>0){var s=new ArrayBuffer(t),a=r&&r.buffer==i?r:new Uint8Array(i);(r=this._u8Array=new Uint8Array(s)).set(a,0),i=this._buffer=s}else i=this._buffer=new ArrayBuffer(t),this._u8Array=null;return this._checkArrayUse(),this._upload=!0,this._bufferSize=i.byteLength,this}append(t){var e,i;this._upload=!0,e=t.byteLength,t instanceof Uint8Array?(this._resizeBuffer(this._byteLength+e,!0),i=new Uint8Array(this._buffer,this._byteLength)):t instanceof Uint16Array?(this._resizeBuffer(this._byteLength+e,!0),i=new Uint16Array(this._buffer,this._byteLength)):t instanceof Float32Array&&(this._resizeBuffer(this._byteLength+e,!0),i=new Float32Array(this._buffer,this._byteLength)),i.set(t,0),this._byteLength+=e,this._checkArrayUse()}appendU16Array(t,e){this._resizeBuffer(this._byteLength+2*e,!0);var i=new Uint16Array(this._buffer,this._byteLength,e);if(6==e)i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5];else if(e>=100)i.set(new Uint16Array(t.buffer,0,e));else for(var r=0;r<e;r++)i[r]=t[r];this._byteLength+=2*e,this._checkArrayUse()}appendEx(t,e){var i;this._upload=!0,i=t.byteLength,this._resizeBuffer(this._byteLength+i,!0),new e(this._buffer,this._byteLength).set(t,0),this._byteLength+=i,this._checkArrayUse()}appendEx2(t,e,i,r=1){var s,a,n;for(this._upload=!0,s=i*r,this._resizeBuffer(this._byteLength+s,!0),a=new e(this._buffer,this._byteLength),n=0;n<i;n++)a[n]=t[n];this._byteLength+=s,this._checkArrayUse()}getBuffer(){return this._buffer}setNeedUpload(){this._upload=!0}getNeedUpload(){return this._upload}upload(){var t=r.LayaGL.instance,e=this._bind_upload();return t.bindBuffer(this._bufferType,null),this._bufferType==t.ARRAY_BUFFER&&(n.Buffer._bindedVertexBuffer=null),this._bufferType==t.ELEMENT_ARRAY_BUFFER&&(n.Buffer._bindedIndexBuffer=null),a.BaseShader.activeShader=null,e}subUpload(t=0,e=0,i=0){var s=r.LayaGL.instance,o=this._bind_subUpload();return s.bindBuffer(this._bufferType,null),this._bufferType==s.ARRAY_BUFFER&&(n.Buffer._bindedVertexBuffer=null),this._bufferType==s.ELEMENT_ARRAY_BUFFER&&(n.Buffer._bindedIndexBuffer=null),a.BaseShader.activeShader=null,o}_disposeResource(){this._upload=!0,this._uploadSize=0}clear(){this._byteLength=0,this._upload=!0}}e.Buffer2D=o,o.FLOAT32=4,o.SHORT=2},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3),s=i(41);class a extends s.Mesh2D{constructor(){super(a.const_stride,4,4),this.canReuse=!0,this.setAttributes(a._fixattriInfo)}static __init__(){r.LayaGL.instance;a._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}static getAMesh(t){var e;return e=a._POOL.length?a._POOL.pop():new a,t&&e._vb._resizeBuffer(65536*a.const_stride,!1),e}addData(t,e,i,r,s){var n=this._vb,o=this._ib,l=t.length>>1,h=n.needSize(l*a.const_stride)>>2,u=n._floatArray32||n.getFloat32Array(),c=n._uint32Array,_=0,d=r.a,f=r.b,p=r.c,m=r.d,g=r.tx,v=r.ty,y=0;for(y=0;y<l;y++){var x=t[_],T=t[_+1];u[h]=x*d+T*p+g,u[h+1]=x*f+T*m+v,u[h+2]=e[_],u[h+3]=e[_+1],c[h+4]=s,c[h+5]=255,h+=6,_+=2}n.setNeedUpload();var b=this.vertNum,E=i.length,C=o.needSize(i.byteLength),S=o.getUint16Array(),R=C>>1;if(b>0){var w=R+E,M=0;for(y=R;y<w;y++,M++)S[y]=i[M]+b}else S.set(i,R);o.setNeedUpload(),this.vertNum+=l,this.indexNum+=i.length}releaseMesh(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,a._POOL.push(this)}destroy(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}e.MeshTexture=a,a.const_stride=24,a._POOL=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3),s=i(41);class a extends s.Mesh2D{constructor(){super(a.const_stride,4,4),this.canReuse=!0,this.setAttributes(a._fixattriInfo)}static __init__(){r.LayaGL.instance;a._fixattriInfo=[5126,2,0,5121,4,8]}static getAMesh(t){var e;return e=a._POOL.length?a._POOL.pop():new a,t&&e._vb._resizeBuffer(65536*a.const_stride,!1),e}addVertAndIBToMesh(t,e,i,r){for(var s=this._vb.needSize(e.length/2*a.const_stride)>>2,n=this._vb._floatArray32||this._vb.getFloat32Array(),o=this._vb._uint32Array,l=0,h=e.length/2,u=0;u<h;u++)n[s++]=e[l],n[s++]=e[l+1],l+=2,o[s++]=i;this._vb.setNeedUpload(),this._ib.append(new Uint16Array(r)),this._ib.setNeedUpload(),this.vertNum+=h,this.indexNum+=r.length}releaseMesh(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,a._POOL.push(this)}destroy(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}e.MeshVG=a,a.const_stride=12,a._POOL=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.WordText=class{constructor(){this.save=[],this.toUpperCase=null,this.width=-1,this.pageChars=[],this.startID=0,this.startIDStroke=0,this.lastGCCnt=0,this.splitRender=!1}setText(t){this.changed=!0,this._text=t,this.width=-1,this.cleanCache()}toString(){return this._text}get length(){return this._text?this._text.length:0}charCodeAt(t){return this._text?this._text.charCodeAt(t):NaN}charAt(t){return this._text?this._text.charAt(t):null}cleanCache(){this.pageChars.forEach((function(t){var e=t.tex;t.words;1==t.words.length&&e&&e.ri&&e.destroy()})),this.pageChars=[],this.startID=0}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(18),s=i(7);class a{static _uint8ArraySlice(){for(var t=this.length,e=new Uint8Array(this.length),i=0;i<t;i++)e[i]=this[i];return e}static _float32ArraySlice(){for(var t=this.length,e=new Float32Array(this.length),i=0;i<t;i++)e[i]=this[i];return e}static _uint16ArraySlice(...t){var e,i,r;if(0===t.length)for(e=this.length,i=new Uint16Array(e),r=0;r<e;r++)i[r]=this[r];else if(2===t.length){var s=t[0],a=t[1];if(a>s)for(e=a-s,i=new Uint16Array(e),r=s;r<a;r++)i[r-s]=this[r];else i=new Uint16Array(0)}return i}static _nativeRender_enable(){}static enable(){return!0}static inner_enable(){return Float32Array.prototype.slice||(Float32Array.prototype.slice=a._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=a._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=a._uint8ArraySlice),!0}static onStageResize(t,e){null!=s.WebGLContext.mainContext&&(s.WebGLContext.mainContext.viewport(0,0,t,e),r.RenderState2D.width=t,r.RenderState2D.height=e)}}e.WebGL=a,a._isWebGL2=!1,a.isNativeRender_enable=!1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(36),s=i(2),a=i(6),n=i(0),o=i(9);class l extends r.Text{constructor(){super(),this._multiline=!1,this._editable=!0,this._maxChars=1e5,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",l.IOS_IFRAME=n.ILaya.Browser.onIOS&&n.ILaya.Browser.window.top!=n.ILaya.Browser.window.self,this._width=100,this._height=20,this.multiline=!1,this.overflow=r.Text.SCROLL,this.on(s.Event.MOUSE_DOWN,this,this._onMouseDown),this.on(s.Event.UNDISPLAY,this,this._onUnDisplay)}static __init__(){if(l._createInputElement(),n.ILaya.Browser.onMobile){var t=!1;(n.ILaya.Browser.onMiniGame||n.ILaya.Browser.onBDMiniGame||n.ILaya.Browser.onQGMiniGame||n.ILaya.Browser.onKGMiniGame||n.ILaya.Browser.onVVMiniGame||n.ILaya.Browser.onAlipayMiniGame||n.ILaya.Browser.onQQMiniGame)&&(t=!0),n.ILaya.Render.canvas.addEventListener(l.IOS_IFRAME?t?"touchend":"click":"touchend",l._popupInputMethod)}}static _popupInputMethod(t){l.isInputting&&l.inputElement.focus()}static _createInputElement(){l._initInput(l.area=n.ILaya.Browser.createElement("textarea")),l._initInput(l.input=n.ILaya.Browser.createElement("input")),l.inputContainer=n.ILaya.Browser.createElement("div"),l.inputContainer.style.position="absolute",l.inputContainer.style.zIndex=1e5,n.ILaya.Browser.container.appendChild(l.inputContainer),l.inputContainer.setPos=function(t,e){l.inputContainer.style.left=t+"px",l.inputContainer.style.top=e+"px"}}static _initInput(t){var e=t.style;e.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",e.resize="none",e.backgroundColor="transparent",e.border="none",e.outline="none",e.zIndex=1,t.addEventListener("input",l._processInputting),t.addEventListener("mousemove",l._stopEvent),t.addEventListener("mousedown",l._stopEvent),t.addEventListener("touchmove",l._stopEvent),t.setFontFace=function(e){t.style.fontFamily=e},n.ILaya.Render.isConchApp||(t.setColor=function(e){t.style.color=e},t.setFontSize=function(e){t.style.fontSize=e+"px"})}static _processInputting(t){var e=l.inputElement.target;if(e){var i=l.inputElement.value;e._restrictPattern&&(i=i.replace(/\u2006|\x27/g,""),e._restrictPattern.test(i)&&(i=i.replace(e._restrictPattern,""),l.inputElement.value=i)),e._text=i,e.event(s.Event.INPUT)}}static _stopEvent(t){"touchmove"==t.type&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}setSelection(t,e){this.focus=!0,l.inputElement.selectionStart=t,l.inputElement.selectionEnd=e}get multiline(){return this._multiline}set multiline(t){this._multiline=t,this.valign=t?"top":"middle"}get nativeInput(){return this._multiline?l.area:l.input}_onUnDisplay(t=null){this.focus=!1}_onMouseDown(t){this.focus=!0}_syncInputTransform(){var t=this.nativeInput,e=a.Utils.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),i=this._width-this.padding[1]-this.padding[3],r=this._height-this.padding[0]-this.padding[2];n.ILaya.Render.isConchApp?(t.setScale(e.scaleX,e.scaleY),t.setSize(i,r),t.setPos(e.x,e.y)):(l.inputContainer.style.transform=l.inputContainer.style.webkitTransform="scale("+e.scaleX+","+e.scaleY+") rotate("+n.ILaya.stage.canvasDegree+"deg)",t.style.width=i+"px",t.style.height=r+"px",l.inputContainer.style.left=e.x+"px",l.inputContainer.style.top=e.y+"px")}select(){this.nativeInput.select()}get focus(){return this._focus}set focus(t){var e=this.nativeInput;this._focus!==t&&(t?(e.target?e.target._focusOut():this._setInputMethod(),e.target=this,this._focusIn()):(e.target=null,this._focusOut(),n.ILaya.Browser.document.body.scrollTop=0,e.blur(),n.ILaya.Render.isConchApp?e.setPos(-1e4,-1e4):l.inputContainer.contains(e)&&l.inputContainer.removeChild(e)))}_setInputMethod(){l.input.parentElement&&l.inputContainer.removeChild(l.input),l.area.parentElement&&l.inputContainer.removeChild(l.area),l.inputElement=this._multiline?l.area:l.input,l.inputContainer.appendChild(l.inputElement),r.Text.RightToLeft&&(l.inputElement.style.direction="rtl")}_focusIn(){l.isInputting=!0;var t=this.nativeInput;this._focus=!0;var e=t.style;e.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),t.readOnly=!this._editable,n.ILaya.Render.isConchApp&&(t.setType(this._type),t.setForbidEdit(!this._editable)),t.maxLength=this._maxChars;this.padding;if(t.value=this._content,t.placeholder=this._prompt,n.ILaya.stage.off(s.Event.KEY_DOWN,this,this._onKeyDown),n.ILaya.stage.on(s.Event.KEY_DOWN,this,this._onKeyDown),n.ILaya.stage.focus=this,this.event(s.Event.FOCUS),n.ILaya.Browser.onPC&&t.focus(),!(n.ILaya.Browser.onMiniGame||n.ILaya.Browser.onBDMiniGame||n.ILaya.Browser.onQGMiniGame||n.ILaya.Browser.onKGMiniGame||n.ILaya.Browser.onVVMiniGame||n.ILaya.Browser.onAlipayMiniGame||n.ILaya.Browser.onQQMiniGame)){this._text;this._text=null}this.typeset(),t.setColor(this._originColor),t.setFontSize(this.fontSize),t.setFontFace(n.ILaya.Browser.onIPhone&&r.Text.fontFamilyMap[this.font]||this.font),n.ILaya.Render.isConchApp&&t.setMultiAble&&t.setMultiAble(this._multiline),e.lineHeight=this.leading+this.fontSize+"px",e.fontStyle=this.italic?"italic":"normal",e.fontWeight=this.bold?"bold":"normal",e.textAlign=this.align,e.padding="0 0",this._syncInputTransform(),!n.ILaya.Render.isConchApp&&n.ILaya.Browser.onPC&&n.ILaya.systemTimer.frameLoop(1,this,this._syncInputTransform)}_setPromptColor(){l.promptStyleDOM=n.ILaya.Browser.getElementById("promptStyle"),l.promptStyleDOM||(l.promptStyleDOM=n.ILaya.Browser.createElement("style"),l.promptStyleDOM.setAttribute("id","promptStyle"),n.ILaya.Browser.document.head.appendChild(l.promptStyleDOM)),l.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"}_focusOut(){l.isInputting&&(l.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(super.set_text(this._content),super.set_color(this._originColor)):(super.set_text(this._prompt),super.set_color(this._promptColor)),n.ILaya.stage.off(s.Event.KEY_DOWN,this,this._onKeyDown),n.ILaya.stage.focus=null,this.event(s.Event.BLUR),this.event(s.Event.CHANGE),n.ILaya.Render.isConchApp&&this.nativeInput.blur(),n.ILaya.Browser.onPC&&n.ILaya.systemTimer.clear(this,this._syncInputTransform))}_onKeyDown(t){13===t.keyCode&&(n.ILaya.Browser.onMobile&&!this._multiline&&(this.focus=!1),this.event(s.Event.ENTER))}set text(t){super.set_color(this._originColor),t+="",this._focus?(this.nativeInput.value=t||"",this.event(s.Event.CHANGE)):(this._multiline||(t=t.replace(/\r?\n/g,"")),this._content=t,t?super.set_text(t):(super.set_text(this._prompt),super.set_color(this.promptColor)))}get text(){return this._focus?this.nativeInput.value:this._content||""}changeText(t){this._content=t,this._focus?(this.nativeInput.value=t||"",this.event(s.Event.CHANGE)):super.changeText(t)}set color(t){this._focus&&this.nativeInput.setColor(t),super.set_color(this._content?t:this._promptColor),this._originColor=t}get color(){return super.color}set bgColor(t){super.set_bgColor(t),n.ILaya.Render.isConchApp&&this.nativeInput.setBgColor(t)}get bgColor(){return super.bgColor}get restrict(){return this._restrictPattern?this._restrictPattern.source:""}set restrict(t){t?((t="[^"+t+"]").indexOf("^^")>-1&&(t=t.replace("^^","")),this._restrictPattern=new RegExp(t,"g")):this._restrictPattern=null}set editable(t){this._editable=t,n.ILaya.Render.isConchApp&&l.input.setForbidEdit(!t)}get editable(){return this._editable}get maxChars(){return this._maxChars}set maxChars(t){t<=0&&(t=1e5),this._maxChars=t}get prompt(){return this._prompt}set prompt(t){!this._text&&t&&super.set_color(this._promptColor),this.promptColor=this._promptColor,this._text?super.set_text(this._text==this._prompt?t:this._text):super.set_text(t),this._prompt=r.Text.langPacks&&r.Text.langPacks[t]?r.Text.langPacks[t]:t}get promptColor(){return this._promptColor}set promptColor(t){this._promptColor=t,this._content||super.set_color(t)}get type(){return this._type}set type(t){this._getTextStyle().asPassword="password"===t,this._type=t}}e.Input=l,l.TYPE_TEXT="text",l.TYPE_PASSWORD="password",l.TYPE_EMAIL="email",l.TYPE_URL="url",l.TYPE_NUMBER="number",l.TYPE_RANGE="range",l.TYPE_DATE="date",l.TYPE_MONTH="month",l.TYPE_WEEK="week",l.TYPE_TIME="time",l.TYPE_DATE_TIME="datetime",l.TYPE_DATE_TIME_LOCAL="datetime-local",l.TYPE_SEARCH="search",l.IOS_IFRAME=!1,l.inputHeight=45,l.isInputting=!1,o.ClassUtils.regClass("laya.display.Input",l),o.ClassUtils.regClass("Laya.Input",l)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(22),s=i(2),a=i(12),n=i(1),o=i(15),l=i(0),h=i(9);class u extends a.EventDispatcher{constructor(){super(),this._bits=0,this._children=u.ARRAY_EMPTY,this._extUIChild=u.ARRAY_EMPTY,this._parent=null,this.name="",this.destroyed=!1,this.createGLBuffer()}createGLBuffer(){}_setBit(t,e){t===r.Const.DISPLAY&&(this._getBit(t)!=e&&this._updateDisplayedInstage());e?this._bits|=t:this._bits&=~t}_getBit(t){return 0!=(this._bits&t)}_setUpNoticeChain(){this._getBit(r.Const.DISPLAY)&&this._setBitUp(r.Const.DISPLAY)}_setBitUp(t){var e=this;for(e._setBit(t,!0),e=e._parent;e;){if(e._getBit(t))return;e._setBit(t,!0),e=e._parent}}on(t,e,i,a=null){return t!==s.Event.DISPLAY&&t!==s.Event.UNDISPLAY||this._getBit(r.Const.DISPLAY)||this._setBitUp(r.Const.DISPLAY),this._createListener(t,e,i,a,!1)}once(t,e,i,a=null){return t!==s.Event.DISPLAY&&t!==s.Event.UNDISPLAY||this._getBit(r.Const.DISPLAY)||this._setBitUp(r.Const.DISPLAY),this._createListener(t,e,i,a,!0)}destroy(t=!0){this.destroyed=!0,this._destroyAllComponent(),this._parent&&this._parent.removeChild(this),this._children&&(t?this.destroyChildren():this.removeChildren()),this.onDestroy(),this._children=null,this.offAll()}onDestroy(){}destroyChildren(){if(this._children)for(var t=0,e=this._children.length;t<e;t++)this._children[0].destroy(!0)}addChild(t){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(r.Const.HAS_ZORDER,!0),t._parent===this){var e=this.getChildIndex(t);e!==this._children.length-1&&(this._children.splice(e,1),this._children.push(t),this._childChanged())}else t._parent&&t._parent.removeChild(t),this._children===u.ARRAY_EMPTY&&(this._children=[]),this._children.push(t),t._setParent(this),this._childChanged();return t}addInputChild(t){if(this._extUIChild==u.ARRAY_EMPTY)this._extUIChild=[t];else{if(this._extUIChild.indexOf(t)>=0)return null;this._extUIChild.push(t)}return null}removeInputChild(t){var e=this._extUIChild.indexOf(t);e>=0&&this._extUIChild.splice(e,1)}addChildren(...t){for(var e=0,i=t.length;e<i;)this.addChild(t[e++])}addChildAt(t,e){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(r.Const.HAS_ZORDER,!0),e>=0&&e<=this._children.length){if(t._parent===this){var i=this.getChildIndex(t);this._children.splice(i,1),this._children.splice(e,0,t),this._childChanged()}else t._parent&&t._parent.removeChild(t),this._children===u.ARRAY_EMPTY&&(this._children=[]),this._children.splice(e,0,t),t._setParent(this);return t}throw new Error("appendChildAt:The index is out of bounds")}getChildIndex(t){return this._children.indexOf(t)}getChildByName(t){var e=this._children;if(e)for(var i=0,r=e.length;i<r;i++){var s=e[i];if(s.name===t)return s}return null}getChildAt(t){return this._children[t]||null}setChildIndex(t,e){var i=this._children;if(e<0||e>=i.length)throw new Error("setChildIndex:The index is out of bounds.");var r=this.getChildIndex(t);if(r<0)throw new Error("setChildIndex:node is must child of this object.");return i.splice(r,1),i.splice(e,0,t),this._childChanged(),t}_childChanged(t=null){}removeChild(t){if(!this._children)return t;var e=this._children.indexOf(t);return this.removeChildAt(e)}removeSelf(){return this._parent&&this._parent.removeChild(this),this}removeChildByName(t){var e=this.getChildByName(t);return e&&this.removeChild(e),e}removeChildAt(t){var e=this.getChildAt(t);return e&&(this._children.splice(t,1),e._setParent(null)),e}removeChildren(t=0,e=2147483647){if(this._children&&this._children.length>0){var i=this._children;if(0===t&&e>=i.length-1){var r=i;this._children=u.ARRAY_EMPTY}else r=i.splice(t,e-t);for(var s=0,a=r.length;s<a;s++)r[s]._setParent(null)}return this}replaceChild(t,e){var i=this._children.indexOf(e);return i>-1?(this._children.splice(i,1,t),e._setParent(null),t._setParent(this),t):null}get numChildren(){return this._children.length}get parent(){return this._parent}_setParent(t){this._parent!==t&&(t?(this._parent=t,this._onAdded(),this.event(s.Event.ADDED),this._getBit(r.Const.DISPLAY)&&(this._setUpNoticeChain(),t.displayedInStage&&this._displayChild(this,!0)),t._childChanged(this)):(this._onRemoved(),this.event(s.Event.REMOVED),this._parent._childChanged(),this._getBit(r.Const.DISPLAY)&&this._displayChild(this,!1),this._parent=t))}get displayedInStage(){return this._getBit(r.Const.DISPLAY)?this._getBit(r.Const.DISPLAYED_INSTAGE):(this._setBitUp(r.Const.DISPLAY),this._getBit(r.Const.DISPLAYED_INSTAGE))}_updateDisplayedInstage(){var t;t=this;for(var e=l.ILaya.stage,i=!1;t;){if(t._getBit(r.Const.DISPLAY)){i=t._getBit(r.Const.DISPLAYED_INSTAGE);break}if(t===e||t._getBit(r.Const.DISPLAYED_INSTAGE)){i=!0;break}t=t._parent}this._setBit(r.Const.DISPLAYED_INSTAGE,i)}_setDisplay(t){this._getBit(r.Const.DISPLAYED_INSTAGE)!==t&&(this._setBit(r.Const.DISPLAYED_INSTAGE,t),t?this.event(s.Event.DISPLAY):this.event(s.Event.UNDISPLAY))}_displayChild(t,e){var i=t._children;if(i)for(var s=0,a=i.length;s<a;s++){var n=i[s];n._getBit(r.Const.DISPLAY)&&(n._children.length>0?this._displayChild(n,e):n._setDisplay(e))}t._setDisplay(e)}contains(t){if(t===this)return!0;for(;t;){if(t._parent===this)return!0;t=t._parent}return!1}timerLoop(t,e,i,r=null,s=!0,a=!1){(this.scene?this.scene.timer:l.ILaya.timer).loop(t,e,i,r,s,a)}timerOnce(t,e,i,r=null,s=!0){(this.scene?this.scene.timer:l.ILaya.timer)._create(!1,!1,t,e,i,r,s)}frameLoop(t,e,i,r=null,s=!0){(this.scene?this.scene.timer:l.ILaya.timer)._create(!0,!0,t,e,i,r,s)}frameOnce(t,e,i,r=null,s=!0){(this.scene?this.scene.timer:l.ILaya.timer)._create(!0,!1,t,e,i,r,s)}clearTimer(t,e){(this.scene?this.scene.timer:l.ILaya.timer).clear(t,e)}callLater(t,e=null){(this.scene?this.scene.timer:l.ILaya.timer).callLater(this,t,e)}runCallLater(t){(this.scene?this.scene.timer:l.ILaya.timer).runCallLater(this,t)}get scene(){return this._scene}get active(){return!this._getBit(r.Const.NOT_READY)&&!this._getBit(r.Const.NOT_ACTIVE)}set active(t){if(t=!!t,!this._getBit(r.Const.NOT_ACTIVE)!==t){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw t?"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.":"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._setBit(r.Const.NOT_ACTIVE,!t),this._parent&&this._parent.activeInHierarchy&&(t?this._processActive():this._processInActive())}}get activeInHierarchy(){return this._getBit(r.Const.ACTIVE_INHIERARCHY)}_onActive(){o.Stat.spriteCount++}_onInActive(){o.Stat.spriteCount--}_onActiveInScene(){}_onInActiveInScene(){}_parse(t,e){}_setBelongScene(t){if(!this._scene){this._scene=t,this._onActiveInScene();for(var e=0,i=this._children.length;e<i;e++)this._children[e]._setBelongScene(t)}}_setUnBelongScene(){if(this._scene!==this){this._onInActiveInScene(),this._scene=null;for(var t=0,e=this._children.length;t<e;t++)this._children[t]._setUnBelongScene()}}onAwake(){}onEnable(){}_processActive(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._activeHierarchy(this._activeChangeScripts),this._activeScripts()}_activeHierarchy(t){if(this._setBit(r.Const.ACTIVE_INHIERARCHY,!0),this._components)for(var e=0,i=this._components.length;e<i;e++){var s=this._components[e];s._setActive(!0),s._isScript()&&s._enabled&&t.push(s)}for(this._onActive(),e=0,i=this._children.length;e<i;e++){var a=this._children[e];!a._getBit(r.Const.NOT_ACTIVE)&&a._activeHierarchy(t)}this._getBit(r.Const.AWAKED)||(this._setBit(r.Const.AWAKED,!0),this.onAwake()),this.onEnable()}_activeScripts(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++)this._activeChangeScripts[t].onEnable();this._activeChangeScripts.length=0}_processInActive(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._inActiveHierarchy(this._activeChangeScripts),this._inActiveScripts()}_inActiveHierarchy(t){if(this._onInActive(),this._components)for(var e=0,i=this._components.length;e<i;e++){var s=this._components[e];s._setActive(!1),s._isScript()&&s._enabled&&t.push(s)}for(this._setBit(r.Const.ACTIVE_INHIERARCHY,!1),e=0,i=this._children.length;e<i;e++){var a=this._children[e];a&&!a._getBit(r.Const.NOT_ACTIVE)&&a._inActiveHierarchy(t)}this.onDisable()}_inActiveScripts(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++)this._activeChangeScripts[t].onDisable();this._activeChangeScripts.length=0}onDisable(){}_onAdded(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";var t=this._parent.scene;t&&this._setBelongScene(t),this._parent.activeInHierarchy&&this.active&&this._processActive()}_onRemoved(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._parent.activeInHierarchy&&this.active&&this._processInActive(),this._parent.scene&&this._setUnBelongScene()}_addComponentInstance(t){this._components=this._components||[],this._components.push(t),t.owner=this,t._onAdded(),this.activeInHierarchy&&t._setActive(!0)}_destroyComponent(t){if(this._components)for(var e=0,i=this._components.length;e<i;e++){var r=this._components[e];if(r===t){r._destroy(),this._components.splice(e,1);break}}}_destroyAllComponent(){if(this._components){for(var t=0,e=this._components.length;t<e;t++){this._components[t]._destroy()}this._components.length=0}}_cloneTo(t,e,i){var r=t;if(this._components)for(var s=0,a=this._components.length;s<a;s++){var n=r.addComponent(this._components[s].constructor);this._components[s]._cloneTo(n)}}addComponentIntance(t){if(t.owner)throw"Node:the component has belong to other node.";if(t.isSingleton&&this.getComponent(t.constructor))throw"Node:the component is singleton,can't add the second one.";return this._addComponentInstance(t),t}addComponent(t){var e=n.Pool.createByClass(t);if(e._destroyed=!1,e.isSingleton&&this.getComponent(t))throw"无法实例"+t+"组件，"+t+"组件已存在！";return this._addComponentInstance(e),e}getComponent(t){if(this._components)for(var e=0,i=this._components.length;e<i;e++){var r=this._components[e];if(r instanceof t)return r}return null}getComponents(t){var e;if(this._components)for(var i=0,r=this._components.length;i<r;i++){var s=this._components[i];s instanceof t&&(e=e||[]).push(s)}return e}get timer(){return this.scene?this.scene.timer:l.ILaya.timer}}e.Node=u,u.ARRAY_EMPTY=[],h.ClassUtils.regClass("laya.display.Node",u),h.ClassUtils.regClass("Laya.Node",u)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(155),a=i(56),n=i(5),o=i(10),l=i(8),h=i(0);class u{constructor(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseMoveAccuracy=2,this._event=new r.Event,this._captureSp=null,this._captureChain=[],this._captureExlusiveMode=!1,this._hitCaputreSp=!1,this._point=new n.Point,this._rect=new o.Rectangle,this._lastMoveTimer=0,this._prePoint=new n.Point,this._touchIDs={},this._curTouchID=NaN,this._id=1}__init__(t,e){this._stage=t;var i=this;e.oncontextmenu=function(t){if(u.enabled)return!1},e.addEventListener("mousedown",(function(t){u.enabled&&(l.Browser.onIE||t.cancelable&&t.preventDefault(),i.mouseDownTime=l.Browser.now(),i.runEvent(t))})),e.addEventListener("mouseup",(function(t){u.enabled&&(t.cancelable&&t.preventDefault(),i.mouseDownTime=-l.Browser.now(),i.runEvent(t))}),!0),e.addEventListener("mousemove",(function(t){if(u.enabled){t.cancelable&&t.preventDefault();var e=l.Browser.now();if(e-i._lastMoveTimer<10)return;i._lastMoveTimer=e,i.runEvent(t)}}),!0),e.addEventListener("mouseout",(function(t){u.enabled&&i.runEvent(t)})),e.addEventListener("mouseover",(function(t){u.enabled&&i.runEvent(t)})),e.addEventListener("touchstart",(function(t){u.enabled&&(u._isFirstTouch||a.Input.isInputting||t.cancelable&&t.preventDefault(),i.mouseDownTime=l.Browser.now(),i.runEvent(t))})),e.addEventListener("touchend",(function(t){u.enabled?(u._isFirstTouch||a.Input.isInputting||t.cancelable&&t.preventDefault(),u._isFirstTouch=!1,i.mouseDownTime=-l.Browser.now(),i.runEvent(t)):i._curTouchID=NaN}),!0),e.addEventListener("touchmove",(function(t){u.enabled&&(t.cancelable&&t.preventDefault(),i.runEvent(t))}),!0),e.addEventListener("touchcancel",(function(t){u.enabled?(t.cancelable&&t.preventDefault(),i.runEvent(t)):i._curTouchID=NaN}),!0),e.addEventListener("mousewheel",(function(t){u.enabled&&i.runEvent(t)})),e.addEventListener("DOMMouseScroll",(function(t){u.enabled&&i.runEvent(t)}))}initEvent(t,e=null){var i;this._event._stoped=!1,this._event.nativeEvent=e||t,this._target=null,this._point.setTo(t.pageX||t.clientX,t.pageY||t.clientY),this._stage._canvasTransform&&(this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y),this._event.touchId=t.identifier||0,this._tTouchID=this._event.touchId,(i=s.TouchManager.I._event)._stoped=!1,i.nativeEvent=this._event.nativeEvent,i.touchId=this._event.touchId}checkMouseWheel(t){this._event.delta=t.wheelDelta?.025*t.wheelDelta:-t.detail;for(var e=s.TouchManager.I.getLastOvers(),i=0,a=e.length;i<a;i++){var n=e[i];n.event(r.Event.MOUSE_WHEEL,this._event.setTo(r.Event.MOUSE_WHEEL,n,this._target))}}onMouseMove(t){s.TouchManager.I.onMouseMove(t,this._tTouchID)}onMouseDown(t){if(a.Input.isInputting&&h.ILaya.stage.focus&&h.ILaya.stage.focus.focus&&!h.ILaya.stage.focus.contains(this._target)){var e=h.ILaya.stage.focus._tf||h.ILaya.stage.focus,i=t._tf||t;i instanceof a.Input&&i.multiline==e.multiline?e._focusOut():e.focus=!1}s.TouchManager.I.onMouseDown(t,this._tTouchID,this._isLeftMouse)}onMouseUp(t){s.TouchManager.I.onMouseUp(t,this._tTouchID,this._isLeftMouse)}check(t,e,i,r){this._point.setTo(e,i),t.fromParentPoint(this._point),e=this._point.x,i=this._point.y;var s=t._style.scrollRect;if(s&&(this._rect.setTo(s.x,s.y,s.width,s.height),!this._rect.contains(e,i)))return!1;if(!this.disableMouseEvent){if(t.hitTestPrior&&!t.mouseThrough&&!this.hitTest(t,e,i))return!1;for(var a=t._children.length-1;a>-1;a--){var n=t._children[a];if(!n.destroyed&&n._mouseState>1&&n._visible&&this.check(n,e,i,r))return!0}for(a=t._extUIChild.length-1;a>=0;a--){var o=t._extUIChild[a];if(!o.destroyed&&o._mouseState>1&&o._visible&&this.check(o,e,i,r))return!0}}var l=!(!t.hitTestPrior||t.mouseThrough||this.disableMouseEvent)||this.hitTest(t,e,i);return l?(this._target=t,r.call(this,t),this._target==this._hitCaputreSp&&(this._hitCaputreSp=!0)):r===this.onMouseUp&&t===this._stage&&(this._target=this._stage,r.call(this,this._target)),l}hitTest(t,e,i){var r=!1;t.scrollRect&&(e-=t._style.scrollRect.x,i-=t._style.scrollRect.y);var s=t._style.hitArea;return s&&s._hit?s.contains(e,i):((t.width>0&&t.height>0||t.mouseThrough||s)&&(r=t.mouseThrough?t.getGraphicBounds().contains(e,i):(s||this._rect.setTo(0,0,t.width,t.height)).contains(e,i)),r)}_checkAllBaseUI(t,e,i){var r=this.handleExclusiveCapture(this.mouseX,this.mouseY,i);return!!r||(r=this.check(this._stage,this.mouseX,this.mouseY,i),this.handleCapture(this.mouseX,this.mouseY,i)||r)}check3DUI(t,e,i){for(var r=this._stage._3dUI,s=0,a=!1;s<r.length;s++){var n=r[s];this._stage._curUIBase=n,!n.destroyed&&n._mouseState>1&&n._visible&&(a=a||this.check(n,this.mouseX,this.mouseY,i))}return this._stage._curUIBase=this._stage,a}handleExclusiveCapture(t,e,i){if(this._captureExlusiveMode&&this._captureSp&&this._captureChain.length>0){var r;this._point.setTo(t,e);for(var s=0;s<this._captureChain.length;s++)(r=this._captureChain[s]).fromParentPoint(this._point);return this._target=r,i.call(this,r),!0}return!1}handleCapture(t,e,i){if(!this._hitCaputreSp&&this._captureSp&&this._captureChain.length>0){var r;this._point.setTo(t,e);for(var s=0;s<this._captureChain.length;s++)(r=this._captureChain[s]).fromParentPoint(this._point);return this._target=r,i.call(this,r),!0}return!1}runEvent(t){var e,i,a;switch("mousemove"!==t.type&&(this._prePoint.x=this._prePoint.y=-1e6),t.type){case"mousedown":this._touchIDs[0]=this._id++,u._isTouchRespond?u._isTouchRespond=!1:(this._isLeftMouse=0===t.button,this.initEvent(t),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===t.button,this.initEvent(t),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-t.clientX)+Math.abs(this._prePoint.y-t.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=t.clientX,this._prePoint.y=t.clientY,this.initEvent(t),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":u._isTouchRespond=!0,this._isLeftMouse=!0;var n=t.changedTouches;for(e=0,i=n.length;e<i;e++)a=n[e],(u.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=a.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[a.identifier]=this._id++,this.initEvent(a,t),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":u._isTouchRespond=!0,this._isLeftMouse=!0;var o=t.changedTouches;for(e=0,i=o.length;e<i;e++){if(a=o[e],u.multiTouchEnabled||a.identifier==this._curTouchID)this._curTouchID=NaN,this.initEvent(a,t),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var l=t.changedTouches;for(e=0,i=l.length;e<i;e++)a=l[e],(u.multiTouchEnabled||a.identifier==this._curTouchID)&&(this.initEvent(a,t),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(t);break;case"mouseout":s.TouchManager.I.stageMouseOut();break;case"mouseover":this._stage.event(r.Event.MOUSE_OVER,this._event.setTo(r.Event.MOUSE_OVER,this._stage,this._stage))}}setCapture(t,e=!1){this._captureSp=t,this._captureExlusiveMode=e,this._captureChain.length=0,this._captureChain.push(t);for(var i=t;i!=h.ILaya.stage&&i!=h.ILaya.stage._curUIBase&&(i=i.parent);)this._captureChain.splice(0,0,i)}releaseCapture(){console.log("release capture"),this._captureSp=null}}e.MouseManager=u,u.instance=new u,u.enabled=!0,u.multiTouchEnabled=!0,u._isFirstTouch=!0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(12);class s extends r.EventDispatcher{constructor(){super(...arguments),this.isStopped=!1}set volume(t){}get volume(){return 1}get position(){return 0}get duration(){return 0}play(){}stop(){this.completeHandler&&this.completeHandler.run()}pause(){}resume(){}__runComplete(t){t&&t.run()}}e.SoundChannel=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(6),s=i(0);class a{constructor(){this._obj={},a._maps.push(this)}static __init__(){a.I=new a,a.supportWeakMap||s.ILaya.systemTimer.loop(a.delInterval,null,a.clearCache)}static clearCache(){for(var t=0,e=a._maps.length;t<e;t++){a._maps[t]._obj={}}}set(t,e){null!=t&&(a.supportWeakMap||("string"==typeof t||"number"==typeof t?this._obj[t]=e:(t.$_GID||(t.$_GID=r.Utils.getGID()),this._obj[t.$_GID]=e)))}get(t){return null==t?null:a.supportWeakMap?void 0:"string"==typeof t||"number"==typeof t?this._obj[t]:this._obj[t.$_GID]}del(t){null!=t&&(a.supportWeakMap||("string"==typeof t||"number"==typeof t?delete this._obj[t]:delete this._obj[this._obj.$_GID]))}has(t){return null!=t&&(a.supportWeakMap?void 0:"string"==typeof t||"number"==typeof t?null!=this._obj[t]:null!=this._obj[this._obj.$_GID])}}e.WeakObject=a,a.supportWeakMap=!1,a.delInterval=6e5,a._maps=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(62),s=i(63),a=i(64),n=i(65),o=i(66),l=i(67),h=i(68),u=i(69),c=i(70),_=i(71),d=i(72),f=i(74),p=i(75),m=i(76),g=i(77),v=i(78),y=i(79),x=i(80),T=i(81),b=i(4),E=i(5),C=i(10),S=i(25),R=i(1),w=i(6),M=i(93),L=i(94);class I{constructor(){this._cacheBoundsType=!1}destroy(){this._graphics=null,this._cacheBoundsType=!1,this._temp&&(this._temp.length=0),this._rstBoundPoints&&(this._rstBoundPoints.length=0),this._bounds&&this._bounds.recover(),this._bounds=null,R.Pool.recover("GraphicsBounds",this)}static create(){return R.Pool.getItemByClass("GraphicsBounds",I)}reset(){this._temp&&(this._temp.length=0)}getBounds(t=!1){return(!this._bounds||!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._bounds=C.Rectangle._getWrapRec(this.getBoundPoints(t),this._bounds)),this._cacheBoundsType=t,this._bounds}getBoundPoints(t=!1){return(!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(t)),this._cacheBoundsType=t,this._rstBoundPoints=w.Utils.copyArray(this._rstBoundPoints,this._temp)}_getCmdPoints(t=!1){S.Render._context;var e,i=this._graphics.cmds;if((e=this._temp||(this._temp=[])).length=0,i||null==this._graphics._one||(I._tempCmds.length=0,I._tempCmds.push(this._graphics._one),i=I._tempCmds),!i)return e;var b=I._tempMatrixArrays;b.length=0;var E=I._initMatrix;E.identity();for(var R,A,P=I._tempMatrix,D=0,B=i.length;D<B;D++)switch((R=i[D]).cmdID){case r.AlphaCmd.ID:b.push(E),E=E.clone();break;case p.RestoreCmd.ID:E=b.pop();break;case g.ScaleCmd.ID:P.identity(),P.translate(-R.pivotX,-R.pivotY),P.scale(R.scaleX,R.scaleY),P.translate(R.pivotX,R.pivotY),this._switchMatrix(E,P);break;case m.RotateCmd.ID:P.identity(),P.translate(-R.pivotX,-R.pivotY),P.rotate(R.angle),P.translate(R.pivotX,R.pivotY),this._switchMatrix(E,P);break;case y.TranslateCmd.ID:P.identity(),P.translate(R.tx,R.ty),this._switchMatrix(E,P);break;case v.TransformCmd.ID:P.identity(),P.translate(-R.pivotX,-R.pivotY),P.concat(R.matrix),P.translate(R.pivotX,R.pivotY),this._switchMatrix(E,P);break;case n.DrawImageCmd.ID:case f.FillTextureCmd.ID:I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,R.width,R.height),E);break;case d.DrawTextureCmd.ID:E.copyTo(P),R.matrix&&P.concat(R.matrix),I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,R.width,R.height),P);break;case n.DrawImageCmd.ID:if(A=R.texture,t)R.width&&R.height?I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,R.width,R.height),E):I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,A.width,A.height),E);else{var O=(R.width||A.sourceWidth)/A.width,F=(R.height||A.sourceHeight)/A.height,N=O*A.sourceWidth,U=F*A.sourceHeight,k=A.offsetX>0?A.offsetX:0,G=A.offsetY>0?A.offsetY:0;k*=O,G*=F,I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x-k,R.y-G,N,U),E)}break;case f.FillTextureCmd.ID:R.width&&R.height?I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,R.width,R.height),E):(A=R.texture,I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,A.width,A.height),E));break;case d.DrawTextureCmd.ID:var W;R.matrix?(E.copyTo(P),P.concat(R.matrix),W=P):W=E,t?R.width&&R.height?I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,R.width,R.height),W):(A=R.texture,I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,A.width,A.height),W)):(A=R.texture,O=(R.width||A.sourceWidth)/A.width,F=(R.height||A.sourceHeight)/A.height,N=O*A.sourceWidth,U=F*A.sourceHeight,k=A.offsetX>0?A.offsetX:0,G=A.offsetY>0?A.offsetY:0,k*=O,G*=F,I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x-k,R.y-G,N,U),W));break;case _.DrawRectCmd.ID:I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x,R.y,R.width,R.height),E);break;case s.DrawCircleCmd.ID:I._addPointArrToRst(e,C.Rectangle._getBoundPointS(R.x-R.radius,R.y-R.radius,R.radius+R.radius,R.radius+R.radius),E);break;case o.DrawLineCmd.ID:var Y;I._tempPoints.length=0,Y=.5*R.lineWidth,R.fromX==R.toX?I._tempPoints.push(R.fromX+Y,R.fromY,R.toX+Y,R.toY,R.fromX-Y,R.fromY,R.toX-Y,R.toY):R.fromY==R.toY?I._tempPoints.push(R.fromX,R.fromY+Y,R.toX,R.toY+Y,R.fromX,R.fromY-Y,R.toX,R.toY-Y):I._tempPoints.push(R.fromX,R.fromY,R.toX,R.toY),I._addPointArrToRst(e,I._tempPoints,E);break;case a.DrawCurvesCmd.ID:I._addPointArrToRst(e,x.Bezier.I.getBezierPoints(R.points),E,R.x,R.y);break;case l.DrawLinesCmd.ID:case c.DrawPolyCmd.ID:I._addPointArrToRst(e,R.points,E,R.x,R.y);break;case h.DrawPathCmd.ID:I._addPointArrToRst(e,this._getPathPoints(R.paths),E,R.x,R.y);break;case u.DrawPieCmd.ID:I._addPointArrToRst(e,this._getPiePoints(R.x,R.y,R.radius,R.startAngle,R.endAngle),E);break;case M.DrawTrianglesCmd.ID:I._addPointArrToRst(e,this._getTriAngBBXPoints(R.vertices),E);break;case L.Draw9GridTexture.ID:I._addPointArrToRst(e,this._getDraw9GridBBXPoints(R),E)}return e.length>200?e=w.Utils.copyArray(e,C.Rectangle._getWrapRec(e)._getBoundPoints()):e.length>8&&(e=T.GrahamScan.scanPList(e)),e}_switchMatrix(t,e){e.concat(t),e.copyTo(t)}static _addPointArrToRst(t,e,i,r=0,s=0){var a,n;for(n=e.length,a=0;a<n;a+=2)I._addPointToRst(t,e[a]+r,e[a+1]+s,i)}static _addPointToRst(t,e,i,r){var s=E.Point.TEMP;s.setTo(e||0,i||0),r.transformPoint(s),t.push(s.x,s.y)}_getPiePoints(t,e,i,r,s){var a=I._tempPoints;I._tempPoints.length=0;var n=Math.PI/180,o=s-r;if(o>=360||o<=-360)return a.push(t-i,e-i),a.push(t+i,e-i),a.push(t+i,e+i),a.push(t-i,e+i),a;a.push(t,e);var l=o%360;l<0&&(l+=360);var h=r+l,u=r*n,c=h*n;a.push(t+i*Math.cos(u),e+i*Math.sin(u)),a.push(t+i*Math.cos(c),e+i*Math.sin(c));for(var _=90*Math.ceil(r/90),d=90*Math.floor(h/90),f=_;f<=d;f+=90){var p=f*n;a.push(t+i*Math.cos(p),e+i*Math.sin(p))}return a}_getTriAngBBXPoints(t){var e=t.length;if(e<2)return[];for(var i=t[0],r=t[1],s=i,a=r,n=2;n<e;){var o=t[n++],l=t[n++];i>o&&(i=o),r>l&&(r=l),s<o&&(s=o),a<l&&(a=l)}return[i,r,s,r,s,a,i,a]}_getDraw9GridBBXPoints(t){var e=t.width,i=t.height;return[0,0,e,0,e,i,0,i]}_getPathPoints(t){var e,i,r,s=I._tempPoints;for(s.length=0,i=t.length,e=0;e<i;e++)(r=t[e]).length>1&&(s.push(r[1],r[2]),r.length>3&&s.push(r[3],r[4]));return s}}e.GraphicsBounds=I,I._tempMatrix=new b.Matrix,I._initMatrix=new b.Matrix,I._tempPoints=[],I._tempMatrixArrays=[],I._tempCmds=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t){var e=r.Pool.getItemByClass("AlphaCmd",s);return e.alpha=t,e}recover(){r.Pool.recover("AlphaCmd",this)}run(t,e,i){t.alpha(this.alpha)}get cmdID(){return s.ID}}e.AlphaCmd=s,s.ID="Alpha"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n,o,l){var h=r.Pool.getItemByClass("DrawCircleCmd",s);return h.x=t,h.y=e,h.radius=i,h.fillColor=a,h.lineColor=n,h.lineWidth=o,h.vid=l,h}recover(){this.fillColor=null,this.lineColor=null,r.Pool.recover("DrawCircleCmd",this)}run(t,e,i){t._drawCircle(this.x+e,this.y+i,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid)}get cmdID(){return s.ID}}e.DrawCircleCmd=s,s.ID="DrawCircle"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n){var o=r.Pool.getItemByClass("DrawCurvesCmd",s);return o.x=t,o.y=e,o.points=i,o.lineColor=a,o.lineWidth=n,o}recover(){this.points=null,this.lineColor=null,r.Pool.recover("DrawCurvesCmd",this)}run(t,e,i){this.points&&t.drawCurves(this.x+e,this.y+i,this.points,this.lineColor,this.lineWidth)}get cmdID(){return s.ID}}e.DrawCurvesCmd=s,s.ID="DrawCurves"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n){var o=r.Pool.getItemByClass("DrawImageCmd",s);return o.texture=t,t._addReference(),o.x=e,o.y=i,o.width=a,o.height=n,o}recover(){this.texture&&this.texture._removeReference(),this.texture=null,r.Pool.recover("DrawImageCmd",this)}run(t,e,i){this.texture&&t.drawTexture(this.texture,this.x+e,this.y+i,this.width,this.height)}get cmdID(){return s.ID}}e.DrawImageCmd=s,s.ID="DrawImage"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n,o,l){var h=r.Pool.getItemByClass("DrawLineCmd",s);return h.fromX=t,h.fromY=e,h.toX=i,h.toY=a,h.lineColor=n,h.lineWidth=o,h.vid=l,h}recover(){r.Pool.recover("DrawLineCmd",this)}run(t,e,i){t._drawLine(e,i,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid)}get cmdID(){return s.ID}}e.DrawLineCmd=s,s.ID="DrawLine"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n,o){var l=r.Pool.getItemByClass("DrawLinesCmd",s);return l.x=t,l.y=e,l.points=i,l.lineColor=a,l.lineWidth=n,l.vid=o,l}recover(){this.points=null,this.lineColor=null,r.Pool.recover("DrawLinesCmd",this)}run(t,e,i){this.points&&t._drawLines(this.x+e,this.y+i,this.points,this.lineColor,this.lineWidth,this.vid)}get cmdID(){return s.ID}}e.DrawLinesCmd=s,s.ID="DrawLines"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n){var o=r.Pool.getItemByClass("DrawPathCmd",s);return o.x=t,o.y=e,o.paths=i,o.brush=a,o.pen=n,o}recover(){this.paths=null,this.brush=null,this.pen=null,r.Pool.recover("DrawPathCmd",this)}run(t,e,i){this.paths&&t._drawPath(this.x+e,this.y+i,this.paths,this.brush,this.pen)}get cmdID(){return s.ID}}e.DrawPathCmd=s,s.ID="DrawPath"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n,o,l,h,u){var c=r.Pool.getItemByClass("DrawPieCmd",s);return c.x=t,c.y=e,c.radius=i,c._startAngle=a,c._endAngle=n,c.fillColor=o,c.lineColor=l,c.lineWidth=h,c.vid=u,c}recover(){this.fillColor=null,this.lineColor=null,r.Pool.recover("DrawPieCmd",this)}run(t,e,i){t._drawPie(this.x+e,this.y+i,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid)}get cmdID(){return s.ID}get startAngle(){return 180*this._startAngle/Math.PI}set startAngle(t){this._startAngle=t*Math.PI/180}get endAngle(){return 180*this._endAngle/Math.PI}set endAngle(t){this._endAngle=t*Math.PI/180}}e.DrawPieCmd=s,s.ID="DrawPie"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n,o,l,h){var u=r.Pool.getItemByClass("DrawPolyCmd",s);return u.x=t,u.y=e,u.points=i,u.fillColor=a,u.lineColor=n,u.lineWidth=o,u.isConvexPolygon=l,u.vid=h,u}recover(){this.points=null,this.fillColor=null,this.lineColor=null,r.Pool.recover("DrawPolyCmd",this)}run(t,e,i){this.points&&t._drawPoly(this.x+e,this.y+i,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid)}get cmdID(){return s.ID}}e.DrawPolyCmd=s,s.ID="DrawPoly"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n,o,l){var h=r.Pool.getItemByClass("DrawRectCmd",s);return h.x=t,h.y=e,h.width=i,h.height=a,h.fillColor=n,h.lineColor=o,h.lineWidth=l,h}recover(){this.fillColor=null,this.lineColor=null,r.Pool.recover("DrawRectCmd",this)}run(t,e,i){t.drawRect(this.x+e,this.y+i,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth)}get cmdID(){return s.ID}}e.DrawRectCmd=s,s.ID="DrawRect"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(37),s=i(1);class a{constructor(){this.colorFlt=null,this.uv=null}static create(t,e,i,n,o,l,h,u,c,_){var d=s.Pool.getItemByClass("DrawTextureCmd",a);return d.texture=t,t._addReference(),d.x=e,d.y=i,d.width=n,d.height=o,d.matrix=l,d.alpha=h,d.color=u,d.blendMode=c,d.uv=null==_?null:_,u&&(d.colorFlt=new r.ColorFilter,d.colorFlt.setColor(u)),d}recover(){this.texture&&this.texture._removeReference(),this.texture=null,this.matrix=null,s.Pool.recover("DrawTextureCmd",this)}run(t,e,i){this.texture&&t.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,e,i,this.alpha,this.blendMode,this.colorFlt,this.uv)}get cmdID(){return a.ID}}e.DrawTextureCmd=a,a.ID="DrawTexture"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(38),s=i(47);class a{static getRT(t,e){return e|=0,(t|=0)>=1e4&&console.error("getRT error! w too big"),new r.RenderTexture2D(t,e,s.RenderTextureFormat.R8G8B8A8,-1)}static releaseRT(t){t._disposeResource()}}e.WebGLRTMgr=a,a.dict={}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a,n,o,l,h){var u=r.Pool.getItemByClass("FillTextureCmd",s);return u.texture=t,u.x=e,u.y=i,u.width=a,u.height=n,u.type=o,u.offset=l,u.other=h,u}recover(){this.texture=null,this.offset=null,this.other=null,r.Pool.recover("FillTextureCmd",this)}run(t,e,i){t.fillTexture(this.texture,this.x+e,this.y+i,this.width,this.height,this.type,this.offset,this.other)}get cmdID(){return s.ID}}e.FillTextureCmd=s,s.ID="FillTexture"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(){return r.Pool.getItemByClass("RestoreCmd",s)}recover(){r.Pool.recover("RestoreCmd",this)}run(t,e,i){t.restore()}get cmdID(){return s.ID}}e.RestoreCmd=s,s.ID="Restore"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i){var a=r.Pool.getItemByClass("RotateCmd",s);return a.angle=t,a.pivotX=e,a.pivotY=i,a}recover(){r.Pool.recover("RotateCmd",this)}run(t,e,i){t._rotate(this.angle,this.pivotX+e,this.pivotY+i)}get cmdID(){return s.ID}}e.RotateCmd=s,s.ID="Rotate"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a){var n=r.Pool.getItemByClass("ScaleCmd",s);return n.scaleX=t,n.scaleY=e,n.pivotX=i,n.pivotY=a,n}recover(){r.Pool.recover("ScaleCmd",this)}run(t,e,i){t._scale(this.scaleX,this.scaleY,this.pivotX+e,this.pivotY+i)}get cmdID(){return s.ID}}e.ScaleCmd=s,s.ID="Scale"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i){var a=r.Pool.getItemByClass("TransformCmd",s);return a.matrix=t,a.pivotX=e,a.pivotY=i,a}recover(){this.matrix=null,r.Pool.recover("TransformCmd",this)}run(t,e,i){t._transform(this.matrix,this.pivotX+e,this.pivotY+i)}get cmdID(){return s.ID}}e.TransformCmd=s,s.ID="Transform"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e){var i=r.Pool.getItemByClass("TranslateCmd",s);return i.tx=t,i.ty=e,i}recover(){r.Pool.recover("TranslateCmd",this)}run(t,e,i){t.translate(this.tx,this.ty)}get cmdID(){return s.ID}}e.TranslateCmd=s,s.ID="Translate"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(5);class s{constructor(){this._controlPoints=[new r.Point,new r.Point,new r.Point],this._calFun=this.getPoint2}_switchPoint(t,e){var i=this._controlPoints.shift();i.setTo(t,e),this._controlPoints.push(i)}getPoint2(t,e){var i=this._controlPoints[0],r=this._controlPoints[1],s=this._controlPoints[2],a=Math.pow(1-t,2)*i.x+2*t*(1-t)*r.x+Math.pow(t,2)*s.x,n=Math.pow(1-t,2)*i.y+2*t*(1-t)*r.y+Math.pow(t,2)*s.y;e.push(a,n)}getPoint3(t,e){var i=this._controlPoints[0],r=this._controlPoints[1],s=this._controlPoints[2],a=this._controlPoints[3],n=Math.pow(1-t,3)*i.x+3*r.x*t*(1-t)*(1-t)+3*s.x*t*t*(1-t)+a.x*Math.pow(t,3),o=Math.pow(1-t,3)*i.y+3*r.y*t*(1-t)*(1-t)+3*s.y*t*t*(1-t)+a.y*Math.pow(t,3);e.push(n,o)}insertPoints(t,e){var i,r;for(r=1/(t=t>0?t:5),i=0;i<=1;i+=r)this._calFun(i,e)}getBezierPoints(t,e=5,i=2){var s,a;if((a=t.length)<2*(i+1))return[];var n=[];switch(i){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=i;)this._controlPoints.push(r.Point.create());for(s=0;s<2*i;s+=2)this._switchPoint(t[s],t[s+1]);for(s=2*i;s<a;s+=2)this._switchPoint(t[s],t[s+1]),s/2%i==0&&this.insertPoints(e,n);return n}}e.Bezier=s,s.I=new s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(5),s=i(6);class a{static multiply(t,e,i){return(t.x-i.x)*(e.y-i.y)-(e.x-i.x)*(t.y-i.y)}static dis(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}static _getPoints(t,e=!1,i=null){for(a._mPointList||(a._mPointList=[]);a._mPointList.length<t;)a._mPointList.push(new r.Point);return i||(i=[]),i.length=0,e?a.getFrom(i,a._mPointList,t):a.getFromR(i,a._mPointList,t),i}static getFrom(t,e,i){var r;for(r=0;r<i;r++)t.push(e[r]);return t}static getFromR(t,e,i){var r;for(r=0;r<i;r++)t.push(e.pop());return t}static pListToPointList(t,e=!1){var i,r=t.length/2,s=a._getPoints(r,e,a._tempPointList);for(i=0;i<r;i++)s[i].setTo(t[i+i],t[i+i+1]);return s}static pointListToPlist(t){var e,i,r=t.length,s=a._temPList;for(s.length=0,e=0;e<r;e++)i=t[e],s.push(i.x,i.y);return s}static scanPList(t){return s.Utils.copyArray(t,a.pointListToPlist(a.scan(a.pListToPointList(t,!0))))}static scan(t){var e,i,r,n,o,l=0,h=t.length,u={};for((n=a._temArr).length=0,e=(h=t.length)-1;e>=0;e--)(o=(r=t[e]).x+"_"+r.y)in u||(u[o]=!0,n.push(r));for(h=n.length,s.Utils.copyArray(t,n),e=1;e<h;e++)(t[e].y<t[l].y||t[e].y==t[l].y&&t[e].x<t[l].x)&&(l=e);for(r=t[0],t[0]=t[l],t[l]=r,e=1;e<h-1;e++){for(l=e,i=e+1;i<h;i++)(a.multiply(t[i],t[l],t[0])>0||0==a.multiply(t[i],t[l],t[0])&&a.dis(t[0],t[i])<a.dis(t[0],t[l]))&&(l=i);r=t[e],t[e]=t[l],t[l]=r}if((n=a._temArr).length=0,t.length<3)return s.Utils.copyArray(n,t);for(n.push(t[0],t[1],t[2]),e=3;e<h;e++){for(;n.length>=2&&a.multiply(t[e],n[n.length-1],n[n.length-2])>=0;)n.pop();t[e]&&n.push(t[e])}return n}}e.GrahamScan=a,a._tempPointList=[],a._temPList=[],a._temArr=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(20);class s{constructor(t){this.setValue(t)}static create(t){if(t){var e=t instanceof r.ColorUtils?t:r.ColorUtils.create(t);return e._drawStyle||(e._drawStyle=new s(t))}return s.DEFAULT}setValue(t){this._color=t?t instanceof r.ColorUtils?t:r.ColorUtils.create(t):r.ColorUtils.create("#000000")}reset(){this._color=r.ColorUtils.create("#000000")}toInt(){return this._color.numColor}equal(t){return"string"==typeof t?this._color.strColor===t:t instanceof r.ColorUtils&&this._color.numColor===t.numColor}toColorStr(){return this._color.strColor}}e.DrawStyle=s,s.DEFAULT=new s("#000000")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(4),s=i(21),a=i(49),n=i(52),o=i(53);class l{constructor(t,e){this.submitStartPos=0,this.submitEndPos=0,this.context=null,this.touches=[],this.submits=[],this.sprite=null,this.meshlist=[],this.cachedClipInfo=new r.Matrix,this.oldTx=0,this.oldTy=0,this.invMat=new r.Matrix,this.context=t,this.sprite=e,t._globalClipMatrix.copyTo(this.cachedClipInfo)}startRec(){this.context._charSubmitCache._enable&&(this.context._charSubmitCache.enable(!1,this.context),this.context._charSubmitCache.enable(!0,this.context)),this.context._incache=!0,this.touches.length=0,this.context.touches=this.touches,this.context._globalClipMatrix.copyTo(this.cachedClipInfo),this.submits.length=0,this.submitStartPos=this.context._submits._length;for(var t=0,e=this.meshlist.length;t<e;t++){var i=this.meshlist[t];i.canReuse?i.releaseMesh():i.destroy()}this.meshlist.length=0,this._mesh=a.MeshQuadTexture.getAMesh(!1),this._pathMesh=o.MeshVG.getAMesh(!1),this._triangleMesh=n.MeshTexture.getAMesh(!1),this.meshlist.push(this._mesh),this.meshlist.push(this._pathMesh),this.meshlist.push(this._triangleMesh),this.context._curSubmit=s.SubmitBase.RENDERBASE,this._oldMesh=this.context._mesh,this._oldPathMesh=this.context._pathMesh,this._oldTriMesh=this.context._triangleMesh,this._oldMeshList=this.context.meshlist,this.context._mesh=this._mesh,this.context._pathMesh=this._pathMesh,this.context._triangleMesh=this._triangleMesh,this.context.meshlist=this.meshlist,this.oldTx=this.context._curMat.tx,this.oldTy=this.context._curMat.ty,this.context._curMat.tx=0,this.context._curMat.ty=0,this.context._curMat.copyTo(this.invMat),this.invMat.invert()}endRec(){this.context._charSubmitCache._enable&&(this.context._charSubmitCache.enable(!1,this.context),this.context._charSubmitCache.enable(!0,this.context));var t=this.context._submits;this.submitEndPos=t._length;for(var e=this.submitEndPos-this.submitStartPos,i=0;i<e;i++)this.submits.push(t[this.submitStartPos+i]);t._length-=e,this.context._mesh=this._oldMesh,this.context._pathMesh=this._oldPathMesh,this.context._triangleMesh=this._oldTriMesh,this.context.meshlist=this._oldMeshList,this.context._curSubmit=s.SubmitBase.RENDERBASE,this.context._curMat.tx=this.oldTx,this.context._curMat.ty=this.oldTy,this.context.touches=null,this.context._incache=!1}isCacheValid(){var t=this.context._globalClipMatrix;return t.a==this.cachedClipInfo.a&&t.b==this.cachedClipInfo.b&&t.c==this.cachedClipInfo.c&&t.d==this.cachedClipInfo.d&&t.tx==this.cachedClipInfo.tx&&t.ty==this.cachedClipInfo.ty}flushsubmit(){var t=s.SubmitBase.RENDERBASE;this.submits.forEach((function(e){e!=s.SubmitBase.RENDERBASE&&(s.SubmitBase.preRender=t,t=e,e.renderSubmit())}))}releaseMem(){}}e.WebGLCacheAsNormalCanvas=l,l.matI=new r.Matrix},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3),s=i(50),a=i(51);class n extends a.Buffer2D{constructor(t=35044){super(),this._bufferUsage=t,this._bufferType=r.LayaGL.instance.ELEMENT_ARRAY_BUFFER,this._buffer=new ArrayBuffer(8)}_checkArrayUse(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))}getUint16Array(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))}_bindForVAO(){var t=r.LayaGL.instance;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer)}bind(){if(s.Buffer._bindedIndexBuffer!==this._glBuffer){var t=r.LayaGL.instance;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer),s.Buffer._bindedIndexBuffer=this._glBuffer,!0}return!1}destory(){this._uint16Array=null,this._buffer=null}disposeResource(){this._disposeResource()}}e.IndexBuffer2D=n,n.create=function(t=35044){return new n(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(51),s=i(3),a=i(50);class n extends r.Buffer2D{constructor(t,e){super(),this._vertexStride=t,this._bufferUsage=e,this._bufferType=s.LayaGL.instance.ARRAY_BUFFER,this._buffer=new ArrayBuffer(8),this._floatArray32=new Float32Array(this._buffer),this._uint32Array=new Uint32Array(this._buffer)}get vertexStride(){return this._vertexStride}getFloat32Array(){return this._floatArray32}appendArray(t){var e=this._byteLength>>2;this.setByteLength(this._byteLength+4*t.length),this.getFloat32Array().set(t,e),this._upload=!0}_checkArrayUse(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer)),this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))}deleteBuffer(){super._disposeResource()}_bindForVAO(){var t=s.LayaGL.instance;t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer)}bind(){if(a.Buffer._bindedVertexBuffer!==this._glBuffer){var t=s.LayaGL.instance;return t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer),a.Buffer._bindedVertexBuffer=this._glBuffer,!0}return!1}destroy(){super.destroy(),this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null}}e.VertexBuffer2D=n,n.create=function(t,e=35048){return new n(t,e)}},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(11),a=i(82),n=i(31),o=r(i(125)),l=r(i(126)),h=r(i(127)),u=r(i(128)),c=r(i(129)),_=r(i(130));e.Shader2D=class{constructor(){this.ALPHA=1,this.defines=new s.ShaderDefines2D,this.shaderType=0,this.fillStyle=a.DrawStyle.DEFAULT,this.strokeStyle=a.DrawStyle.DEFAULT}destroy(){this.defines=null,this.filters=null}static __init__(){n.Shader.preCompile2D(0,s.ShaderDefines2D.TEXTURE2D,o.default,l.default,null),n.Shader.preCompile2D(0,s.ShaderDefines2D.PRIMITIVE,h.default,u.default,null),n.Shader.preCompile2D(0,s.ShaderDefines2D.SKINMESH,c.default,_.default,null)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(15),s=i(19),a=i(35),n=i(7),o=i(21);class l extends o.SubmitBase{constructor(t=o.SubmitBase.TYPE_2D){super(t)}renderSubmit(){if(0===this._numEle||!this._mesh||0==this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t._getSource();if(!e)return 1;this.shaderValue.texture=e}var i=n.WebGLContext.mainContext;return this._mesh.useMesh(i),this.shaderValue.upload(),s.BlendMode.activeBlendFunction!==this._blendFn&&(n.WebGLContext.setBlend(i,!0),this._blendFn(i),s.BlendMode.activeBlendFunction=this._blendFn),i.drawElements(i.TRIANGLES,this._numEle,i.UNSIGNED_SHORT,this._startIdx),r.Stat.renderBatches++,r.Stat.trianglesFaces+=this._numEle/3,1}releaseRender(){o.SubmitBase.RENDERBASE!=this&&--this._ref<1&&(l.POOL[l._poolSize++]=this,this.shaderValue.release(),this.shaderValue=null,this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}static create(t,e,i){var r=l._poolSize?l.POOL[--l._poolSize]:new l;r._ref=1,r._mesh=e,r._key.clear(),r._startIdx=e.indexNum*a.CONST3D2D.BYTES_PIDX,r._numEle=0;var n=t._nBlendType;r._blendFn=t._targets?s.BlendMode.targetFns[n]:s.BlendMode.fns[n],r.shaderValue=i,r.shaderValue.setValue(t._shader2D);var o=t._shader2D.filters;return o&&r.shaderValue.setFilters(o),r}static createShape(t,e,i,r){var a=l._poolSize?l.POOL[--l._poolSize]:new l;a._mesh=e,a._numEle=i,a._startIdx=2*e.indexNum,a._ref=1,a.shaderValue=r,a.shaderValue.setValue(t._shader2D);var n=t._nBlendType;return a._key.blendShader=n,a._blendFn=t._targets?s.BlendMode.targetFns[n]:s.BlendMode.fns[n],a}}e.Submit=l,l._poolSize=0,l.POOL=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(21),s=i(15),a=i(7),n=i(19),o=i(30),l=i(11),h=i(35);class u extends r.SubmitBase{constructor(t=r.SubmitBase.TYPE_2D){super(t)}releaseRender(){--this._ref<1&&(u.POOL[u._poolSize++]=this,this.shaderValue.release(),this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}renderSubmit(){if(0===this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t?t._getSource():null;if(!e)return 1}var i=a.WebGLContext.mainContext;this._mesh.useMesh(i);var h=r.SubmitBase.preRender,u=r.SubmitBase.preRender._key;return 0===this._key.blendShader&&this._key.submitType===u.submitType&&this._key.blendShader===u.blendShader&&o.BaseShader.activeShader&&r.SubmitBase.preRender.clipInfoID==this.clipInfoID&&h.shaderValue.defines._value===this.shaderValue.defines._value&&0==(this.shaderValue.defines._value&l.ShaderDefines2D.NOOPTMASK)?o.BaseShader.activeShader.uploadTexture2D(e):(n.BlendMode.activeBlendFunction!==this._blendFn&&(a.WebGLContext.setBlend(i,!0),this._blendFn(i),n.BlendMode.activeBlendFunction=this._blendFn),this.shaderValue.texture=e,this.shaderValue.upload()),i.drawElements(i.TRIANGLES,this._numEle,i.UNSIGNED_SHORT,this._startIdx),s.Stat.renderBatches++,s.Stat.trianglesFaces+=this._numEle/3,1}static create(t,e,i){var s=u._poolSize?u.POOL[--u._poolSize]:new u(r.SubmitBase.TYPE_TEXTURE);s._mesh=e,s._key.clear(),s._key.submitType=r.SubmitBase.KEY_DRAWTEXTURE,s._ref=1,s._startIdx=e.indexNum*h.CONST3D2D.BYTES_PIDX,s._numEle=0;var a=t._nBlendType;if(s._key.blendShader=a,s._blendFn=t._targets?n.BlendMode.targetFns[a]:n.BlendMode.fns[a],s.shaderValue=i,t._colorFiler){var o=t._colorFiler;i.defines.add(o.type),i.colorMat=o._mat,i.colorAlpha=o._alpha}return s}}e.SubmitTexture=u,u._poolSize=0,u.POOL=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(138),s=i(90),a=i(5),n=i(26),o=i(17),l=i(91),h=i(54),u=i(140),c=i(141),_=i(142),d=i(0);class f{constructor(){this.fontSizeInfo={},this.mapFont={},this.fontID=0,this.mapColor=[],this.colorID=0,this.fontScaleX=1,this.fontScaleY=1,this._curStrPos=0,this.textAtlases=[],this.isoTextures=[],this.lastFont=null,this.fontSizeW=0,this.fontSizeH=0,this.fontSizeOffX=0,this.fontSizeOffY=0,this.renderPerChar=!0,this.tmpAtlasPos=new a.Point,this.textureMem=0,d.ILaya.TextAtlas=r.TextAtlas;var t=!1,e=d.ILaya.Laya.MiniAdpter;e&&e.systemInfo&&e.systemInfo.system&&(t="ios 10.1.1"===e.systemInfo.system.toLowerCase()),d.ILaya.Browser.onMiniGame&&!t&&(f.isWan1Wan=!0),this.charRender=d.ILaya.Render.isConchApp?new _.CharRender_Native:new c.CharRender_Canvas(f.atlasWidth,f.atlasWidth,f.scaleFontWithCtx,!f.isWan1Wan,!1),f.textRenderInst=this,d.ILaya.Laya.textRender=this,f.atlasWidth2=f.atlasWidth*f.atlasWidth}setFont(t){if(this.lastFont!=t){this.lastFont=t;var e=this.getFontSizeInfo(t._family),i=e>>24,r=e>>16&255,s=e>>8&255,a=255&e,n=t._size/f.standardFontSize;this.fontSizeOffX=Math.ceil(i*n),this.fontSizeOffY=Math.ceil(r*n),this.fontSizeW=Math.ceil(s*n),this.fontSizeH=Math.ceil(a*n),t._font.indexOf("italic")>=0?this.fontStr=t._font.replace("italic",""):this.fontStr=t._font}}getNextChar(t){var e=t.length,i=this._curStrPos;if(i>=e)return null;for(var r=i,s=0;r<e;r++){var a=t.charCodeAt(r);if(a>>>11==27){if(1==s)break;s=1,r++}else if(65038===a||65039===a);else if(8205==a)s=2;else if(0==s)s=1;else if(1==s)break}return this._curStrPos=r,t.substring(i,r)}filltext(t,e,i,r,s,a,n,o,h,u=0){if(!(e.length<=0)){var c=l.FontInfo.Parse(s),_=0;switch(h){case"center":_=d.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":_=d.ILaya.Context.ENUM_TEXTALIGN_RIGHT}this._fast_filltext(t,e,null,i,r,c,a,n,o,_,u)}}fillWords(t,e,i,r,s,a,n,o){if(e&&!(e.length<=0)){var h="string"==typeof s?l.FontInfo.Parse(s):s;this._fast_filltext(t,null,e,i,r,h,a,n,o,0,0)}}_fast_filltext(t,e,i,r,s,a,n,o,l,u,c=0){if(!(e&&e.length<1||i&&i.length<1)){if(l<0&&(l=0),this.setFont(a),this.fontScaleX=this.fontScaleY=1,f.scaleFontWithCtx){var _=1,p=1;if(d.ILaya.Render.isConchApp&&!window.conchTextCanvas.scale||(_=t.getMatScaleX(),p=t.getMatScaleY()),_<1e-4||p<.1)return;this.fontScaleX=_,this.fontScaleY=p}a._italic&&(t._italicDeg=13);var m=e,g=!i&&e instanceof h.WordText,v=e,y=!!i,x=g?m.pageChars:[],T=0;switch(g?(v=m._text,(T=m.width)<0&&(T=m.width=this.charRender.getWidth(this.fontStr,v))):T=v?this.charRender.getWidth(this.fontStr,v):0,u){case d.ILaya.Context.ENUM_TEXTALIGN_CENTER:r-=T/2;break;case d.ILaya.Context.ENUM_TEXTALIGN_RIGHT:r-=T}m&&x&&this.hasFreedText(x)&&(x=m.pageChars=[]);var b=null,E=this.renderPerChar=!g||f.forceSplitRender||y||g&&m.splitRender;if(!x||x.length<1)if(E){var C,S=0,R=0;for(this._curStrPos=0;;){if(i){var w=i[this._curStrPos++];w?(C=w.char,S=w.x,R=w.y):C=null}else C=this.getNextChar(v);if(!C)break;if(!(b=this.getCharRenderInfo(C,a,n,o,l,!1)))break;if(b.isSpace);else{var M=x[b.tex.id];if(M)M=M.words;else{var L={texgen:b.tex.genID,tex:b.tex,words:[]};x[b.tex.id]=L,M=L.words}M.push({ri:b,x:S,y:R,w:b.bmpWidth/this.fontScaleX,h:b.bmpHeight/this.fontScaleY}),S+=b.width}}}else{var I=f.noAtlas||T*this.fontScaleX>f.atlasWidth;b=this.getCharRenderInfo(v,a,n,o,l,I),x[0]={texgen:b.tex.genID,tex:b.tex,words:[{ri:b,x:0,y:0,w:b.bmpWidth/this.fontScaleX,h:b.bmpHeight/this.fontScaleY}]}}this._drawResortedWords(t,r,s,x),t._italicDeg=0}}_drawResortedWords(t,e,i,r){var s=!!t._charSubmitCache&&t._charSubmitCache._enable,a=t._curMat;r.length;for(var n in r){var o=r[n];if(o){var l=o.words,h=l.length;if(!(h<=0))for(var u=r[n].tex,c=0;c<h;c++){var _=l[c],f=_.ri;if(!f.isSpace){if(f.touch(),t.drawTexAlign=!0,d.ILaya.Render.isConchApp)t._drawTextureM(u.texture,e+_.x-f.orix,i+_.y-f.oriy,_.w,_.h,null,1,f.uv);else{let r=u;t._inner_drawTexture(r.texture,r.id,e+_.x-f.orix,i+_.y-f.oriy,_.w,_.h,a,f.uv,1,s)}t.touches&&t.touches.push(f)}}}}}hasFreedText(t){for(var e=t.length,i=0;i<e;i++){var r=t[i];if(r){var s=r.tex;if(s.__destroyed||s.genID!=r.texgen)return!0}}return!1}getCharRenderInfo(t,e,i,r,a,n=!1){var o=this.mapFont[e._family];null==o&&(this.mapFont[e._family]=o=this.fontID++);var l=t+"_"+o+"_"+e._size+"_"+i;a>0&&(l+="_"+r+a),e._bold&&(l+="P"),1==this.fontScaleX&&1==this.fontScaleY||(l+=(20*this.fontScaleX|0)+"_"+(20*this.fontScaleY|0));var h,c,_=0,p=this.textAtlases.length;if(!n)for(_=0;_<p;_++)if(h=(c=this.textAtlases[_]).charMaps[l])return h.touch(),h;h=new u.CharRenderInfo,this.charRender.scale(this.fontScaleX,this.fontScaleY),h.char=t,h.height=e._size;var m=d.ILaya.Render.isConchApp?0:e._size/3|0,g=null;a||(a=0);var v=Math.ceil((this.charRender.getWidth(this.fontStr,t)+2*a)*this.fontScaleX);if(v>this.charRender.canvasWidth&&(this.charRender.canvasWidth=Math.min(2048,v+2*m)),n){if(this.charRender.fontsz=e._size,g=this.charRender.getCharBmp(t,this.fontStr,a,i,r,h,m,m,m,m,null)){var y=s.TextTexture.getTextTexture(g.width,g.height);y.addChar(g,0,0,h.uv),h.tex=y,h.orix=m,h.oriy=m,y.ri=h,this.isoTextures.push(y)}}else{var x=t.length,T=1*a,b=Math.ceil((this.fontSizeW+2*T)*this.fontScaleX),E=Math.ceil((this.fontSizeH+2*T)*this.fontScaleY);f.imgdtRect[0]=(m-this.fontSizeOffX-T)*this.fontScaleX|0,f.imgdtRect[1]=(m-this.fontSizeOffY-T)*this.fontScaleY|0,this.renderPerChar||1==x?(f.imgdtRect[2]=Math.max(v,b),f.imgdtRect[3]=Math.max(v,E)):(f.imgdtRect[2]=-1,f.imgdtRect[3]=E),this.charRender.fontsz=e._size,(g=this.charRender.getCharBmp(t,this.fontStr,a,i,r,h,m,m,m,m,f.imgdtRect))&&(c=this.addBmpData(g,h),f.isWan1Wan?(h.orix=m,h.oriy=m):(h.orix=this.fontSizeOffX+T,h.oriy=this.fontSizeOffY+T),c.charMaps[l]=h)}return h}addBmpData(t,e){for(var i,s=t.width,a=t.height,n=this.textAtlases.length,o=!1,l=0;l<n&&!(o=(i=this.textAtlases[l]).getAEmpty(s,a,this.tmpAtlasPos));l++);if(!o){if(i=new r.TextAtlas,this.textAtlases.push(i),!(o=i.getAEmpty(s,a,this.tmpAtlasPos)))throw"err1";this.cleanAtlases()}return o&&(i.texture.addChar(t,this.tmpAtlasPos.x,this.tmpAtlasPos.y,e.uv),e.tex=i.texture),i}GC(){for(var t=0,e=this.textAtlases.length,i=f.destroyAtlasDt,r=0,a=n.RenderInfo.loopCount,o=-1,l=0,h=null,u=null;t<e;t++){if(h=(u=this.textAtlases[t]).texture){h.curUsedCovRate,r+=h.curUsedCovRateAtlas;var c=u.usedRate-h.curUsedCovRateAtlas;l<c&&(l=c,o=t)}a-u.texture.lastTouchTm>i&&(f.showLog&&console.log(u.texture.id),u.destroy(),this.textAtlases[t]=this.textAtlases[e-1],e--,t--,o=-1)}for(this.textAtlases.length=e,e=this.isoTextures.length,t=0;t<e;t++)a-(h=this.isoTextures[t]).lastTouchTm>f.destroyUnusedTextureDt&&(h.ri.deleted=!0,h.ri.tex=null,h.destroy(),this.isoTextures[t]=this.isoTextures[e-1],e--,t--);this.isoTextures.length=e;var _=this.textAtlases.length>1&&this.textAtlases.length-r>=2;(f.atlasWidth*f.atlasWidth*4*this.textAtlases.length>f.cleanMem||_||f.simClean)&&(f.simClean=!1,f.showLog&&console.log("清理使用率低的贴图。总使用率:",r,":",this.textAtlases.length,"最差贴图:"+o),o>=0&&((u=this.textAtlases[o]).destroy(),this.textAtlases[o]=this.textAtlases[this.textAtlases.length-1],this.textAtlases.length=this.textAtlases.length-1)),s.TextTexture.clean()}cleanAtlases(){}getCharBmp(t){}checkBmpLine(t,e,i,r){this.bmpData32.buffer!=t.data.buffer&&(this.bmpData32=new Uint32Array(t.data.buffer));for(var s=t.width*e+i,a=i;a<r;a++)if(0!=this.bmpData32[s++])return!0;return!1}updateBbx(t,e,i=!1){var r=t.width,s=t.height,a=0,n=e[1],o=0,l=n;if(this.checkBmpLine(t,n,0,r))for(;;){if((l=(n+o)/2|0)+1>=n){e[1]=l;break}this.checkBmpLine(t,l,0,r)?n=l:o=l}if(e[3]>s)e[3]=s;else if(l=n=e[3],o=s,this.checkBmpLine(t,n,0,r))for(;;){if((l=(n+o)/2|0)-1<=n){e[3]=l;break}this.checkBmpLine(t,l,0,r)?n=l:o=l}if(!i){var h=e[0],u=r*e[1];for(l=e[1];l<e[3];l++){for(a=0;a<h;a++)if(0!=this.bmpData32[u+a]){h=a;break}u+=r}e[0]=h;var c=e[2];for(u=r*e[1],l=e[1];l<e[3];l++){for(a=c;a<r;a++)if(0!=this.bmpData32[u+a]){c=a;break}u+=r}e[2]=c}}getFontSizeInfo(t){var e=this.fontSizeInfo[t];if(null!=e)return e;var i="bold "+f.standardFontSize+"px "+t;if(f.isWan1Wan){this.fontSizeW=1.5*this.charRender.getWidth(i,"有"),this.fontSizeH=1.5*f.standardFontSize;var r=this.fontSizeW<<8|this.fontSizeH;return this.fontSizeInfo[t]=r,r}f.pixelBBX[0]=f.standardFontSize/2,f.pixelBBX[1]=f.standardFontSize/2,f.pixelBBX[2]=f.standardFontSize,f.pixelBBX[3]=f.standardFontSize;var s=16,a=16;this.charRender.scale(1,1),f.tmpRI.height=f.standardFontSize,this.charRender.fontsz=f.standardFontSize;var n=this.charRender.getCharBmp("g",i,0,"red",null,f.tmpRI,s,a,16,16);d.ILaya.Render.isConchApp&&(n.data=new Uint8ClampedArray(n.data)),this.bmpData32=new Uint32Array(n.data.buffer),this.updateBbx(n,f.pixelBBX,!1),n=this.charRender.getCharBmp("有",i,0,"red",null,f.tmpRI,a,a,16,16),d.ILaya.Render.isConchApp&&(n.data=new Uint8ClampedArray(n.data)),this.bmpData32=new Uint32Array(n.data.buffer),f.pixelBBX[2]<s+f.tmpRI.width&&(f.pixelBBX[2]=s+f.tmpRI.width),this.updateBbx(n,f.pixelBBX,!1),d.ILaya.Render.isConchApp&&(s=0,a=0);var o=Math.max(s-f.pixelBBX[0],0)<<24|Math.max(a-f.pixelBBX[1],0)<<16|f.pixelBBX[2]-f.pixelBBX[0]<<8|f.pixelBBX[3]-f.pixelBBX[1];return this.fontSizeInfo[t]=o,o}printDbgInfo(){for(var t in console.log("图集个数:"+this.textAtlases.length+",每个图集大小:"+f.atlasWidth+"x"+f.atlasWidth," 用canvas:",f.isWan1Wan),console.log("图集占用空间:"+f.atlasWidth*f.atlasWidth*4/1024/1024*this.textAtlases.length+"M"),console.log("缓存用到的字体:"),this.mapFont){var e=this.getFontSizeInfo(t),i=e>>24,r=e>>16&255,s=e>>8&255,a=255&e;console.log("    "+t," off:",i,r," size:",s,a)}var o=0;console.log("缓存数据:");var l=0,h=0;this.textAtlases.forEach((function(t){var e=t.texture.id,i=n.RenderInfo.loopCount-t.texture.lastTouchTm,r=i>0?i+"帧以前":"当前帧";for(var s in l+=t.texture.curUsedCovRate,h+=t.texture.curUsedCovRateAtlas,console.log("--图集(id:"+e+",当前使用率:"+(1e3*t.texture.curUsedCovRate|0)+"‰","当前图集使用率:",(100*t.texture.curUsedCovRateAtlas|0)+"%","图集使用率:",100*t.usedRate|0,"%, 使用于:"+r+")--:"),t.charMaps){var a=t.charMaps[s];console.log("     off:",a.orix,a.oriy," bmp宽高:",a.bmpWidth,a.bmpHeight,"无效:",a.deleted,"touchdt:",n.RenderInfo.loopCount-a.touchTick,"位置:",a.uv[0]*f.atlasWidth|0,a.uv[1]*f.atlasWidth|0,"字符:",a.char,"key:",s),o++}})),console.log("独立贴图文字("+this.isoTextures.length+"个):"),this.isoTextures.forEach((function(t){console.log("    size:",t._texW,t._texH,"touch间隔:",n.RenderInfo.loopCount-t.lastTouchTm,"char:",t.ri.char)})),console.log("总缓存:",o,"总使用率:",l,"总当前图集使用率:",h)}showAtlas(t,e,i,r,s,a){if(!this.textAtlases[t])return console.log("没有这个图集"),null;var n=new d.ILaya.Sprite,l=this.textAtlases[t].texture,h={width:f.atlasWidth,height:f.atlasWidth,sourceWidth:f.atlasWidth,sourceHeight:f.atlasWidth,offsetX:0,offsetY:0,getIsReady:function(){return!0},_addReference:function(){},_removeReference:function(){},_getSource:function(){return l._getSource()},bitmap:{id:l.id},_uv:o.Texture.DEF_UV};return n.size=function(t,i){return this.width=t,this.height=i,n.graphics.clear(),n.graphics.drawRect(0,0,n.width,n.height,e),n.graphics.drawTexture(h,0,0,n.width,n.height),this},n.graphics.drawRect(0,0,s,a,e),n.graphics.drawTexture(h,0,0,s,a),n.pos(i,r),d.ILaya.stage.addChild(n),n}filltext_native(t,e,i,r,s,a,n,o,h,u,c=0){if(!(e&&e.length<=0||i&&i.length<1)){var _=l.FontInfo.Parse(a),f=0;switch(u){case"center":f=d.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":f=d.ILaya.Context.ENUM_TEXTALIGN_RIGHT}return this._fast_filltext(t,e,i,r,s,_,n,o,h,f,c)}}}e.TextRender=f,f.useOldCharBook=!1,f.atlasWidth=1024,f.noAtlas=!1,f.forceSplitRender=!1,f.forceWholeRender=!1,f.scaleFontWithCtx=!0,f.standardFontSize=32,f.destroyAtlasDt=10,f.checkCleanTextureDt=2e3,f.destroyUnusedTextureDt=3e3,f.cleanMem=104857600,f.isWan1Wan=!1,f.showLog=!1,f.debugUV=!1,f.tmpRI=new u.CharRenderInfo,f.pixelBBX=[0,0,0,0],f.imgdtRect=[0,0,0,0],f.simClean=!1,s.TextTexture.gTextRender=f},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3),s=i(26),a=i(24),n=i(7),o=i(0);class l extends a.Resource{constructor(t,e){super(),this._texW=0,this._texH=0,this.__destroyed=!1,this._discardTm=0,this.genID=0,this.bitmap={id:0,_glTexture:null},this.curUsedCovRate=0,this.curUsedCovRateAtlas=0,this.lastTouchTm=0,this.ri=null,this._texW=t||l.gTextRender.atlasWidth,this._texH=e||l.gTextRender.atlasWidth,this.bitmap.id=this.id,this.lock=!0}recreateResource(){if(!this._source){var t=r.LayaGL.instance,e=this._source=t.createTexture();this.bitmap._glTexture=e,n.WebGLContext.bindTexture(t,t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._texW,this._texH,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),l.gTextRender.debugUV&&this.fillWhite()}}addChar(t,e,i,s=null){if(l.gTextRender.isWan1Wan)return this.addCharCanvas(t,e,i,s);!this._source&&this.recreateResource();var a=r.LayaGL.instance;n.WebGLContext.bindTexture(a,a.TEXTURE_2D,this._source),!o.ILaya.Render.isConchApp&&a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var h,u,c,_,d=t.data;return t.data instanceof Uint8ClampedArray&&(d=new Uint8Array(d.buffer)),a.texSubImage2D(a.TEXTURE_2D,0,e,i,t.width,t.height,a.RGBA,a.UNSIGNED_BYTE,d),!o.ILaya.Render.isConchApp&&a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),h=e/this._texW,u=i/this._texH,c=(e+t.width)/this._texW,_=(i+t.height)/this._texH,(s=s||new Array(8))[0]=h,s[1]=u,s[2]=c,s[3]=u,s[4]=c,s[5]=_,s[6]=h,s[7]=_,s}addCharCanvas(t,e,i,s=null){!this._source&&this.recreateResource();var a,l,h,u,c=r.LayaGL.instance;return n.WebGLContext.bindTexture(c,c.TEXTURE_2D,this._source),!o.ILaya.Render.isConchApp&&c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),c.texSubImage2D(c.TEXTURE_2D,0,e,i,c.RGBA,c.UNSIGNED_BYTE,t),!o.ILaya.Render.isConchApp&&c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.ILaya.Render.isConchApp?(a=e/this._texW,l=i/this._texH,h=(e+t.width)/this._texW,u=(i+t.height)/this._texH):(a=(e+1)/this._texW,l=(i+1)/this._texH,h=(e+t.width-1)/this._texW,u=(i+t.height-1)/this._texH),(s=s||new Array(8))[0]=a,s[1]=l,s[2]=h,s[3]=l,s[4]=h,s[5]=u,s[6]=a,s[7]=u,s}fillWhite(){!this._source&&this.recreateResource();var t=r.LayaGL.instance,e=new Uint8Array(this._texW*this._texH*4);e.fill(255),t.texSubImage2D(t.TEXTURE_2D,0,0,0,this._texW,this._texH,t.RGBA,t.UNSIGNED_BYTE,e)}discard(){o.ILaya.stage.setGlobalRepaint(),this.destroy()}static getTextTexture(t,e){return new l(t,e)}destroy(){this.__destroyed=!0;var t=r.LayaGL.instance;this._source&&t.deleteTexture(this._source),this._source=null}static clean(){var t=s.RenderInfo.loopStTm;if(0===l.cleanTm&&(l.cleanTm=t),t-l.cleanTm>=l.gTextRender.checkCleanTextureDt){for(var e=0;e<l.poolLen;e++){var i=l.pool[e];t-i._discardTm>=l.gTextRender.destroyUnusedTextureDt&&(i.destroy(),l.pool[e]=l.pool[l.poolLen-1],l.poolLen--,e--)}l.cleanTm=t}}touchRect(t,e){this.lastTouchTm!=e&&(this.curUsedCovRate=0,this.curUsedCovRateAtlas=0,this.lastTouchTm=e);var i=l.gTextRender.atlasWidth*l.gTextRender.atlasWidth,r=o.ILaya.TextAtlas.atlasGridW*o.ILaya.TextAtlas.atlasGridW;this.curUsedCovRate+=t.bmpWidth*t.bmpHeight/i,this.curUsedCovRateAtlas+=Math.ceil(t.bmpWidth/o.ILaya.TextAtlas.atlasGridW)*Math.ceil(t.bmpHeight/o.ILaya.TextAtlas.atlasGridW)/(i/r)}get texture(){return this}_getSource(){return this._source}drawOnScreen(t,e){}}e.TextTexture=l,l.gTextRender=null,l.pool=new Array(10),l.poolLen=0,l.cleanTm=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{constructor(t){this._font="14px Arial",this._family="Arial",this._size=14,this._italic=!1,this._bold=!1,this._id=r._gfontID++,this.setFont(t||this._font)}static Parse(t){if(t===r._lastFont)return r._lastFontInfo;var e=r._cache[t];return e||(e=r._cache[t]=new r(t)),r._lastFont=t,r._lastFontInfo=e,e}setFont(t){this._font=t;var e=t.split(" "),i=e.length;if(i<2)1==i&&e[0].indexOf("px")>0&&(this._size=parseInt(e[0]));else{for(var r=-1,s=0;s<i;s++)if(e[s].indexOf("px")>0||e[s].indexOf("pt")>0){r=s,this._size=parseInt(e[s]),this._size<=0&&(console.error("font parse error:"+t),this._size=14);break}var a=r+1,n=e[a];for(a++;a<i;a++)n+=" "+e[a];this._family=n.split(",")[0],this._italic=e.indexOf("italic")>=0,this._bold=e.indexOf("bold")>=0}}}e.FontInfo=r,r.EMPTY=new r(null),r._cache={},r._gfontID=0,r._lastFont=""},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ICharRender=class{constructor(){this.fontsz=16}getWidth(t,e){return 0}scale(t,e){}get canvasWidth(){return 0}set canvasWidth(t){}getCharBmp(t,e,i,r,s,a,n,o,l,h,u=null){return null}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(37),s=i(20),a=i(1);class n{static create(t,e,i,o,l,h,u,c,_,d,f){var p=a.Pool.getItemByClass("DrawTrianglesCmd",n);if(p.texture=t,p.x=e,p.y=i,p.vertices=o,p.uvs=l,p.indices=h,p.matrix=u,p.alpha=c,_){p.color=new r.ColorFilter;var m=s.ColorUtils.create(_).arrColor;p.color.color(255*m[0],255*m[1],255*m[2],255*m[3])}return p.blendMode=d,p.colorNum=f,p}recover(){this.texture=null,this.vertices=null,this.uvs=null,this.indices=null,this.matrix=null,a.Pool.recover("DrawTrianglesCmd",this)}run(t,e,i){t.drawTriangles(this.texture,this.x+e,this.y+i,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode,this.colorNum)}get cmdID(){return n.ID}}e.DrawTrianglesCmd=n,n.ID="DrawTriangles"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{constructor(){}static create(t,e,i,a,n,o){var l=r.Pool.getItemByClass("Draw9GridTexture",s);return l.texture=t,t._addReference(),l.x=e,l.y=i,l.width=a,l.height=n,l.sizeGrid=o,l}recover(){this.texture._removeReference(),r.Pool.recover("Draw9GridTexture",this)}run(t,e,i){t.drawTextureWithSizeGrid(this.texture,this.x,this.y,this.width,this.height,this.sizeGrid,e,i)}get cmdID(){return s.ID}}e.Draw9GridTexture=s,s.ID="Draw9GridTexture"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(96);class s{constructor(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],r.CacheManger.regCacheByFunction(this.startDispose.bind(this),this.getCacheList.bind(this))}static getInstance(){return s.instance=s.instance||new s}getId(){return this._id++}addShape(t,e){this.shapeDic[t]=e,this.useDic[t]||(this.useDic[t]=!0)}addLine(t,e){this.shapeLineDic[t]=e,this.shapeLineDic[t]||(this.shapeLineDic[t]=!0)}getShape(t){this._checkKey&&null!=this.useDic[t]&&(this.useDic[t]=!0)}deleteShape(t){this.shapeDic[t]&&(this.shapeDic[t]=null,delete this.shapeDic[t]),this.shapeLineDic[t]&&(this.shapeLineDic[t]=null,delete this.shapeLineDic[t]),null!=this.useDic[t]&&delete this.useDic[t]}getCacheList(){var t,e=[];for(t in this.shapeDic)e.push(this.shapeDic[t]);for(t in this.shapeLineDic)e.push(this.shapeLineDic[t]);return e}startDispose(t){var e;for(e in this.useDic)this.useDic[e]=!1;this._checkKey=!0}endDispose(){if(this._checkKey){var t;for(t in this.useDic)this.useDic[t]||this.deleteShape(t);this._checkKey=!1}}}e.VectorGraphManager=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0);class s{constructor(){}static regCacheByFunction(t,e){var i;s.unRegCacheByFunction(t,e),i={tryDispose:t,getCacheList:e},s._cacheList.push(i)}static unRegCacheByFunction(t,e){var i,r;for(r=s._cacheList.length,i=0;i<r;i++)if(s._cacheList[i].tryDispose==t&&s._cacheList[i].getCacheList==e)return void s._cacheList.splice(i,1)}static forceDispose(){var t,e=s._cacheList.length;for(t=0;t<e;t++)s._cacheList[t].tryDispose(!0)}static beginCheck(t=15e3){r.ILaya.systemTimer.loop(t,null,s._checkLoop)}static stopCheck(){r.ILaya.systemTimer.clear(null,s._checkLoop)}static _checkLoop(){var t=s._cacheList;if(!(t.length<1)){var e,i,a=r.ILaya.Browser.now();for(i=e=t.length;e>0&&(s._index++,s._index=s._index%i,t[s._index].tryDispose(!1),!(r.ILaya.Browser.now()-a>s.loopTimeLimit));)e--}}}e.CacheManger=s,s.loopTimeLimit=2,s._cacheList=[],s._index=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(22),s=i(27),a=i(44),n=i(4),o=i(10),l=i(17),h=i(73),u=i(15),c=i(19),_=i(83),d=i(11),f=i(13),p=i(48),m=i(7),g=i(149),v=i(0);class y{constructor(t,e){if(g.LayaGLQuickRunner.map[t])return this._fun=g.LayaGLQuickRunner.map[t],void(this._next=y.NORENDER);switch(this._next=e||y.NORENDER,t){case 0:return void(this._fun=this._no);case s.SpriteConst.ALPHA:return void(this._fun=this._alpha);case s.SpriteConst.TRANSFORM:return void(this._fun=this._transform);case s.SpriteConst.BLEND:return void(this._fun=this._blend);case s.SpriteConst.CANVAS:return void(this._fun=this._canvas);case s.SpriteConst.MASK:return void(this._fun=this._mask);case s.SpriteConst.CLIP:return void(this._fun=this._clip);case s.SpriteConst.STYLE:return void(this._fun=this._style);case s.SpriteConst.GRAPHICS:return void(this._fun=this._graphics);case s.SpriteConst.CHILDS:return void(this._fun=this._children);case s.SpriteConst.CUSTOM:return void(this._fun=this._custom);case s.SpriteConst.TEXTURE:return void(this._fun=this._texture);case s.SpriteConst.FILTERS:return void(this._fun=a.Filter._filter);case y.INIT:return void(this._fun=y._initRenderFun)}this.onCreate(t)}static __init__(){var t,e,i;for(g.LayaGLQuickRunner.__init__(),i=new y(y.INIT,null),e=y.renders.length=2*s.SpriteConst.CHILDS,t=0;t<e;t++)y.renders[t]=i;y.renders[0]=new y(0,null)}static _initRenderFun(t,e,i,r){var s=t._renderType;(y.renders[s]=y._getTypeRender(s))._fun(t,e,i,r)}static _getTypeRender(t){if(g.LayaGLQuickRunner.map[t])return new y(t,null);for(var e=null,i=s.SpriteConst.CHILDS;i>0;)i&t&&(e=new y(i,e)),i>>=1;return e}onCreate(t){}_style(t,e,i,r){var s=t._style;null!=s.render&&s.render(t,e,i,r);var a=this._next;a._fun.call(a,t,e,i,r)}_no(t,e,i,r){}_custom(t,e,i,r){t.customRender(e,i,r),this._next._fun.call(this._next,t,e,i-t.pivotX,r-t.pivotY)}_clip(t,e,i,r){var s=this._next;if(s!=y.NORENDER){var a=t._style.scrollRect;e.save(),e.clipRect(i,r,a.width,a.height),s._fun.call(s,t,e,i-a.x,r-a.y),e.restore()}}_texture(t,e,i,r){var s=t.texture;s._getSource()&&e.drawTexture(s,i-t.pivotX+s.offsetX,r-t.pivotY+s.offsetY,t._width||s.width,t._height||s.height);var a=this._next;a!=y.NORENDER&&a._fun.call(a,t,e,i,r)}_graphics(t,e,i,r){var s=t._style,a=t._graphics;a&&a._render(t,e,i-s.pivotX,r-s.pivotY);var n=this._next;n!=y.NORENDER&&n._fun.call(n,t,e,i,r)}_image(t,e,i,r){var s=t._style;e.drawTexture2(i,r,s.pivotX,s.pivotY,t.transform,t._graphics._one)}_image2(t,e,i,r){var s=t._style;e.drawTexture2(i,r,s.pivotX,s.pivotY,t.transform,t._graphics._one)}_alpha(t,e,i,r){var s;if((s=t._style.alpha)>.01||t._needRepaint()){var a=e.globalAlpha;e.globalAlpha*=s;var n=this._next;n._fun.call(n,t,e,i,r),e.globalAlpha=a}}_transform(t,e,i,r){var s=t.transform,a=this._next;t._style;s&&a!=y.NORENDER?(e.save(),e.transform(s.a,s.b,s.c,s.d,s.tx+i,s.ty+r),a._fun.call(a,t,e,0,0),e.restore()):a!=y.NORENDER&&a._fun.call(a,t,e,i,r)}_children(t,e,i,s){var a,n=t._style,o=t._children,l=o.length;i-=t.pivotX,s-=t.pivotY;var h=t._getBit(r.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0);if(n.viewport){var u,c,_=n.viewport,d=_.x,f=_.y,p=_.right,m=_.bottom;for(g=0;g<l;++g)(a=o[g])._visible&&(u=a._x)<p&&u+a.width>d&&(c=a._y)<m&&c+a.height>f&&a.render(e,i,s)}else for(var g=0;g<l;++g)(a=o[g])._visible&&a.render(e,i,s);h&&e.drawCallOptimize(!1)}_canvas(t,e,i,r){var s=t._cacheStyle,a=this._next;if(s.enableCanvasRender){"bitmap"===s.cacheAs?u.Stat.canvasBitmap++:u.Stat.canvasNormal++;var n=!1,o=!1;if(s.canvas){var l=s.canvas,h=(l.context,l.touches);if(h)for(var c=0;c<h.length;c++)if(h[c].deleted){o=!0;break}n=l.isCacheValid&&!l.isCacheValid()}if(t._needRepaint()||!s.canvas||o||n||v.ILaya.stage.isGlobalRepaint())if("normal"===s.cacheAs){if(e._targets)return void a._fun.call(a,t,e,i,r);this._canvas_webgl_normal_repaint(t,e)}else this._canvas_repaint(t,e,i,r);var _=s.cacheRect;e.drawCanvas(s.canvas,i+_.x,r+_.y,_.width,_.height)}else a._fun.call(a,t,e,i,r)}_canvas_repaint(t,e,i,r){var s,a,n,o,l,h,c,_,d,f=t._cacheStyle,p=this._next,m=f.canvas,g=f.cacheAs;if(c=(d=f._calculateCacheRect(t,g,i,r)).x,_=d.y,l=(o=f.cacheRect).width*c,h=o.height*_,a=o.x,n=o.y,"bitmap"===g&&(l>2048||h>2048))return console.warn("cache bitmap size larger than 2048,cache ignored"),f.releaseContext(),void p._fun.call(p,t,e,i,r);if(m||(f.createContext(),m=f.canvas),(s=m.context).sprite=t,(m.width!=l||m.height!=h)&&m.size(l,h),"bitmap"===g?s.asBitmap=!0:"normal"===g&&(s.asBitmap=!1),s.clear(),1!=c||1!=_){var v=s;v.save(),v.scale(c,_),p._fun.call(p,t,s,-a,-n),v.restore(),t._applyFilters()}else v=s,p._fun.call(p,t,s,-a,-n),t._applyFilters();f.staticCache&&(f.reCache=!1),u.Stat.canvasReCache++}_canvas_webgl_normal_repaint(t,e){var i=t._cacheStyle,r=this._next,s=i.canvas,a=i.cacheAs;i._calculateCacheRect(t,a,0,0),s||(s=i.canvas=new _.WebGLCacheAsNormalCanvas(e,t));var n=s.context;s.startRec(),r._fun.call(r,t,n,t.pivotX,t.pivotY),t._applyFilters(),u.Stat.canvasReCache++,s.endRec()}_blend(t,e,i,r){var s=t._style,a=this._next;s.blendMode?(e.save(),e.globalCompositeOperation=s.blendMode,a._fun.call(a,t,e,i,r),e.restore()):a._fun.call(a,t,e,i,r)}_mask(t,e,i,r){var s=this._next,a=t.mask,u=e;if(a){u.save();var c=u.globalCompositeOperation,_=new o.Rectangle;if(_.copyFrom(a.getBounds()),_.width=Math.round(_.width),_.height=Math.round(_.height),_.x=Math.round(_.x),_.y=Math.round(_.y),_.width>0&&_.height>0){var m=_.width,g=_.height,v=h.WebGLRTMgr.getRT(m,g);u.breakNextMerge(),u.pushRT(),u.addRenderObject(p.SubmitCMD.create([u,v,m,g],y.tmpTarget,this)),a.render(u,-_.x,-_.y),u.breakNextMerge(),u.popRT(),u.save(),u.clipRect(i+_.x-t.getStyle().pivotX,r+_.y-t.getStyle().pivotY,m,g),s._fun.call(s,t,u,i,r),u.restore(),c=u.globalCompositeOperation,u.addRenderObject(p.SubmitCMD.create(["mask"],y.setBlendMode,this));var x=f.Value2D.create(d.ShaderDefines2D.TEXTURE2D,0),T=l.Texture.INV_UV;u.drawTarget(v,i+_.x-t.getStyle().pivotX,r+_.y-t.getStyle().pivotY,m,g,n.Matrix.TEMP.identity(),x,T,6),u.addRenderObject(p.SubmitCMD.create([v],y.recycleTarget,this)),u.addRenderObject(p.SubmitCMD.create([c],y.setBlendMode,this))}u.restore()}else s._fun.call(s,t,e,i,r)}static tmpTarget(t,e,i,r){e.start(),e.clear(0,0,0,0)}static recycleTarget(t){h.WebGLRTMgr.releaseRT(t)}static setBlendMode(t){var e=m.WebGLContext.mainContext;c.BlendMode.targetFns[c.BlendMode.TOINT[t]](e)}}e.RenderSprite=y,y.INIT=69905,y.renders=[],y.NORENDER=new y(0,null),y.tempUV=new Array(8)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{constructor(){this.reset()}reset(){return this.scaleX=this.scaleY=1,this.skewX=this.skewY=0,this.pivotX=this.pivotY=this.rotation=0,this.alpha=1,this.scrollRect&&this.scrollRect.recover(),this.scrollRect=null,this.viewport&&this.viewport.recover(),this.viewport=null,this.hitArea=null,this.dragging=null,this.blendMode=null,this}recover(){this!==s.EMPTY&&r.Pool.recover("SpriteStyle",this.reset())}static create(){return r.Pool.getItemByClass("SpriteStyle",s)}}e.SpriteStyle=s,s.EMPTY=new s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0);class s{constructor(){this._pool=[],this._map={},this._laters=[]}_update(){let t=this._laters,e=t.length;if(e>0){for(let i=0,r=e-1;i<=r;i++){let e=t[i];this._map[e.key]=null,null!==e.method&&(e.run(),e.clear()),this._pool.push(e),i===r&&(r=t.length-1)}t.length=0}}_getHandler(t,e){var i=t?t.$_GID||(t.$_GID=r.ILaya.Utils.getGID()):0,s=e.$_TID||(e.$_TID=r.ILaya.Timer._mid++);return this._map[i+"."+s]}callLater(t,e,i=null){if(null==this._getHandler(t,e)){let n;n=this._pool.length?this._pool.pop():new a,n.caller=t,n.method=e,n.args=i;var r=t?t.$_GID:0,s=e.$_TID;n.key=r+"."+s,this._map[n.key]=n,this._laters.push(n)}}runCallLater(t,e){var i=this._getHandler(t,e);i&&null!=i.method&&(this._map[i.key]=null,i.run(),i.clear())}}e.CallLater=s,s.I=new s;class a{clear(){this.caller=null,this.method=null,this.args=null}run(){var t=this.caller;if(t&&t.destroyed)return this.clear();var e=this.method,i=this.args;null!=e&&(i?e.apply(t,i):e.call(t))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(55);class s{}e.RunDriver=s,s.createShaderCondition=function(t){var e="(function() {return "+t+";})";return window.Laya._runScript(e)},s.changeWebGLSize=function(t,e){r.WebGL.onStageResize(t,e)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(157),s=i(2),a=i(12),n=i(14),o=i(25),l=i(8),h=i(1),u=i(0);class c extends a.EventDispatcher{constructor(){super(...arguments),this.loaded=!1}dispose(){var t=c._audioCache[this.url];h.Pool.clearBySign("audio:"+this.url),t&&(o.Render.isConchApp||(t.src=""),delete c._audioCache[this.url])}static _initMusicAudio(){c._musicAudio||(c._musicAudio||(c._musicAudio=l.Browser.createElement("audio")),o.Render.isConchApp||l.Browser.document.addEventListener("mousedown",c._makeMusicOK))}static _makeMusicOK(){l.Browser.document.removeEventListener("mousedown",c._makeMusicOK),c._musicAudio.src?c._musicAudio.play():(c._musicAudio.src="",c._musicAudio.load())}load(t){var e;if(t=n.URL.formatURL(t),this.url=t,t==u.ILaya.SoundManager._bgMusic?(c._initMusicAudio(),(e=c._musicAudio).src!=t&&(c._audioCache[e.src]=null,e=null)):e=c._audioCache[t],e&&e.readyState>=2)this.event(s.Event.COMPLETE);else{e||(t==u.ILaya.SoundManager._bgMusic?(c._initMusicAudio(),e=c._musicAudio):e=l.Browser.createElement("audio"),c._audioCache[t]=e,e.src=t),e.addEventListener("canplaythrough",r),e.addEventListener("error",a);var i=this;this.audio=e,e.load?e.load():a()}function r(){o(),i.loaded=!0,i.event(s.Event.COMPLETE)}function a(){e.load=null,o(),i.event(s.Event.ERROR)}function o(){e.removeEventListener("canplaythrough",r),e.removeEventListener("error",a)}}play(t=0,e=0){if(!this.url)return null;var i,s;if(!(i=this.url==u.ILaya.SoundManager._bgMusic?c._musicAudio:c._audioCache[this.url]))return null;s=h.Pool.getItem("audio:"+this.url),o.Render.isConchApp?s||((s=l.Browser.createElement("audio")).src=this.url):this.url==u.ILaya.SoundManager._bgMusic?(c._initMusicAudio(),(s=c._musicAudio).src=this.url):s=s||i.cloneNode(!0);var a=new r.AudioSoundChannel(s);return a.url=this.url,a.loops=e,a.startTime=t,a.play(),u.ILaya.SoundManager.addChannel(a),a}get duration(){var t;return(t=c._audioCache[this.url])?t.duration:0}}e.AudioSound=c,c._audioCache={}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(101),a=i(103),n=i(14),o=i(6),l=i(0);class h{static __init__(){var t=l.ILaya.Browser.window,e=!!(t.AudioContext||t.webkitAudioContext||t.mozAudioContext);return e&&a.WebAudioSound.initWebAudio(),h._soundClass=e?a.WebAudioSound:s.AudioSound,s.AudioSound._initMusicAudio(),h._musicClass=s.AudioSound,e}static addChannel(t){h._channels.indexOf(t)>=0||h._channels.push(t)}static removeChannel(t){var e;for(e=h._channels.length-1;e>=0;e--)h._channels[e]==t&&h._channels.splice(e,1)}static disposeSoundLater(t){h._lastSoundUsedTimeDic[t]=l.ILaya.Browser.now(),h._isCheckingDispose||(h._isCheckingDispose=!0,l.ILaya.timer.loop(5e3,null,h._checkDisposeSound))}static _checkDisposeSound(){var t,e=l.ILaya.Browser.now(),i=!1;for(t in h._lastSoundUsedTimeDic)e-h._lastSoundUsedTimeDic[t]>3e4?(delete h._lastSoundUsedTimeDic[t],h.disposeSoundIfNotUsed(t)):i=!0;i||(h._isCheckingDispose=!1,l.ILaya.timer.clear(null,h._checkDisposeSound))}static disposeSoundIfNotUsed(t){var e;for(e=h._channels.length-1;e>=0;e--)if(h._channels[e].url==t)return;h.destroySound(t)}static set autoStopMusic(t){l.ILaya.stage.off(r.Event.BLUR,null,h._stageOnBlur),l.ILaya.stage.off(r.Event.FOCUS,null,h._stageOnFocus),l.ILaya.stage.off(r.Event.VISIBILITY_CHANGE,null,h._visibilityChange),h._autoStopMusic=t,t&&(l.ILaya.stage.on(r.Event.BLUR,null,h._stageOnBlur),l.ILaya.stage.on(r.Event.FOCUS,null,h._stageOnFocus),l.ILaya.stage.on(r.Event.VISIBILITY_CHANGE,null,h._visibilityChange))}static get autoStopMusic(){return h._autoStopMusic}static _visibilityChange(){l.ILaya.stage.isVisibility?h._stageOnFocus():h._stageOnBlur()}static _stageOnBlur(){h._isActive=!1,h._musicChannel&&(h._musicChannel.isStopped||(h._blurPaused=!0,h._musicChannel.pause())),h.stopAllSound(),l.ILaya.stage.once(r.Event.MOUSE_DOWN,null,h._stageOnFocus)}static _recoverWebAudio(){a.WebAudioSound.ctx&&"running"!=a.WebAudioSound.ctx.state&&a.WebAudioSound.ctx.resume&&a.WebAudioSound.ctx.resume()}static _stageOnFocus(){h._isActive=!0,h._recoverWebAudio(),l.ILaya.stage.off(r.Event.MOUSE_DOWN,null,h._stageOnFocus),h._blurPaused&&h._musicChannel&&h._musicChannel.isStopped&&(h._blurPaused=!1,h._musicChannel.resume())}static set muted(t){t!=h._muted&&(t&&h.stopAllSound(),h.musicMuted=t,h._muted=t)}static get muted(){return h._muted}static set soundMuted(t){h._soundMuted=t}static get soundMuted(){return h._soundMuted}static set musicMuted(t){t!=h._musicMuted&&(t?(h._bgMusic&&h._musicChannel&&!h._musicChannel.isStopped?l.ILaya.Render.isConchApp?h._musicChannel._audio&&(h._musicChannel._audio.muted=!0):h._musicChannel.pause():h._musicChannel=null,h._musicMuted=t):(h._musicMuted=t,h._bgMusic&&h._musicChannel&&(l.ILaya.Render.isConchApp?h._musicChannel._audio&&(h._musicChannel._audio.muted=!1):h._musicChannel.resume())))}static get musicMuted(){return h._musicMuted}static get useAudioMusic(){return h._useAudioMusic}static set useAudioMusic(t){h._useAudioMusic=t,h._musicClass=t?s.AudioSound:null}static playSound(t,e=1,i=null,r=null,s=0){if(!h._isActive||!t)return null;if(h._muted)return null;if(h._recoverWebAudio(),(t=n.URL.formatURL(t))==h._bgMusic){if(h._musicMuted)return null}else{if(l.ILaya.Render.isConchApp){var a=o.Utils.getFileExtension(t);if("wav"!=a&&"ogg"!=a)return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),null}if(h._soundMuted)return null}var u,c;return l.ILaya.Browser.onBDMiniGame||l.ILaya.Browser.onMiniGame||l.ILaya.Browser.onKGMiniGame||l.ILaya.Browser.onQGMiniGame||l.ILaya.Browser.onVVMiniGame||l.ILaya.Browser.onAlipayMiniGame||l.ILaya.Browser.onQQMiniGame||(u=l.ILaya.loader.getRes(t)),r||(r=h._soundClass),u||((u=new r).load(t),l.ILaya.Browser.onBDMiniGame||l.ILaya.Browser.onMiniGame||l.ILaya.Browser.onKGMiniGame||l.ILaya.Browser.onQGMiniGame||l.ILaya.Browser.onVVMiniGame||l.ILaya.Browser.onAlipayMiniGame||l.ILaya.Browser.onQQMiniGame||l.ILaya.Loader.cacheRes(t,u)),(c=u.play(s,e))?(c.url=t,c.volume=t==h._bgMusic?h.musicVolume:h.soundVolume,c.completeHandler=i,c):null}static destroySound(t){var e=l.ILaya.loader.getRes(t);e&&(l.ILaya.Loader.clearRes(t),e.dispose())}static playMusic(t,e=0,i=null,r=0){return t=n.URL.formatURL(t),h._bgMusic=t,h._musicChannel&&h._musicChannel.stop(),h._musicChannel=h.playSound(t,e,i,h._musicClass,r)}static stopSound(t){var e,i;for(t=n.URL.formatURL(t),e=h._channels.length-1;e>=0;e--)(i=h._channels[e]).url==t&&i.stop()}static stopAll(){var t;for(h._bgMusic=null,t=h._channels.length-1;t>=0;t--)h._channels[t].stop()}static stopAllSound(){var t,e;for(t=h._channels.length-1;t>=0;t--)(e=h._channels[t]).url!=h._bgMusic&&e.stop()}static stopMusic(){h._musicChannel&&h._musicChannel.stop(),h._bgMusic=null}static setSoundVolume(t,e=null){var i,r;if(e)e=n.URL.formatURL(e),h._setVolume(e,t);else for(h.soundVolume=t,i=h._channels.length-1;i>=0;i--)(r=h._channels[i]).url!=h._bgMusic&&(r.volume=t)}static setMusicVolume(t){h.musicVolume=t,h._setVolume(h._bgMusic,t)}static _setVolume(t,e){var i,r;for(t=n.URL.formatURL(t),i=h._channels.length-1;i>=0;i--)(r=h._channels[i]).url==t&&(r.volume=e)}}e.SoundManager=h,h.musicVolume=1,h.soundVolume=1,h.playbackRate=1,h._useAudioMusic=!0,h._muted=!1,h._soundMuted=!1,h._musicMuted=!1,h._bgMusic=null,h._musicChannel=null,h._channels=[],h._blurPaused=!1,h._isActive=!0,h._lastSoundUsedTimeDic={},h._isCheckingDispose=!1,h.autoReleaseSound=!0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(158),s=i(2),a=i(12),n=i(14),o=i(0);class l extends a.EventDispatcher{constructor(){super(...arguments),this.loaded=!1,this._disposed=!1}static decode(){l.buffs.length<=0||l.isDecoding||(l.isDecoding=!0,l.tInfo=l.buffs.shift(),l.ctx.decodeAudioData(l.tInfo.buffer,l._done,l._fail))}static _done(t){l.e.event("loaded:"+l.tInfo.url,t),l.isDecoding=!1,l.decode()}static _fail(){l.e.event("err:"+l.tInfo.url,null),l.isDecoding=!1,l.decode()}static _playEmptySound(){if(null!=l.ctx){var t=l.ctx.createBufferSource();t.buffer=l._miniBuffer,t.connect(l.ctx.destination),t.start(0,0,0)}}static _unlock(){l._unlocked||(l._playEmptySound(),"running"==l.ctx.state&&(window.document.removeEventListener("mousedown",l._unlock,!0),window.document.removeEventListener("touchend",l._unlock,!0),window.document.removeEventListener("touchstart",l._unlock,!0),l._unlocked=!0))}static initWebAudio(){"running"!=l.ctx.state&&(l._unlock(),window.document.addEventListener("mousedown",l._unlock,!0),window.document.addEventListener("touchend",l._unlock,!0),window.document.addEventListener("touchstart",l._unlock,!0))}load(t){var e=this;if(t=n.URL.formatURL(t),this.url=t,this.audioBuffer=l._dataCache[t],this.audioBuffer)this._loaded(this.audioBuffer);else if(l.e.on("loaded:"+t,this,this._loaded),l.e.on("err:"+t,this,this._err),!l.__loadingSound[t]){l.__loadingSound[t]=!0;var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){e._disposed?e._removeLoadEvents():(e.data=i.response,l.buffs.push({buffer:e.data,url:e.url}),l.decode())},i.onerror=function(t){e._err()},i.send()}}_err(){this._removeLoadEvents(),l.__loadingSound[this.url]=!1,this.event(s.Event.ERROR)}_loaded(t){this._removeLoadEvents(),this._disposed||(this.audioBuffer=t,l._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event(s.Event.COMPLETE))}_removeLoadEvents(){l.e.off("loaded:"+this.url,this,this._loaded),l.e.off("err:"+this.url,this,this._err)}__playAfterLoaded(){if(this.__toPlays){var t,e,i,r;for(e=(i=this.__toPlays).length,t=0;t<e;t++)(r=i[t])[2]&&!r[2].isStopped&&this.play(r[0],r[1],r[2]);this.__toPlays.length=0}}play(t=0,e=0,i=null){return i=i||new r.WebAudioSoundChannel,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([t,e,i]),this.once(s.Event.COMPLETE,this,this.__playAfterLoaded),this.load(this.url)),i.url=this.url,i.loops=e,i.audioBuffer=this.audioBuffer,i.startTime=t,i.play(),o.ILaya.SoundManager.addChannel(i),i}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}dispose(){this._disposed=!0,delete l._dataCache[this.url],delete l.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]}}e.WebAudioSound=l,l._dataCache={},l.webAudioEnabled=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,l.ctx=l.webAudioEnabled?new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext):void 0,l.buffs=[],l.isDecoding=!1,l._miniBuffer=l.ctx?l.ctx.createBuffer(1,1,22050):void 0,l.e=new a.EventDispatcher,l._unlocked=!1,l.__loadingSound={}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(14),s=i(2),a=i(12),n=i(6),o=i(8);class l extends a.EventDispatcher{constructor(){super(...arguments),this._http=new XMLHttpRequest}send(t,e=null,i="get",s="text",a=null){this._responseType=s,this._data=null,(o.Browser.onVVMiniGame||o.Browser.onQGMiniGame||o.Browser.onQQMiniGame)&&(t=encodeURI(t)),this._url=t;var n=this,l=this._http;if(t=r.URL.getAdptedFilePath(t),l.open(i,t,!0),a)for(var h=0;h<a.length;h++)l.setRequestHeader(a[h++],a[h]);else window.conch||(e&&"string"!=typeof e?l.setRequestHeader("Content-Type","application/json"):l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));let u="arraybuffer"!==s?"text":"arraybuffer";l.responseType=u,l.dataType&&(l.dataType=u),l.onerror=function(t){n._onError(t)},l.onabort=function(t){n._onAbort(t)},l.onprogress=function(t){n._onProgress(t)},l.onload=function(t){n._onLoad(t)},l.send(e)}_onProgress(t){t&&t.lengthComputable&&this.event(s.Event.PROGRESS,t.loaded/t.total)}_onAbort(t){this.error("Request was aborted by user")}_onError(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)}_onLoad(t){var e=this._http,i=void 0!==e.status?e.status:200;200===i||204===i||0===i?this.complete():this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}error(t){this.clear(),console.warn(this.url,t),this.event(s.Event.ERROR,t)}complete(){this.clear();var t=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=n.Utils.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(e){t=!1,this.error(e.message)}t&&this.event(s.Event.COMPLETE,this._data instanceof Array?[this._data]:this._data)}clear(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null}get url(){return this._url}get data(){return this._data}get http(){return this._http}}e.HttpRequest=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static linearNone(t,e,i,r){return i*t/r+e}static linearIn(t,e,i,r){return i*t/r+e}static linearInOut(t,e,i,r){return i*t/r+e}static linearOut(t,e,i,r){return i*t/r+e}static bounceIn(t,e,i,s){return i-r.bounceOut(s-t,0,i,s)+e}static bounceInOut(t,e,i,s){return t<.5*s?.5*r.bounceIn(2*t,0,i,s)+e:.5*r.bounceOut(2*t-s,0,i,s)+.5*i+e}static bounceOut(t,e,i,r){return(t/=r)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}static backIn(t,e,i,r,s=1.70158){return i*(t/=r)*t*((s+1)*t-s)+e}static backInOut(t,e,i,r,s=1.70158){return(t/=.5*r)<1?.5*i*(t*t*((1+(s*=1.525))*t-s))+e:i/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+e}static backOut(t,e,i,r,s=1.70158){return i*((t=t/r-1)*t*((s+1)*t+s)+1)+e}static elasticIn(t,e,i,s,a=0,n=0){var o;return 0==t?e:1==(t/=s)?e+i:(n||(n=.3*s),!a||i>0&&a<i||i<0&&a<-i?(a=i,o=n/4):o=n/r.PI2*Math.asin(i/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t*s-o)*r.PI2/n)+e)}static elasticInOut(t,e,i,s,a=0,n=0){var o;return 0==t?e:2==(t/=.5*s)?e+i:(n||(n=s*(.3*1.5)),!a||i>0&&a<i||i<0&&a<-i?(a=i,o=n/4):o=n/r.PI2*Math.asin(i/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*s-o)*r.PI2/n)*-.5+e:a*Math.pow(2,-10*(t-=1))*Math.sin((t*s-o)*r.PI2/n)*.5+i+e)}static elasticOut(t,e,i,s,a=0,n=0){var o;return 0==t?e:1==(t/=s)?e+i:(n||(n=.3*s),!a||i>0&&a<i||i<0&&a<-i?(a=i,o=n/4):o=n/r.PI2*Math.asin(i/a),a*Math.pow(2,-10*t)*Math.sin((t*s-o)*r.PI2/n)+i+e)}static strongIn(t,e,i,r){return i*(t/=r)*t*t*t*t+e}static strongInOut(t,e,i,r){return(t/=.5*r)<1?.5*i*t*t*t*t*t+e:.5*i*((t-=2)*t*t*t*t+2)+e}static strongOut(t,e,i,r){return i*((t=t/r-1)*t*t*t*t+1)+e}static sineInOut(t,e,i,r){return.5*-i*(Math.cos(Math.PI*t/r)-1)+e}static sineIn(t,e,i,s){return-i*Math.cos(t/s*r.HALF_PI)+i+e}static sineOut(t,e,i,s){return i*Math.sin(t/s*r.HALF_PI)+e}static quintIn(t,e,i,r){return i*(t/=r)*t*t*t*t+e}static quintInOut(t,e,i,r){return(t/=.5*r)<1?.5*i*t*t*t*t*t+e:.5*i*((t-=2)*t*t*t*t+2)+e}static quintOut(t,e,i,r){return i*((t=t/r-1)*t*t*t*t+1)+e}static quartIn(t,e,i,r){return i*(t/=r)*t*t*t+e}static quartInOut(t,e,i,r){return(t/=.5*r)<1?.5*i*t*t*t*t+e:.5*-i*((t-=2)*t*t*t-2)+e}static quartOut(t,e,i,r){return-i*((t=t/r-1)*t*t*t-1)+e}static cubicIn(t,e,i,r){return i*(t/=r)*t*t+e}static cubicInOut(t,e,i,r){return(t/=.5*r)<1?.5*i*t*t*t+e:.5*i*((t-=2)*t*t+2)+e}static cubicOut(t,e,i,r){return i*((t=t/r-1)*t*t+1)+e}static quadIn(t,e,i,r){return i*(t/=r)*t+e}static quadInOut(t,e,i,r){return(t/=.5*r)<1?.5*i*t*t+e:.5*-i*(--t*(t-2)-1)+e}static quadOut(t,e,i,r){return-i*(t/=r)*(t-2)+e}static expoIn(t,e,i,r){return 0==t?e:i*Math.pow(2,10*(t/r-1))+e-.001*i}static expoInOut(t,e,i,r){return 0==t?e:t==r?e+i:(t/=.5*r)<1?.5*i*Math.pow(2,10*(t-1))+e:.5*i*(2-Math.pow(2,-10*--t))+e}static expoOut(t,e,i,r){return t==r?e+i:i*(1-Math.pow(2,-10*t/r))+e}static circIn(t,e,i,r){return-i*(Math.sqrt(1-(t/=r)*t)-1)+e}static circInOut(t,e,i,r){return(t/=.5*r)<1?.5*-i*(Math.sqrt(1-t*t)-1)+e:.5*i*(Math.sqrt(1-(t-=2)*t)+1)+e}static circOut(t,e,i,r){return i*Math.sqrt(1-(t=t/r-1)*t)+e}}e.Ease=r,r.HALF_PI=.5*Math.PI,r.PI2=2*Math.PI},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1),s=i(6);class a{constructor(){this._id=s.Utils.getGID(),this._resetComp()}get id(){return this._id}get enabled(){return this._enabled}set enabled(t){this._enabled!=t&&(this._enabled=t,this.owner&&(t?this.owner.activeInHierarchy&&this._onEnable():this.owner.activeInHierarchy&&this._onDisable()))}get isSingleton(){return!0}get destroyed(){return this._destroyed}_isScript(){return!1}_resetComp(){this._indexInList=-1,this._enabled=!0,this._awaked=!1,this.owner=null}_getIndexInList(){return this._indexInList}_setIndexInList(t){this._indexInList=t}_onAdded(){}_onAwake(){}_onEnable(){}_onDisable(){}_onDestroy(){}onReset(){}_parse(t){}_cloneTo(t){}_setActive(t){t?(this._awaked||(this._awaked=!0,this._onAwake()),this._enabled&&this._onEnable()):this._enabled&&this._onDisable()}destroy(){this.owner&&this.owner._destroyComponent(this)}_destroy(){this.owner.activeInHierarchy&&this._enabled&&this._setActive(!1),this._onDestroy(),this._destroyed=!0,this.onReset!==a.prototype.onReset?(this.onReset(),this._resetComp(),r.Pool.recoverByClass(this)):this._resetComp()}}e.Component=a},function(t,e,i){"use strict";t.exports=i(185)},function(t,e,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function n(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,o,l=n(t),h=1;h<arguments.length;h++){for(var u in i=Object(arguments[h]))s.call(i,u)&&(l[u]=i[u]);if(r){o=r(i);for(var c=0;c<o.length;c++)a.call(i,o[c])&&(l[o[c]]=i[o[c]])}}return l}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(194),s=i(195),a=i(110),n=i(28),o=i(2),l=i(0),h=i(9);class u extends n.Sprite{constructor(t=!0){super(),this._anchorX=NaN,this._anchorY=NaN,this._widget=r.Widget.EMPTY,t&&(this.preinitialize(),this.createChildren(),this.initialize())}destroy(t=!0){super.destroy(t),this._dataSource=null,this._tag=null,this._toolTip=null}preinitialize(){}createChildren(){}initialize(){}get width(){return this.get_width()}get_width(){return this._width?this._width:this.measureWidth()}measureWidth(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._x+i.width*i.scaleX,t))}return t}commitMeasure(){}get height(){return this.get_height()}get_height(){return this._height?this._height:this.measureHeight()}measureHeight(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._y+i.height*i.scaleY,t))}return t}get dataSource(){return this.get_dataSource()}get_dataSource(){return this._dataSource}set dataSource(t){this.set_dataSource(t)}set_dataSource(t){for(var e in this._dataSource=t,this._dataSource)e in this&&"function"!=typeof this[e]&&(this[e]=this._dataSource[e])}get top(){return this.get_top()}get_top(){return this._widget.top}set top(t){this.set_top(t)}set_top(t){t!=this._widget.top&&(this._getWidget().top=t)}get bottom(){return this.get_bottom()}get_bottom(){return this._widget.bottom}set bottom(t){this.set_bottom(t)}set_bottom(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}get left(){return this._widget.left}set left(t){t!=this._widget.left&&(this._getWidget().left=t)}get right(){return this._widget.right}set right(t){t!=this._widget.right&&(this._getWidget().right=t)}get centerX(){return this._widget.centerX}set centerX(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}get centerY(){return this._widget.centerY}set centerY(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}_sizeChanged(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(o.Event.RESIZE),this._widget!==r.Widget.EMPTY&&this._widget.resetLayout()}get tag(){return this._tag}set tag(t){this._tag=t}get toolTip(){return this._toolTip}set toolTip(t){this._toolTip!=t&&(this._toolTip=t,null!=t?(this.on(o.Event.MOUSE_OVER,this,this.onMouseOver),this.on(o.Event.MOUSE_OUT,this,this.onMouseOut)):(this.off(o.Event.MOUSE_OVER,this,this.onMouseOver),this.off(o.Event.MOUSE_OUT,this,this.onMouseOut)))}onMouseOver(t){l.ILaya.stage.event(s.UIEvent.SHOW_TIP,this._toolTip)}onMouseOut(t){l.ILaya.stage.event(s.UIEvent.HIDE_TIP,this._toolTip)}get gray(){return this._gray}set gray(t){t!==this._gray&&(this._gray=t,a.UIUtils.gray(this,t))}get disabled(){return this._disabled}set disabled(t){t!==this._disabled&&(this.gray=this._disabled=t,this.mouseEnabled=!t)}_getWidget(){return this._widget===r.Widget.EMPTY&&(this._widget=this.addComponent(r.Widget)),this._widget}set scaleX(t){this.set_scaleX(t)}set_scaleX(t){super.get_scaleX()!=t&&(super.set_scaleX(t),this.event(o.Event.RESIZE))}get scaleX(){return super.scaleX}set scaleY(t){this.set_scaleY(t)}set_scaleY(t){super.get_scaleY()!=t&&(super.set_scaleY(t),this.event(o.Event.RESIZE))}get scaleY(){return super.scaleY}onCompResize(){this._sizeChanged()}set width(t){this.set_width(t)}set_width(t){super.get_width()!=t&&(super.set_width(t),this.callLater(this._sizeChanged))}set height(t){this.set_height(t)}set_height(t){super.get_height()!=t&&(super.set_height(t),this.callLater(this._sizeChanged))}get anchorX(){return this.get_anchorX()}get_anchorX(){return this._anchorX}set anchorX(t){this.set_anchorX(t)}set_anchorX(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}get anchorY(){return this.get_anchorY()}get_anchorY(){return this._anchorY}set anchorY(t){this.set_anchorY(t)}set_anchorY(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}_childChanged(t=null){this.callLater(this._sizeChanged),super._childChanged(t)}}e.UIComponent=u,l.ILaya.regClass(u),h.ClassUtils.regClass("laya.ui.UIComponent",u),h.ClassUtils.regClass("Laya.UIComponent",u)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(37),s=i(6),a=i(60),n=i(9);class o{static fillArray(t,e,i=null){var r=t.concat();if(e)for(var s=e.split(","),a=0,n=Math.min(r.length,s.length);a<n;a++){var o=s[a];r[a]="true"==o||"false"!=o&&o,null!=i&&(r[a]=i(o))}return r}static toColor(t){return s.Utils.toHexColor(t)}static gray(t,e=!0){e?o.addFilter(t,o.grayFilter):o.clearFilter(t,r.ColorFilter)}static addFilter(t,e){var i=t.filters||[];i.push(e),t.filters=i}static clearFilter(t,e){var i=t.filters;if(null!=i&&i.length>0){for(var r=i.length-1;r>-1;r--){i[r]instanceof e&&i.splice(r,1)}t.filters=i}}static _getReplaceStr(t){return o.escapeSequence[t]}static adptString(t){return t.replace(/\\(\w)/g,o._getReplaceStr)}static getBindFun(t){o._funMap||(o._funMap=new a.WeakObject);var e=o._funMap.get(t);if(null==e){var i='"'+t+'"',r="(function(data){if(data==null)return;with(data){try{\nreturn "+(i=i.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";e=window.Laya._runScript(r),o._funMap.set(t,e)}return e}}e.UIUtils=o,o.grayFilter=new r.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]),o.escapeSequence={"\\n":"\n","\\t":"\t"},o._funMap=null,n.ClassUtils.regClass("laya.ui.UIUtils",o),n.ClassUtils.regClass("Laya.UIUtils",o)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Stage="Stage",e.Label="Label",e.Box="Box",e.Button="Button",e.HBox="HBox",e.VBox="VBox",e.Image="Image",e.Clip="Clip",e.ComboBox="ComboBox",e.Tab="Tab",e.HScrollBar="HScrollBar",e.HSlider="HSlider",e.List="List",e.RadioGroup="RadioGroup",e.Radio="Radio",e.Panel="Panel",e.ProgressBar="ProgressBar",e.TextInput="TextInput",e.Text="Text",e.Dialog="Dialog",e.FontClip="FontClip",e.Sprite="Sprite",e.TextArea="TextArea",e.HTMLDivElement="HTMLDivElement",e.Animation="Animation",e.Templet="Templet",e.Skeleton="Skeleton"},function(t,e,i){t.exports=i(113)},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(114),a=r(i(107)),n=i(186),o=i(111);class l extends a.default.Component{constructor(){super(...arguments),this.state={text:Date.now()},this.onButtonClick=()=>{this.setState(()=>({text:Date.now()}))}}render(){return a.default.createElement(o.Label,{text:"hello world",color:"red",width:1e3,align:"center"})}}s.Laya.init(600,500),n.CustomRenderer.render(a.default.createElement(l,null),s.Laya.stage)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(43),a=i(61),n=i(56),o=i(57),l=i(28),h=i(154),u=i(36),c=i(156),_=i(58),d=i(3),f=i(101),p=i(102),m=i(103),g=i(29),v=i(162),y=i(164),x=i(165),T=i(14),b=i(25),E=i(97),C=i(33),S=i(42),R=i(38),w=i(24),M=i(8),L=i(96),I=i(9),A=i(20),P=i(166),D=i(1),B=i(168),O=i(15),F=i(172),N=i(174),U=i(6),k=i(60),G=i(11),W=i(175),Y=i(176),V=i(177),z=i(13),H=i(31),X=i(87),j=i(89),q=i(18),Q=i(178),K=i(55),$=i(7),Z=i(181),J=i(182),tt=i(53),et=i(183),it=i(49),rt=i(52),st=i(59),at=i(12),nt=i(16),ot=i(100),lt=i(4),ht=i(184),ut=i(2),ct=i(32);class _t{static __init(t){t.forEach((function(t){t.__init$&&t.__init$()}))}static init(t,i,...s){if(!_t._isinit){_t._isinit=!0,ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=_t._arrayBufferSlice),M.Browser.__init__();var a=M.Browser.mainCanvas=new S.HTMLCanvas(!0),o=a.source.style;if(o.position="absolute",o.top=o.left="0px",o.background="#000000",M.Browser.onKGMiniGame||M.Browser.onAlipayMiniGame||M.Browser.container.appendChild(a.source),M.Browser.canvas=new S.HTMLCanvas(!0),M.Browser.context=M.Browser.canvas.getContext("2d"),M.Browser.supportWebAudio=p.SoundManager.__init__(),M.Browser.supportLocalStorage=y.LocalStorage.__init__(),_t.systemTimer=new N.Timer(!1),e.systemTimer=N.Timer.gSysTimer=_t.systemTimer,_t.startTimer=new N.Timer(!1),_t.physicsTimer=new N.Timer(!1),_t.updateTimer=new N.Timer(!1),_t.lateTimer=new N.Timer(!1),_t.timer=new N.Timer(!1),e.startTimer=r.ILaya.startTimer=_t.startTimer,e.lateTimer=r.ILaya.lateTimer=_t.lateTimer,e.updateTimer=r.ILaya.updateTimer=_t.updateTimer,r.ILaya.systemTimer=_t.systemTimer,e.timer=r.ILaya.timer=_t.timer,e.physicsTimer=r.ILaya.physicsTimer=_t.physicsTimer,_t.loader=new v.LoaderManager,r.ILaya.Laya=_t,e.loader=r.ILaya.loader=_t.loader,k.WeakObject.__init__(),B.SceneUtils.__init(),J.Mouse.__init__(),K.WebGL.inner_enable(),s)for(var l=0,u=s.length;l<u;l++)s[l]&&s[l].enable&&s[l].enable();return r.ILaya.Render.isConchApp&&_t.enableNative(),_t.enableWebGLPlus(),L.CacheManger.beginCheck(),e.stage=_t.stage=new h.Stage,r.ILaya.stage=_t.stage,U.Utils.gStage=_t.stage,T.URL.rootPath=T.URL._basePath=_t._getUrlPath(),it.MeshQuadTexture.__int__(),tt.MeshVG.__init__(),rt.MeshTexture.__init__(),_t.render=new b.Render(0,0,M.Browser.mainCanvas),e.render=_t.render,_t.stage.size(t,i),window.stage=_t.stage,$.WebGLContext.__init__(),et.MeshParticle2D.__init__(),Q.ShaderCompile.__init__(),E.RenderSprite.__init__(),c.KeyBoardManager.__init__(),_.MouseManager.instance.__init__(_t.stage,b.Render.canvas),n.Input.__init__(),p.SoundManager.autoStopMusic=!0,O.Stat._StatRender=new F.StatUI,z.Value2D._initone(G.ShaderDefines2D.TEXTURE2D,V.TextureSV),z.Value2D._initone(G.ShaderDefines2D.TEXTURE2D|G.ShaderDefines2D.FILTERGLOW,V.TextureSV),z.Value2D._initone(G.ShaderDefines2D.PRIMITIVE,Y.PrimitiveSV),z.Value2D._initone(G.ShaderDefines2D.SKINMESH,W.SkinSV),b.Render.canvas}}static _getUrlPath(){var t=M.Browser.window.location,e=t.pathname;return e=":"==e.charAt(2)?e.substring(1):e,T.URL.getPath("file:"==t.protocol?e:t.protocol+"//"+t.host+t.pathname)}static _arrayBufferSlice(t,e){var i=new Uint8Array(this,t,e-t),r=new Uint8Array(i.length);return r.set(i),r.buffer}static set alertGlobalError(t){var e=0;M.Browser.window.onerror=t?function(t,i,r,s,a){e++<5&&a&&this.alert("出错啦，请把此信息截图给研发商\n"+t+"\n"+a.stack)}:null}static _runScript(t){return M.Browser.window[_t._evcode](t)}static enableDebugPanel(t="libs/laya.debugtool.js"){if(window.Laya.DebugPanel)window.Laya.DebugPanel.enable();else{var e=M.Browser.createElement("script");e.onload=function(){window.Laya.DebugPanel.enable()},e.src=t,M.Browser.document.body.appendChild(e)}}static enableWebGLPlus(){$.WebGLContext.__init_native()}static enableNative(){_t.isNativeRender_enable||(_t.isNativeRender_enable=!0,H.Shader.prototype.uploadTexture2D=function(t){var e=d.LayaGL.instance;e.bindTexture(e.TEXTURE_2D,t)},q.RenderState2D.width=M.Browser.window.innerWidth,q.RenderState2D.height=M.Browser.window.innerHeight,M.Browser.measureText=function(t,e){return window.conchTextCanvas.font=e,window.conchTextCanvas.measureText(t)},h.Stage.clear=function(t){C.Context.set2DRenderConfig();var e=A.ColorUtils.create(t).arrColor,i=d.LayaGL.instance;e&&i.clearColor(e[0],e[1],e[2],e[3]),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT|i.STENCIL_BUFFER_BIT),q.RenderState2D.clear()},l.Sprite.drawToCanvas=l.Sprite.drawToTexture=function(t,e,i,r,s,a){s-=t.x,a-=t.y,s|=0,a|=0,i|=0,r|=0;var n=new S.HTMLCanvas(!1),o=n.getContext("2d");return n.size(i,r),o.asBitmap=!0,o._targets.start(),E.RenderSprite.renders[e]._fun(t,o,s,a),o.flush(),o._targets.end(),o._targets.restore(),n},Object.defineProperty(R.RenderTexture2D.prototype,"uv",{get:function(){return this._uv},set:function(t){this._uv=t}}),S.HTMLCanvas.prototype.getTexture=function(){return this._texture||(this._texture=this.context._targets,this._texture.uv=R.RenderTexture2D.flipyuv,this._texture.bitmap=this._texture),this._texture})}}e.Laya=_t,_t.stage=null,_t.systemTimer=null,_t.startTimer=null,_t.physicsTimer=null,_t.updateTimer=null,_t.lateTimer=null,_t.timer=null,_t.loader=null,_t.version="2.4.0beta",_t._isinit=!1,_t.isWXOpenDataContext=!1,_t.isWXPosMsg=!1,_t.__classmap=null,_t.Config=ct.Config,_t.TextRender=j.TextRender,_t.EventDispatcher=at.EventDispatcher,_t.SoundChannel=st.SoundChannel,_t.Stage=h.Stage,_t.Render=b.Render,_t.Browser=M.Browser,_t.Sprite=l.Sprite,_t.Node=o.Node,_t.Context=C.Context,_t.WebGL=K.WebGL,_t.Handler=nt.Handler,_t.RunDriver=ot.RunDriver,_t.Utils=U.Utils,_t.Input=n.Input,_t.Loader=g.Loader,_t.LocalStorage=y.LocalStorage,_t.SoundManager=p.SoundManager,_t.URL=T.URL,_t.Event=ut.Event,_t.Matrix=lt.Matrix,_t.HTMLImage=ht.HTMLImage,_t.Laya=_t,_t._evcode="eval",_t.isNativeRender_enable=!1,_t.__classmap=r.ILaya.__classMap,r.ILaya.Timer=N.Timer,r.ILaya.Dragging=P.Dragging,r.ILaya.GraphicsBounds=a.GraphicsBounds,r.ILaya.Sprite=l.Sprite,r.ILaya.TextRender=j.TextRender,r.ILaya.Loader=g.Loader,r.ILaya.TTFLoader=x.TTFLoader,r.ILaya.WebAudioSound=m.WebAudioSound,r.ILaya.SoundManager=p.SoundManager,r.ILaya.ShaderCompile=Q.ShaderCompile,r.ILaya.ClassUtils=I.ClassUtils,r.ILaya.SceneUtils=B.SceneUtils,r.ILaya.Context=C.Context,r.ILaya.Render=b.Render,r.ILaya.MouseManager=_.MouseManager,r.ILaya.Text=u.Text,r.ILaya.Browser=M.Browser,r.ILaya.WebGL=K.WebGL,r.ILaya.AudioSound=f.AudioSound,r.ILaya.Pool=D.Pool,r.ILaya.Utils=U.Utils,r.ILaya.Graphics=s.Graphics,r.ILaya.Submit=X.Submit,r.ILaya.Stage=h.Stage,r.ILaya.Resource=w.Resource,r.ILaya.WorkerLoader=Z.WorkerLoader;var dt=window._layalibs;if(dt){dt.sort((function(t,e){return t.i-e.i}));for(var ft=0;ft<dt.length;ft++)dt[ft].f(window,window.document,_t)}let pt=window;pt.Laya?(pt.Laya.Laya=_t,Object.assign(pt.Laya,_t)):pt.Laya=_t,e.__init=_t.__init,e.init=_t.init,e.version=_t.version,e.alertGlobalError=_t.alertGlobalError,e.enableDebugPanel=_t.enableDebugPanel,e._static=function(t,e){for(var i=0,r=e.length;i<r;i+=2)if("length"==e[i])t.length=e[i+1].call(t);else{function s(){var r=e[i],s=e[i+1];Object.defineProperty(t,r,{get:function(){return delete this[r],this[r]=s.call(this)},set:function(t){delete this[r],this[r]=t},enumerable:!0,configurable:!0})}s()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{constructor(t,e,i){this._value=0,this._name2int=t,this._int2name=e,this._int2nameMap=i}add(t){return this._value|="string"==typeof t?this._name2int[t]:t,this._value}addInt(t){return this._value|=t,this._value}remove(t){return this._value&="string"==typeof t?~this._name2int[t]:~t,this._value}isDefine(t){return(this._value&t)===t}getValue(){return this._value}setValue(t){this._value=t}toNameDic(){var t=this._int2nameMap[this._value];return t||r._toText(this._value,this._int2name,this._int2nameMap)}static _reg(t,e,i,r){i[t]=e,r[e]=t}static _toText(t,e,i){var r=i[t];if(r)return r;for(var s={},a=1,n=0;n<32&&!((a=1<<n)>t);n++)if(t&a){var o=e[a];o&&(s[o]="")}return i[t]=s,s}static _toInt(t,e){for(var i=t.split("."),r=0,s=0,a=i.length;s<a;s++){var n=e[i[s]];if(!n)throw new Error("Defines to int err:"+t+"/"+i[s]);r|=n}return r}}e.ShaderDefinesBase=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.StringKey=class{constructor(){this._strsToID={},this._idToStrs=[],this._length=0}add(t){var e=this._strsToID[t];return null!=e?e:(this._idToStrs[this._length]=t,this._strsToID[t]=this._length++)}getID(t){var e=this._strsToID[t];return null==e?-1:e}getName(t){var e=this._idToStrs[t];return null==e?void 0:e}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(31);class s extends r.Shader{constructor(t,e,i=null,r=null,s=null){super(t,e,i,r,s),this._params2dQuick2=null,this._shaderValueWidth=0,this._shaderValueHeight=0}_disposeResource(){super._disposeResource(),this._params2dQuick2=null}upload2dQuick2(t){this.upload(t,this._params2dQuick2||this._make2dQuick2())}_make2dQuick2(){if(!this._params2dQuick2){this._params2dQuick2=[];for(var t,e=this._params,i=0,r=e.length;i<r;i++)"size"!==(t=e[i]).name&&this._params2dQuick2.push(t)}return this._params2dQuick2}static create(t,e,i=null,r=null,a=null){return new s(t,e,i,r,a)}}e.Shader2X=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Path=class{constructor(){this._lastOriX=0,this._lastOriY=0,this.paths=[],this._curPath=null}beginPath(t){this.paths.length=1,this._curPath=this.paths[0]=new r,this._curPath.convex=t}closePath(){this._curPath.loop=!0}newPath(){this._curPath=new r,this.paths.push(this._curPath)}addPoint(t,e){this._curPath.path.push(t,e)}push(t,e){this._curPath?this._curPath.path.length>0&&(this._curPath=new r,this.paths.push(this._curPath)):(this._curPath=new r,this.paths.push(this._curPath));var i=this._curPath;i.path=t.slice(),i.convex=e}reset(){this.paths.length=0}};class r{constructor(){this.path=[],this.loop=!1,this.convex=!1}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(34),s=i(4),a=i(10);class n{constructor(){this._globalClipMatrix=new s.Matrix,this._clipInfoID=-1,this._clipRect=new a.Rectangle,this.incache=!1}isSaveMark(){return!1}restore(t){this._globalClipMatrix.copyTo(t._globalClipMatrix),this._clipRect.clone(t._clipRect),t._clipInfoID=this._clipInfoID,n.POOL[n.POOL._length++]=this,t._clipInCache=this.incache}static save(t){if((t._saveMark._saveuse&r.SaveBase.TYPE_CLIPRECT)!=r.SaveBase.TYPE_CLIPRECT){t._saveMark._saveuse|=r.SaveBase.TYPE_CLIPRECT;var e=n.POOL,i=e._length>0?e[--e._length]:new n;t._globalClipMatrix.copyTo(i._globalClipMatrix),t._clipRect.clone(i._clipRect),i._clipInfoID=t._clipInfoID,i.incache=t._clipInCache;var s=t._save;s[s._length++]=i}}}e.SaveClipRect=n,n.POOL=r.SaveBase._createArray()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(34);class s{constructor(){this._saveuse=0}isSaveMark(){return!0}restore(t){t._saveMark=this._preSaveMark,s.POOL[s.POOL._length++]=this}static Create(t){var e=s.POOL,i=e._length>0?e[--e._length]:new s;return i._saveuse=0,i._preSaveMark=t._saveMark,t._saveMark=i,i}}e.SaveMark=s,s.POOL=r.SaveBase._createArray()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(34),s=i(4);class a{constructor(){this._matrix=new s.Matrix}isSaveMark(){return!1}restore(t){t._curMat=this._savematrix,a.POOL[a.POOL._length++]=this}static save(t){var e=t._saveMark;if((e._saveuse&r.SaveBase.TYPE_TRANSFORM)!==r.SaveBase.TYPE_TRANSFORM){e._saveuse|=r.SaveBase.TYPE_TRANSFORM;var i=a.POOL,s=i._length>0?i[--i._length]:new a;s._savematrix=t._curMat,t._curMat=t._curMat.copyTo(s._matrix);var n=t._save;n[n._length++]=s}}}e.SaveTransform=a,a.POOL=r.SaveBase._createArray()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(34),s=i(4);class a{constructor(){this._mat=new s.Matrix}isSaveMark(){return!1}restore(t){this._mat.copyTo(t._curMat),a.POOL[a.POOL._length++]=this}static save(t){var e=a.POOL,i=e._length>0?e[--e._length]:new a;t._curMat.copyTo(i._mat);var r=t._save;r[r._length++]=i}}e.SaveTranslate=a,a.POOL=r.SaveBase._createArray()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(124);class s extends r.BufferStateBase{constructor(){super()}}e.BufferState2D=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3);class s{constructor(){this._nativeVertexArrayObject=r.LayaGL.layaGPUInstance.createVertexArray()}bind(){s._curBindedBufferState!==this&&(r.LayaGL.layaGPUInstance.bindVertexArray(this._nativeVertexArrayObject),s._curBindedBufferState=this)}unBind(){if(s._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";r.LayaGL.layaGPUInstance.bindVertexArray(null),s._curBindedBufferState=null}destroy(){r.LayaGL.layaGPUInstance.deleteVertexArray(this._nativeVertexArrayObject)}bindForNative(){r.LayaGL.instance.bindVertexArray(this._nativeVertexArrayObject),s._curBindedBufferState=this}unBindForNative(){r.LayaGL.instance.bindVertexArray(null),s._curBindedBufferState=null}}e.BufferStateBase=s},function(t,e){t.exports="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\nattribute vec4 posuv;\r\nattribute vec4 attribColor;\r\nattribute vec4 attribFlags;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\r\nvarying vec2 cliped;\r\nuniform vec2 size;\r\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\n#ifdef MVP3D\r\n\tuniform mat4 u_MvpMatrix;\r\n#endif\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\n\r\nvoid main() {\r\n\r\n\tvec4 pos = vec4(posuv.xy,0.,1.);\r\n#ifdef WORLDMAT\r\n\tpos=mmat*pos;\r\n#endif\r\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\r\n#ifdef MVP3D\r\n\tgl_Position=u_MvpMatrix*pos1;\r\n#else\r\n\tgl_Position=pos1;\r\n#endif\r\n\tv_texcoordAlpha.xy = posuv.zw;\r\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\r\n\tv_color = attribColor/255.0;\r\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\r\n\t\r\n\tv_useTex = attribFlags.r/255.0;\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\t\r\n\tvec2 clpos = clipMatPos.xy;\r\n\t#ifdef WORLDMAT\r\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\r\n\t\tif(clipOff[0]>0.0){\r\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\r\n\t\t\tclpos.y+=mmat[3].y;\t//ty\r\n\t\t}\r\n\t#endif\r\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n\r\n}"},function(t,e){t.exports="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\n#ifdef GL_FRAGMENT_PRECISION_HIGH\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\nuniform sampler2D texture;\r\nvarying vec2 cliped;\r\n\r\n#ifdef BLUR_FILTER\r\nuniform vec4 strength_sig2_2sig2_gauss1;\r\nuniform vec2 blurInfo;\r\n\r\n#define PI 3.141593\r\n\r\nfloat getGaussian(float x, float y){\r\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\r\n}\r\n\r\nvec4 blur(){\r\n    const float blurw = 9.0;\r\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \r\n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\r\n    vec2 ctexcoord = startpos;\r\n    vec2 step = 1.0/blurInfo;  //每个像素      \r\n    \r\n    for(float y = 0.0;y<=blurw; ++y){\r\n        ctexcoord.x=startpos.x;\r\n        for(float x = 0.0;x<=blurw; ++x){\r\n            //TODO 纹理坐标的固定偏移应该在vs中处理\r\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\r\n            ctexcoord.x+=step.x;\r\n        }\r\n        ctexcoord.y+=step.y;\r\n    }\r\n    return vec4Color;\r\n}\r\n#endif\r\n\r\n#ifdef COLOR_FILTER\r\nuniform vec4 colorAlpha;\r\nuniform mat4 colorMat;\r\n#endif\r\n\r\n#ifdef GLOW_FILTER\r\nuniform vec4 u_color;\r\nuniform vec4 u_blurInfo1;\r\nuniform vec4 u_blurInfo2;\r\n#endif\r\n\r\n#ifdef COLOR_ADD\r\nuniform vec4 colorAdd;\r\n#endif\r\n\r\n#ifdef FILLTEXTURE\t\r\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\r\n#endif\r\nvoid main() {\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n\t\r\n#ifdef FILLTEXTURE\t\r\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\r\n#else\r\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\r\n#endif\r\n\r\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\r\n   color.a*=v_color.w;\r\n   //color.rgb*=v_color.w;\r\n   color.rgb*=v_color.rgb;\r\n   gl_FragColor=color;\r\n   \r\n   #ifdef COLOR_ADD\r\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\r\n\tgl_FragColor.xyz *= colorAdd.a;\r\n   #endif\r\n   \r\n   #ifdef BLUR_FILTER\r\n\tgl_FragColor =   blur();\r\n\tgl_FragColor.w*=v_color.w;   \r\n   #endif\r\n   \r\n   #ifdef COLOR_FILTER\r\n\tmat4 alphaMat =colorMat;\r\n\r\n\talphaMat[0][3] *= gl_FragColor.a;\r\n\talphaMat[1][3] *= gl_FragColor.a;\r\n\talphaMat[2][3] *= gl_FragColor.a;\r\n\r\n\tgl_FragColor = gl_FragColor * alphaMat;\r\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\r\n   #endif\r\n   \r\n   #ifdef GLOW_FILTER\r\n\tconst float c_IterationTime = 10.0;\r\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\r\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\r\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\r\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\r\n\tvec2 vec2Off = vec2(0.0,0.0);\r\n\tfloat floatOff = c_IterationTime/2.0;\r\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\r\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\r\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\r\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\r\n\t\t}\r\n\t}\r\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\r\n\tgl_FragColor.rgb *= gl_FragColor.a;   \r\n   #endif\r\n   \r\n}"},function(t,e){t.exports="attribute vec4 position;\r\nattribute vec4 attribColor;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\nuniform mat4 u_mmat2;\r\n//uniform vec2 u_pos;\r\nuniform vec2 size;\r\nvarying vec4 color;\r\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\r\n//vec4 clip=vec4(100.,30.,300.,600.);\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t\r\n#ifdef WORLDMAT\r\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\r\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n#else\r\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\r\n#endif\t\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n  //pos2d.x = dot(clippos,dirx);\r\n  color=attribColor/255.;\r\n}"},function(t,e){t.exports="precision mediump float;\r\n//precision mediump float;\r\nvarying vec4 color;\r\n//uniform float alpha;\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\r\n\t//a.a*=alpha;\r\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\r\n\tgl_FragColor.rgb*=color.a;\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n}"},function(t,e){t.exports="attribute vec2 position;\r\nattribute vec2 texcoord;\r\nattribute vec4 color;\r\nuniform vec2 size;\r\nuniform float offsetX;\r\nuniform float offsetY;\r\nuniform mat4 mmat;\r\nuniform mat4 u_mmat2;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nvoid main() {\r\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\r\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n  v_color = color;\r\n  v_color.rgb *= v_color.a;\r\n  v_texcoord = texcoord;  \r\n}"},function(t,e){t.exports="precision mediump float;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nuniform sampler2D texture;\r\nuniform float alpha;\r\nvoid main() {\r\n\tvec4 t_color = texture2D(texture, v_texcoord);\r\n\tgl_FragColor = t_color.rgba * v_color;\r\n\tgl_FragColor *= alpha;\r\n}"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(84),s=i(85),a=i(3);class n{constructor(){var t=a.LayaGL.instance;this.ib=r.IndexBuffer2D.create(t.DYNAMIC_DRAW),this.vb=s.VertexBuffer2D.create(8)}static getInstance(){return n.instance=n.instance||new n}addSkinMesh(t){t.getData2(this.vb,this.ib,this.vb._byteLength/32)}reset(){this.vb.clear(),this.ib.clear()}}e.SkinMeshBuffer=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static createLine2(t,e,i,s,a,n){if(t.length<4)return null;var o=r.tempData.length>t.length+2?r.tempData:new Array(t.length+2);o[0]=t[0],o[1]=t[1];var l=2,h=0,u=t.length;for(h=2;h<u;h+=2)Math.abs(t[h]-t[h-2])+Math.abs(t[h+1]-t[h-1])>.01&&(o[l++]=t[h],o[l++]=t[h+1]);n&&Math.abs(t[0]-o[l-2])+Math.abs(t[1]-o[l-1])>.01&&(o[l++]=t[0],o[l++]=t[1]);var c=a;u=l/2;var _,d,f,p,m,g,v,y,x,T,b,E,C,S,R,w,M,L,I,A,P=i/2;for(f=o[0],p=o[1],T=f-(m=o[2]),x=(x=-(p-(g=o[3])))/(A=Math.sqrt(x*x+T*T))*P,T=T/A*P,c.push(f-x,p-T,f+x,p+T),h=1;h<u-1;h++)f=o[2*(h-1)],p=o[2*(h-1)+1],m=o[2*h],g=o[2*h+1],v=o[2*(h+1)],y=o[2*(h+1)+1],T=f-m,E=m-v,R=(-(x=(x=-(p-g))/(A=Math.sqrt(x*x+T*T))*P)+f)*(-(T=T/A*P)+g)-(-x+m)*(-T+p),L=(-(b=(b=-(g-y))/(A=Math.sqrt(b*b+E*E))*P)+v)*(-(E=E/A*P)+g)-(-b+m)*(-E+y),I=(C=-T+p-(-T+g))*(M=-b+m-(-b+v))-(w=-E+y-(-E+g))*(S=-x+m-(-x+f)),Math.abs(I)<.1?(I+=10.1,c.push(m-x,g-T,m+x,g+T)):(((_=(S*L-M*R)/I)-m)*(_-m)+((d=(w*R-C*L)/I)-g)+(d-g),c.push(_,d,m-(_-m),g-(d-g)));for(f=o[l-4],p=o[l-3],T=f-(m=o[l-2]),x=(x=-(p-(g=o[l-1])))/(A=Math.sqrt(x*x+T*T))*P,T=T/A*P,c.push(m-x,g-T,m+x,g+T),h=1;h<u;h++)e.push(s+2*(h-1),s+2*(h-1)+1,s+2*h+1,s+2*h+1,s+2*h,s+2*(h-1));return c}static createLineTriangle(t,e,i,r,s,a,n){var o=t.slice(),l=o.length,h=o[0],u=o[1],c=o[2],_=(o[2],0),d=0,f=0,p=0,m=l/2;if(!(m<=1)&&2!=m){for(var g=new Array(4*m),v=0,y=0,x=0;x<m-1;x++)h=o[y++],u=o[y++],c=o[y++],p=o[y++]-u,0!=(f=c-h)&&0!=p&&(_=Math.sqrt(f*f+p*p))>.001&&(g[d=4*v]=h,g[d+1]=u,g[d+2]=f/_,g[d+3]=p/_,v++);for(r?(h=o[l-2],u=o[l-1],c=o[0],p=o[1]-u,0!=(f=c-h)&&0!=p&&(_=Math.sqrt(f*f+p*p))>.001&&(g[d=4*v]=h,g[d+1]=u,g[d+2]=f/_,g[d+3]=p/_,v++)):(g[d=4*v]=h,g[d+1]=u,g[d+2]=f/_,g[d+3]=p/_,v++),y=0,x=0;x<m;x++)h=o[y],u=o[y+1],c=o[y+2],o[y+3]}}}e.BasePoly=r,r.tempData=new Array(256)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(134);class s{static earcut(t,e,i){i=i||2;var r,a,n,o,l,h,u,c=e&&e.length,_=c?e[0]*i:t.length,d=s.linkedList(t,0,_,i,!0),f=[];if(!d)return f;if(c&&(d=s.eliminateHoles(t,e,d,i)),t.length>80*i){r=n=t[0],a=o=t[1];for(var p=i;p<_;p+=i)(l=t[p])<r&&(r=l),(h=t[p+1])<a&&(a=h),l>n&&(n=l),h>o&&(o=h);u=0!==(u=Math.max(n-r,o-a))?1/u:0}return s.earcutLinked(d,f,i,r,a,u),f}static linkedList(t,e,i,r,a){var n,o;if(a===s.signedArea(t,e,i,r)>0)for(n=e;n<i;n+=r)o=s.insertNode(n,t[n],t[n+1],o);else for(n=i-r;n>=e;n-=r)o=s.insertNode(n,t[n],t[n+1],o);return o&&s.equals(o,o.next)&&(s.removeNode(o),o=o.next),o}static filterPoints(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!s.equals(r,r.next)&&0!==s.area(r.prev,r,r.next))r=r.next;else{if(s.removeNode(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}static earcutLinked(t,e,i,r,a,n,o=null){if(t){!o&&n&&s.indexCurve(t,r,a,n);for(var l,h,u=t;t.prev!==t.next;)if(l=t.prev,h=t.next,n?s.isEarHashed(t,r,a,n):s.isEar(t))e.push(l.i/i),e.push(t.i/i),e.push(h.i/i),s.removeNode(t),t=h.next,u=h.next;else if((t=h)===u){o?1===o?(t=s.cureLocalIntersections(t,e,i),s.earcutLinked(t,e,i,r,a,n,2)):2===o&&s.splitEarcut(t,e,i,r,a,n):s.earcutLinked(s.filterPoints(t,null),e,i,r,a,n,1);break}}}static isEar(t){var e=t.prev,i=t,r=t.next;if(s.area(e,i,r)>=0)return!1;for(var a=t.next.next;a!==t.prev;){if(s.pointInTriangle(e.x,e.y,i.x,i.y,r.x,r.y,a.x,a.y)&&s.area(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}static isEarHashed(t,e,i,r){var a=t.prev,n=t,o=t.next;if(s.area(a,n,o)>=0)return!1;for(var l=a.x<n.x?a.x<o.x?a.x:o.x:n.x<o.x?n.x:o.x,h=a.y<n.y?a.y<o.y?a.y:o.y:n.y<o.y?n.y:o.y,u=a.x>n.x?a.x>o.x?a.x:o.x:n.x>o.x?n.x:o.x,c=a.y>n.y?a.y>o.y?a.y:o.y:n.y>o.y?n.y:o.y,_=s.zOrder(l,h,e,i,r),d=s.zOrder(u,c,e,i,r),f=t.nextZ;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&s.pointInTriangle(a.x,a.y,n.x,n.y,o.x,o.y,f.x,f.y)&&s.area(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=_;){if(f!==t.prev&&f!==t.next&&s.pointInTriangle(a.x,a.y,n.x,n.y,o.x,o.y,f.x,f.y)&&s.area(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}static cureLocalIntersections(t,e,i){var r=t;do{var a=r.prev,n=r.next.next;!s.equals(a,n)&&s.intersects(a,r,r.next,n)&&s.locallyInside(a,n)&&s.locallyInside(n,a)&&(e.push(a.i/i),e.push(r.i/i),e.push(n.i/i),s.removeNode(r),s.removeNode(r.next),r=t=n),r=r.next}while(r!==t);return r}static splitEarcut(t,e,i,r,a,n){var o=t;do{for(var l=o.next.next;l!==o.prev;){if(o.i!==l.i&&s.isValidDiagonal(o,l)){var h=s.splitPolygon(o,l);return o=s.filterPoints(o,o.next),h=s.filterPoints(h,h.next),s.earcutLinked(o,e,i,r,a,n),void s.earcutLinked(h,e,i,r,a,n)}l=l.next}o=o.next}while(o!==t)}static eliminateHoles(t,e,i,r){var a,n,o,l,h,u=[];for(a=0,n=e.length;a<n;a++)o=e[a]*r,l=a<n-1?e[a+1]*r:t.length,(h=s.linkedList(t,o,l,r,!1))===h.next&&(h.steiner=!0),u.push(s.getLeftmost(h));for(u.sort(s.compareX),a=0;a<u.length;a++)s.eliminateHole(u[a],i),i=s.filterPoints(i,i.next);return i}static compareX(t,e){return t.x-e.x}static eliminateHole(t,e){if(e=s.findHoleBridge(t,e)){var i=s.splitPolygon(e,t);s.filterPoints(i,i.next)}}static findHoleBridge(t,e){var i,r=e,a=t.x,n=t.y,o=-1/0;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var l=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(l<=a&&l>o){if(o=l,l===a){if(n===r.y)return r;if(n===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(a===o)return i.prev;var h,u=i,c=i.x,_=i.y,d=1/0;for(r=i.next;r!==u;)a>=r.x&&r.x>=c&&a!==r.x&&s.pointInTriangle(n<_?a:o,n,c,_,n<_?o:a,n,r.x,r.y)&&((h=Math.abs(n-r.y)/(a-r.x))<d||h===d&&r.x>i.x)&&s.locallyInside(r,t)&&(i=r,d=h),r=r.next;return i}static indexCurve(t,e,i,r){var a=t;do{null===a.z&&(a.z=s.zOrder(a.x,a.y,e,i,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==t);a.prevZ.nextZ=null,a.prevZ=null,s.sortLinked(a)}static sortLinked(t){var e,i,r,s,a,n,o,l,h=1;do{for(i=t,t=null,a=null,n=0;i;){for(n++,r=i,o=0,e=0;e<h&&(o++,r=r.nextZ);e++);for(l=h;o>0||l>0&&r;)0!==o&&(0===l||!r||i.z<=r.z)?(s=i,i=i.nextZ,o--):(s=r,r=r.nextZ,l--),a?a.nextZ=s:t=s,s.prevZ=a,a=s;i=r}a.nextZ=null,h*=2}while(n>1);return t}static zOrder(t,e,i,r,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}static getLeftmost(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}static pointInTriangle(t,e,i,r,s,a,n,o){return(s-n)*(e-o)-(t-n)*(a-o)>=0&&(t-n)*(r-o)-(i-n)*(e-o)>=0&&(i-n)*(a-o)-(s-n)*(r-o)>=0}static isValidDiagonal(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!s.intersectsPolygon(t,e)&&s.locallyInside(t,e)&&s.locallyInside(e,t)&&s.middleInside(t,e)}static area(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}static equals(t,e){return t.x===e.x&&t.y===e.y}static intersects(t,e,i,r){return!!(s.equals(t,e)&&s.equals(i,r)||s.equals(t,r)&&s.equals(i,e))||s.area(t,e,i)>0!=s.area(t,e,r)>0&&s.area(i,r,t)>0!=s.area(i,r,e)>0}static intersectsPolygon(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&s.intersects(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}static locallyInside(t,e){return s.area(t.prev,t,t.next)<0?s.area(t,e,t.next)>=0&&s.area(t,t.prev,e)>=0:s.area(t,e,t.prev)<0||s.area(t,t.next,e)<0}static middleInside(t,e){var i=t,r=!1,s=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&s<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}static splitPolygon(t,e){var i=new r.EarcutNode(t.i,t.x,t.y),s=new r.EarcutNode(e.i,e.x,e.y),a=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=a,a.prev=i,s.next=i,i.prev=s,n.next=s,s.prev=n,s}static insertNode(t,e,i,s){var a=new r.EarcutNode(t,e,i);return s?(a.next=s.next,a.prev=s,s.next.prev=a,s.next=a):(a.prev=a,a.next=a),a}static removeNode(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}static signedArea(t,e,i,r){for(var s=0,a=e,n=i-r;a<i;a+=r)s+=(t[n]-t[a])*(t[a+1]+t[n+1]),n=a;return s}}e.Earcut=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.EarcutNode=class{constructor(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(4),s=i(13),a=i(35),n=i(18),o=i(21);class l extends o.SubmitBase{constructor(){super(o.SubmitBase.TYPE_2D),this._matrix=new r.Matrix,this._matrix4=a.CONST3D2D.defaultMatrix4.concat(),this.shaderValue=new s.Value2D(0,0)}static create(t,e,i){var r=l.POOL._length?l.POOL[--l.POOL._length]:new l;r.canv=t,r._ref=1,r._numEle=0;var s=r.shaderValue;return s.alpha=e,s.defines.setValue(0),i&&i.length&&s.setFilters(i),r}renderSubmit(){var t=n.RenderState2D.worldAlpha,e=n.RenderState2D.worldMatrix4,i=n.RenderState2D.worldMatrix,s=n.RenderState2D.worldFilters,a=n.RenderState2D.worldShaderDefines,o=this.shaderValue,l=this._matrix,h=this._matrix4,u=r.Matrix.TEMP;return r.Matrix.mul(l,i,u),h[0]=u.a,h[1]=u.b,h[4]=u.c,h[5]=u.d,h[12]=u.tx,h[13]=u.ty,n.RenderState2D.worldMatrix=u.clone(),n.RenderState2D.worldMatrix4=h,n.RenderState2D.worldAlpha=n.RenderState2D.worldAlpha*o.alpha,o.filters&&o.filters.length&&(n.RenderState2D.worldFilters=o.filters,n.RenderState2D.worldShaderDefines=o.defines),this.canv.flushsubmit(),n.RenderState2D.worldAlpha=t,n.RenderState2D.worldMatrix4=e,n.RenderState2D.worldMatrix.destroy(),n.RenderState2D.worldMatrix=i,n.RenderState2D.worldFilters=s,n.RenderState2D.worldShaderDefines=a,1}releaseRender(){if(--this._ref<1){var t=l.POOL;this._mesh=null,t[t._length++]=this}}getRenderType(){return o.SubmitBase.TYPE_CANVAS}}e.SubmitCanvas=l,l.POOL=[],l.POOL._length=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(40),s=i(15),a=i(7),n=i(19),o=i(35);class l{constructor(){this.blendType=0,this._ref=1,this._key=new r.SubmitKey}renderSubmit(){var t=a.WebGLContext.mainContext;this._mesh.useMesh(t);var e=this.srcRT;return e&&(this.shaderValue.texture=e._getSource(),this.shaderValue.upload(),this.blend(),s.Stat.renderBatches++,s.Stat.trianglesFaces+=this._numEle/3,t.drawElements(t.TRIANGLES,this._numEle,t.UNSIGNED_SHORT,this._startIdx)),1}blend(){if(n.BlendMode.activeBlendFunction!==n.BlendMode.fns[this.blendType]){var t=a.WebGLContext.mainContext;t.enable(t.BLEND),n.BlendMode.fns[this.blendType](t),n.BlendMode.activeBlendFunction=n.BlendMode.fns[this.blendType]}}getRenderType(){return 0}releaseRender(){if(--this._ref<1){var t=l.POOL;t[t._length++]=this}}static create(t,e,i,r){var s=l.POOL._length?l.POOL[--l.POOL._length]:new l;if(s._mesh=e,s.srcRT=r,s._startIdx=e.indexNum*o.CONST3D2D.BYTES_PIDX,s._ref=1,s._key.clear(),s._numEle=0,s.blendType=t._nBlendType,s._key.blendShader=s.blendType,s.shaderValue=i,s.shaderValue.setValue(t._shader2D),t._colorFiler){var a=t._colorFiler;i.defines.add(a.type),i.colorMat=a._mat,i.colorAlpha=a._alpha}return s}}e.SubmitTarget=l,l.POOL=[],l.POOL._length=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(4),s=i(11),a=i(13),n=i(88),o=i(26);class l{constructor(){this._data=[],this._ndata=0,this._clipid=-1,this._clipMatrix=new r.Matrix,this._enable=!1}clear(){this._tex=null,this._imgId=-1,this._ndata=0,this._enable=!1,this._colorFiler=null}destroy(){this.clear(),this._data.length=0,this._data=null}add(t,e,i,r,s,a){this._ndata>0&&(this._tex!=e||this._imgId!=i||this._clipid>=0&&this._clipid!=t._clipInfoID)&&this.submit(t),this._clipid=t._clipInfoID,t._globalClipMatrix.copyTo(this._clipMatrix),this._tex=e,this._imgId=i,this._colorFiler=t._colorFiler,this._data[this._ndata]=r,this._data[this._ndata+1]=s,this._data[this._ndata+2]=a,this._ndata+=3}getPos(){return 0==l.__nPosPool?new Array(8):l.__posPool[--l.__nPosPool]}enable(t,e){t!==this._enable&&(this._enable=t,this._enable||this.submit(e))}submit(t){var e=this._ndata;if(e){var i=t._mesh,r=t._colorFiler;t._colorFiler=this._colorFiler;var h=n.SubmitTexture.create(t,i,a.Value2D.create(s.ShaderDefines2D.TEXTURE2D,0));t._submits[t._submits._length++]=t._curSubmit=h,h.shaderValue.textureHost=this._tex,h._key.other=this._imgId,t._colorFiler=r,t._copyClipInfo(h,this._clipMatrix),h.clipInfoID=this._clipid;for(var u=0;u<e;u+=3)i.addQuad(this._data[u],this._data[u+1],this._data[u+2],!0),l.__posPool[l.__nPosPool++]=this._data[u];e/=3,h._numEle+=6*e,i.indexNum+=6*e,i.vertNum+=4*e,t._drawCount+=e,this._ndata=0,o.RenderInfo.loopCount%100==0&&(this._data.length=0)}}}e.CharSubmitCache=l,l.__posPool=[],l.__nPosPool=0},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(139),s=i(90),a=i(0);class n{constructor(){this.texWidth=1024,this.texHeight=1024,this.texture=null,this.charMaps={},this.texHeight=this.texWidth=a.ILaya.TextRender.atlasWidth,this.texture=s.TextTexture.getTextTexture(this.texWidth,this.texHeight),this.texWidth/n.atlasGridW>256&&(n.atlasGridW=Math.ceil(this.texWidth/256)),this.atlasgrid=new r.AtlasGrid(this.texWidth/n.atlasGridW,this.texHeight/n.atlasGridW,this.texture.id)}setProtecteDist(t){}getAEmpty(t,e,i){var r=this.atlasgrid.addRect(1,Math.ceil(t/n.atlasGridW),Math.ceil(e/n.atlasGridW),i);return r&&(i.x*=n.atlasGridW,i.y*=n.atlasGridW),r}get usedRate(){return this.atlasgrid._used}destroy(){for(var t in this.charMaps){this.charMaps[t].deleted=!0}this.texture.discard()}printDebugInfo(){}}e.TextAtlas=n,n.atlasGridW=16},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.AtlasGrid=class{constructor(t=0,e=0,i=0){this.atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._used=0,this._cells=null,this._rowInfo=null,this.atlasID=i,this._init(t,e)}addRect(t,e,i,r){return!!this._get(e,i,r)&&(this._fill(r.x,r.y,e,i,t),this._texCount++,!0)}_release(){this._cells=null,this._rowInfo=null}_init(t,e){return this._width=t,this._height=e,this._release(),0!=this._width&&(this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=new Uint8Array(this._height),this._used=0,this._clear(),!0)}_get(t,e,i){if(t>this._width||e>this._height)return!1;for(var r=-1,s=-1,a=this._width,n=this._height,o=this._cells,l=0;l<n;l++)if(!(this._rowInfo[l]<t))for(var h=0;h<a;){var u=3*(l*a+h);if(0!=o[u]||o[u+1]<t||o[u+2]<e)h+=o[u+1];else{r=h,s=l;for(var c=0;c<t;c++)if(o[3*c+u+2]<e){r=-1;break}if(!(r<0))return i.x=r,i.y=s,!0;h+=o[u+1]}}return!1}_fill(t,e,i,r,s){var a=this._width,n=this._height;this._check(t+i<=a&&e+r<=n);for(var o=e;o<r+e;++o){this._check(this._rowInfo[o]>=i),this._rowInfo[o]-=i;for(var l=0;l<i;l++){var h=3*(t+o*a+l);this._check(0==this._cells[h]),this._cells[h]=s,this._cells[h+1]=i,this._cells[h+2]=r}}if(t>0)for(o=0;o<r;++o){var u=0;for(l=t-1;l>=0&&0==this._cells[3*((e+o)*a+l)];--l,++u);for(l=u;l>0;--l)this._cells[3*((e+o)*a+t-l)+1]=l,this._check(l>0)}if(e>0)for(l=t;l<t+i;++l){for(u=0,o=e-1;o>=0&&0==this._cells[3*(l+o*a)];--o,u++);for(o=u;o>0;--o)this._cells[3*(l+(e-o)*a)+2]=o,this._check(o>0)}this._used+=i*r/(this._width*this._height)}_check(t){0==t&&console.log("xtexMerger 错误啦")}_clear(){this._texCount=0;for(var t=0;t<this._height;t++)this._rowInfo[t]=this._width;for(var e=0;e<this._height;e++)for(var i=0;i<this._width;i++){var r=3*(e*this._width+i);this._cells[r]=0,this._cells[r+1]=this._width-i,this._cells[r+2]=this._width-e}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(26);e.CharRenderInfo=class{constructor(){this.char="",this.deleted=!1,this.uv=new Array(8),this.pos=0,this.orix=0,this.oriy=0,this.touchTick=0,this.isSpace=!1}touch(){var t=r.RenderInfo.loopCount;this.touchTick!=t&&this.tex.touchRect(this,t),this.touchTick=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(92),s=i(8);class a extends r.ICharRender{constructor(t,e,i=!0,r=!0,n=!1){super(),this.ctx=null,this.lastScaleX=1,this.lastScaleY=1,this.maxTexW=0,this.maxTexH=0,this.scaleFontSize=!0,this.showDbgInfo=!1,this.supportImageData=!0,this.maxTexW=t,this.maxTexH=e,this.scaleFontSize=i,this.supportImageData=r,this.showDbgInfo=n,a.canvas||(a.canvas=s.Browser.createElement("canvas"),a.canvas.width=1024,a.canvas.height=512,a.canvas.style.left="-10000px",a.canvas.style.position="absolute",document.body.appendChild(a.canvas),this.ctx=a.canvas.getContext("2d"))}get canvasWidth(){return a.canvas.width}set canvasWidth(t){a.canvas.width!=t&&(a.canvas.width=t,t>2048&&console.warn("画文字设置的宽度太大，超过2048了"),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.lastScaleX,this.lastScaleY))}getWidth(t,e){return this.ctx?(this.ctx._lastFont!=t&&(this.ctx.font=t,this.ctx._lastFont=t),this.ctx.measureText(e).width):0}scale(t,e){if(!this.supportImageData)return this.lastScaleX=t,void(this.lastScaleY=e);this.lastScaleX==t&&this.lastScaleY==e||(this.ctx.setTransform(t,0,0,e,0,0),this.lastScaleX=t,this.lastScaleY=e)}getCharBmp(t,e,i,r,s,n,o,l,h,u,c=null){if(!this.supportImageData)return this.getCharCanvas(t,e,i,r,s,n,o,l,h,u);var _=this.ctx,d=this.fontsz;_.font!=e&&(_.font=e,_._lastFont=e),n.width=_.measureText(t).width;var f=n.width*this.lastScaleX,p=n.height*this.lastScaleY;f+=(o+h)*this.lastScaleX,p+=(l+u)*this.lastScaleY,f=Math.ceil(f),p=Math.ceil(p);var m=(f=Math.min(f,a.canvas.width))+2*i+1,g=(p=Math.min(p,a.canvas.height))+2*i+1;c&&(m=Math.max(m,c[0]+c[2]+1),g=Math.max(g,c[1]+c[3]+1)),_.clearRect(0,0,m/this.lastScaleX+1,g/this.lastScaleY+1),_.save(),_.textBaseline="middle",i>0&&(_.strokeStyle=s,_.lineWidth=i,_.strokeText(t,o,l+d/2)),r&&(_.fillStyle=r,_.fillText(t,o,l+d/2)),this.showDbgInfo&&(_.strokeStyle="#ff0000",_.strokeRect(1,1,f-2,p-2),_.strokeStyle="#00ff00",_.strokeRect(o,l,n.width,n.height)),c&&-1==c[2]&&(c[2]=Math.ceil((n.width+2*i)*this.lastScaleX));var v=c?_.getImageData(c[0],c[1],c[2],c[3]+1):_.getImageData(0,0,f,p+1);return _.restore(),n.bmpWidth=v.width,n.bmpHeight=v.height,v}getCharCanvas(t,e,i,r,s,n,o,l,h,u){var c=this.ctx;c.font!=e&&(c.font=e,c._lastFont=e),n.width=c.measureText(t).width;var _=n.width*this.lastScaleX,d=n.height*this.lastScaleY;_+=(o+h)*this.lastScaleX,d+=(l+u)*this.lastScaleY+1,_=Math.min(_,this.maxTexW),d=Math.min(d,this.maxTexH),a.canvas.width=Math.min(_+1,this.maxTexW),a.canvas.height=Math.min(d+1,this.maxTexH),c.font=e,c.clearRect(0,0,_+1+i,d+1+i),c.setTransform(1,0,0,1,0,0),c.save(),this.scaleFontSize&&c.scale(this.lastScaleX,this.lastScaleY),c.translate(o,l),c.textAlign="left";var f=this.fontsz;return c.textBaseline="middle",i>0?(c.strokeStyle=s,c.fillStyle=r,c.lineWidth=i,c.fillAndStrokeText?c.fillAndStrokeText(t,0,f/2):(c.strokeText(t,0,f/2),c.fillText(t,0,f/2))):r&&(c.fillStyle=r,c.fillText(t,0,f/2)),this.showDbgInfo&&(c.strokeStyle="#ff0000",c.strokeRect(0,0,_,d),c.strokeStyle="#00ff00",c.strokeRect(0,0,n.width,n.height)),c.restore(),n.bmpWidth=a.canvas.width,n.bmpHeight=a.canvas.height,a.canvas}}e.CharRender_Canvas=a,a.canvas=null},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(92),s=i(20);class a extends r.ICharRender{constructor(){super(),this.lastFont="",this.lastScaleX=1,this.lastScaleY=1}getWidth(t,e){return window.conchTextCanvas?(window.conchTextCanvas.font=t,this.lastFont=t,window.conchTextCanvas.measureText(e).width):0}scale(t,e){this.lastScaleX=t,this.lastScaleY=e}getCharBmp(t,e,i,r,a,n,o,l,h,u,c=null){if(!window.conchTextCanvas)return null;window.conchTextCanvas.font=e,this.lastFont=e;n.width=window.conchTextCanvas.measureText(t).width,n.height;window.conchTextCanvas.scale&&window.conchTextCanvas.scale(this.lastScaleX,this.lastScaleY);var _=s.ColorUtils.create(a).numColor,d=s.ColorUtils.create(r).numColor,f=window.conchTextCanvas.getTextBitmapData(t,d,i>2?2:i,_);return n.bmpWidth=f.width,n.bmpHeight=f.height,f}}e.CharRender_Native=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(144);class a{constructor(t,e){if(this._gl=null,this._vaoExt=null,this._angleInstancedArrays=null,this._isWebGL2=!1,this._oesTextureHalfFloat=null,this._oes_element_index_uint=null,this._oesTextureHalfFloatLinear=null,this._oesTextureFloat=null,this._extTextureFilterAnisotropic=null,this._compressedTextureS3tc=null,this._compressedTexturePvrtc=null,this._compressedTextureEtc1=null,this._gl=t,this._isWebGL2=e,e)this._getExtension("EXT_color_buffer_float");else{var i=a._forceSupportVAOPlatform();r.ILaya.Render.isConchApp||(s.VertexArrayObject,window._setupVertexArrayObject&&(i?window._forceSetupVertexArrayObject(t):window._setupVertexArrayObject(t))),this._vaoExt=this._getExtension("OES_vertex_array_object"),i||(this._angleInstancedArrays=this._getExtension("ANGLE_instanced_arrays")),this._oesTextureHalfFloat=this._getExtension("OES_texture_half_float"),this._oesTextureHalfFloatLinear=this._getExtension("OES_texture_half_float_linear"),this._oesTextureFloat=this._getExtension("OES_texture_float"),this._oes_element_index_uint=this._getExtension("OES_element_index_uint")}this._extTextureFilterAnisotropic=this._getExtension("EXT_texture_filter_anisotropic"),this._compressedTextureS3tc=this._getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTexturePvrtc=this._getExtension("WEBGL_compressed_texture_pvrtc"),this._compressedTextureEtc1=this._getExtension("WEBGL_compressed_texture_etc1")}static _forceSupportVAOPlatform(){let t=r.ILaya.Browser;return t.onBDMiniGame||t.onQGMiniGame}_getExtension(t){var e=a._extentionVendorPrefixes;for(var i in e){var r=this._gl.getExtension(e[i]+t);if(r)return r}return null}createVertexArray(){return this._isWebGL2?this._gl.createVertexArray():this._vaoExt.createVertexArrayOES()}bindVertexArray(t){this._isWebGL2?this._gl.bindVertexArray(t):this._vaoExt.bindVertexArrayOES(t)}deleteVertexArray(t){this._isWebGL2?this._gl.deleteVertexArray(t):this._vaoExt.deleteVertexArrayOES(t)}isVertexArray(t){this._isWebGL2?this._gl.isVertexArray(t):this._vaoExt.isVertexArrayOES(t)}drawElementsInstanced(t,e,i,r,s){this._isWebGL2?this._gl.drawElementsInstanced(t,e,i,r,s):this._angleInstancedArrays.drawElementsInstancedANGLE(t,e,i,r,s)}drawArraysInstanced(t,e,i,r){this._isWebGL2?this._gl.drawArraysInstanced(t,e,i,r):this._angleInstancedArrays.drawArraysInstancedANGLE(t,e,i,r)}vertexAttribDivisor(t,e){this._isWebGL2?this._gl.vertexAttribDivisor(t,e):this._angleInstancedArrays.vertexAttribDivisorANGLE(t,e)}supportInstance(){return!(!this._isWebGL2&&!this._angleInstancedArrays)}supportElementIndexUint32(){return!(!this._isWebGL2&&!this._oes_element_index_uint)}}e.LayaGPU=a,a._extentionVendorPrefixes=["","WEBKIT_","MOZ_"]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.VertexArrayObject=class{constructor(){}},function(){var t={};function e(e,i){var r;t[e]=!0,void 0!==i&&(r=i,window.console&&window.console.error&&window.console.error(r))}var i=function t(e){var i=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(var r=0;r<this.attribs.length;r++){var s=new t.VertexAttrib(i);this.attribs[r]=s}this.maxAttrib=0};(i.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=t.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var r=function(e){var i=this;this.gl=e,function(e){var i=e.getError;e.getError=function(){var r;do{(r=i.apply(e))!=e.NO_ERROR&&(t[r]=!0)}while(r!=e.NO_ERROR);for(var s in t)if(t[s])return delete t[s],parseInt(s);return e.NO_ERROR}}(e);var r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(t){return t==i.VERTEX_ARRAY_BINDING_OES?i.currentVertexArrayObject==i.defaultVertexArrayObject?null:i.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(t){var e=i.currentVertexArrayObject;e.maxAttrib=Math.max(e.maxAttrib,t);var s=e.attribs[t];return s.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(t){var e=i.currentVertexArrayObject;e.maxAttrib=Math.max(e.maxAttrib,t);var s=e.attribs[t];return s.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(t,s){switch(t){case e.ARRAY_BUFFER:i.currentArrayBuffer=s;break;case e.ELEMENT_ARRAY_BUFFER:i.currentVertexArrayObject.elementArrayBuffer=s}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(t,s){var a=i.currentVertexArrayObject,n=a.attribs[t];switch(s){case e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return n.buffer;case e.VERTEX_ATTRIB_ARRAY_ENABLED:return n.enabled;case e.VERTEX_ATTRIB_ARRAY_SIZE:return n.size;case e.VERTEX_ATTRIB_ARRAY_STRIDE:return n.stride;case e.VERTEX_ATTRIB_ARRAY_TYPE:return n.type;case e.VERTEX_ATTRIB_ARRAY_NORMALIZED:return n.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(t,e,s,a,n,o){var l=i.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);var h=l.attribs[t];return h.buffer=i.currentArrayBuffer,h.size=e,h.type=s,h.normalized=a,h.stride=n,h.offset=o,h.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas.addEventListener("webglcontextrestored",(function(){var t;t="OESVertexArrayObject emulation library context restored",window.console&&window.console.log&&window.console.log(t),i.reset_()}),!0),this.reset_()};r.prototype.VERTEX_ARRAY_BINDING_OES=34229,r.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;var e=this.gl;this.maxVertexAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new i(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},r.prototype.createVertexArrayOES=function(){var t=new i(this);return this.vertexArrayObjects.push(t),t},r.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject==t&&this.bindVertexArrayOES(null)},r.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof i&&t.hasBeenBound&&t.ext==this)},r.prototype.bindVertexArrayOES=function(t){var i=this.gl;if(!t||t.isAlive){var r=this.original,s=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var a=this.currentVertexArrayObject;if(s!=a){s&&a.elementArrayBuffer==s.elementArrayBuffer||r.bindBuffer.call(i,i.ELEMENT_ARRAY_BUFFER,a.elementArrayBuffer);for(var n=this.currentArrayBuffer,o=Math.max(s?s.maxAttrib:0,a.maxAttrib),l=0;l<=o;l++){var h=a.attribs[l],u=s?s.attribs[l]:null;if(s&&h.enabled==u.enabled||(h.enabled?r.enableVertexAttribArray.call(i,l):r.disableVertexAttribArray.call(i,l)),h.enabled){var c=!1;s&&h.buffer==u.buffer||(n!=h.buffer&&(r.bindBuffer.call(i,i.ARRAY_BUFFER,h.buffer),n=h.buffer),c=!0),(c||h.cached!=u.cached)&&r.vertexAttribPointer.call(i,l,h.size,h.type,h.normalized,h.stride,h.offset)}}this.currentArrayBuffer!=n&&r.bindBuffer.call(i,i.ARRAY_BUFFER,this.currentArrayBuffer)}}else e(i.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject")},window._setupVertexArrayObject=function(t){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};var i=t.getExtension;t.getExtension=function(t){var e=i.call(this,t);return e||("OES_vertex_array_object"!==t?null:(this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new r(this)),this.__OESVertexArrayObject))}},window._forceSetupVertexArrayObject=function(t){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};var i=t.getExtension;t.getExtension=function(t){if("OES_vertex_array_object"===t)return this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new r(this)),this.__OESVertexArrayObject;var e=i.call(this,t);return e||null}}}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e,i,a){var n=r.Pool.getItemByClass("ClipRectCmd",s);return n.x=t,n.y=e,n.width=i,n.height=a,n}recover(){r.Pool.recover("ClipRectCmd",this)}run(t,e,i){t.clipRect(this.x+e,this.y+i,this.width,this.height)}get cmdID(){return s.ID}}e.ClipRectCmd=s,s.ID="ClipRect"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(t,e){var i=r.Pool.getItemByClass("DrawTexturesCmd",s);return i.texture=t,t._addReference(),i.pos=e,i}recover(){this.texture._removeReference(),this.texture=null,this.pos=null,r.Pool.recover("DrawTexturesCmd",this)}run(t,e,i){t.drawTextures(this.texture,this.pos,e,i)}get cmdID(){return s.ID}}e.DrawTexturesCmd=s,s.ID="DrawTextures"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(33),s=i(20),a=i(91),n=i(1),o=i(54),l=i(0);class h{constructor(){this._textIsWorldText=!1,this._fontColor=4294967295,this._strokeColor=0,this._fontObj=h._defFontObj,this._nTexAlign=0}static create(t,e,i,r,s,a,l,u,c){var _=n.Pool.getItemByClass("FillTextCmd",h);return _.text=t,_._textIsWorldText=t instanceof o.WordText,_._words=e,_.x=i,_.y=r,_.font=s,_.color=a,_.textAlign=l,_._lineWidth=u,_._borderColor=c,_}recover(){n.Pool.recover("FillTextCmd",this)}run(t,e,i){l.ILaya.stage.isGlobalRepaint()&&this._textIsWorldText&&this._text.cleanCache(),this._words?r.Context._textRender.fillWords(t,this._words,this.x+e,this.y+i,this._fontObj,this._color,this._borderColor,this._lineWidth):this._textIsWorldText?t._fast_filltext(this._text,this.x+e,this.y+i,this._fontObj,this._color,this._borderColor,this._lineWidth,this._nTexAlign,0):r.Context._textRender.filltext(t,this._text,this.x+e,this.y+i,this.font,this.color,this._borderColor,this._lineWidth,this._textAlign)}get cmdID(){return h.ID}get text(){return this._text}set text(t){this._text=t,this._textIsWorldText=t instanceof o.WordText,this._textIsWorldText&&this._text.cleanCache()}get font(){return this._font}set font(t){this._font=t,this._fontObj=a.FontInfo.Parse(t),this._textIsWorldText&&this._text.cleanCache()}get color(){return this._color}set color(t){this._color=t,this._fontColor=s.ColorUtils.create(t).numColor,this._textIsWorldText&&this._text.cleanCache()}get textAlign(){return this._textAlign}set textAlign(t){switch(this._textAlign=t,t){case"center":this._nTexAlign=l.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":this._nTexAlign=l.ILaya.Context.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=l.ILaya.Context.ENUM_TEXTALIGN_DEFAULT}this._textIsWorldText&&this._text.cleanCache()}}e.FillTextCmd=h,h.ID="FillText",h._defFontObj=new a.FontInfo(null)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{static create(){return r.Pool.getItemByClass("SaveCmd",s)}recover(){r.Pool.recover("SaveCmd",this)}run(t,e,i){t.save()}get cmdID(){return s.ID}}e.SaveCmd=s,s.ID="Save"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(22),s=i(27),a=i(4);class n{static __init__(){n.map[s.SpriteConst.ALPHA|s.SpriteConst.TRANSFORM|s.SpriteConst.GRAPHICS]=n.alpha_transform_drawLayaGL,n.map[s.SpriteConst.ALPHA|s.SpriteConst.GRAPHICS]=n.alpha_drawLayaGL,n.map[s.SpriteConst.TRANSFORM|s.SpriteConst.GRAPHICS]=n.transform_drawLayaGL,n.map[s.SpriteConst.TRANSFORM|s.SpriteConst.CHILDS]=n.transform_drawNodes,n.map[s.SpriteConst.ALPHA|s.SpriteConst.TRANSFORM|s.SpriteConst.TEXTURE]=n.alpha_transform_drawTexture,n.map[s.SpriteConst.ALPHA|s.SpriteConst.TEXTURE]=n.alpha_drawTexture,n.map[s.SpriteConst.TRANSFORM|s.SpriteConst.TEXTURE]=n.transform_drawTexture,n.map[s.SpriteConst.GRAPHICS|s.SpriteConst.CHILDS]=n.drawLayaGL_drawNodes}static transform_drawTexture(t,e,i,r){t._style;var s=t.texture;e.saveTransform(n.curMat),e.transformByMatrix(t.transform,i,r),e.drawTexture(s,-t.pivotX,-t.pivotY,t._width||s.width,t._height||s.height),e.restoreTransform(n.curMat)}static alpha_drawTexture(t,e,i,r){var s,a=t._style,n=t.texture;if((s=a.alpha)>.01||t._needRepaint()){var o=e.globalAlpha;e.globalAlpha*=s,e.drawTexture(n,i-a.pivotX+n.offsetX,r-a.pivotY+n.offsetY,t._width||n.width,t._height||n.height),e.globalAlpha=o}}static alpha_transform_drawTexture(t,e,i,r){var s,a=t._style,o=t.texture;if((s=a.alpha)>.01||t._needRepaint()){var l=e.globalAlpha;e.globalAlpha*=s,e.saveTransform(n.curMat),e.transformByMatrix(t.transform,i,r),e.drawTexture(o,-a.pivotX+o.offsetX,-a.pivotY+o.offsetY,t._width||o.width,t._height||o.height),e.restoreTransform(n.curMat),e.globalAlpha=l}}static alpha_transform_drawLayaGL(t,e,i,r){var s,a=t._style;if((s=a.alpha)>.01||t._needRepaint()){var o=e.globalAlpha;e.globalAlpha*=s,e.saveTransform(n.curMat),e.transformByMatrix(t.transform,i,r),t._graphics&&t._graphics._render(t,e,-a.pivotX,-a.pivotY),e.restoreTransform(n.curMat),e.globalAlpha=o}}static alpha_drawLayaGL(t,e,i,r){var s,a=t._style;if((s=a.alpha)>.01||t._needRepaint()){var n=e.globalAlpha;e.globalAlpha*=s,t._graphics&&t._graphics._render(t,e,i-a.pivotX,r-a.pivotY),e.globalAlpha=n}}static transform_drawLayaGL(t,e,i,r){var s=t._style;e.saveTransform(n.curMat),e.transformByMatrix(t.transform,i,r),t._graphics&&t._graphics._render(t,e,-s.pivotX,-s.pivotY),e.restoreTransform(n.curMat)}static transform_drawNodes(t,e,i,s){var a=t._getBit(r.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0),o=t._style;e.saveTransform(n.curMat),e.transformByMatrix(t.transform,i,s),i=-o.pivotX,s=-o.pivotY;var l,h=t._children,u=h.length;if(o.viewport){var c,_,d=o.viewport,f=d.x,p=d.y,m=d.right,g=d.bottom;for(v=0;v<u;++v)(l=h[v])._visible&&(c=l._x)<m&&c+l.width>f&&(_=l._y)<g&&_+l.height>p&&l.render(e,i,s)}else for(var v=0;v<u;++v)(l=h[v])._visible&&l.render(e,i,s);e.restoreTransform(n.curMat),a&&e.drawCallOptimize(!1)}static drawLayaGL_drawNodes(t,e,i,s){var a=t._getBit(r.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0),n=t._style;i-=n.pivotX,s-=n.pivotY,t._graphics&&t._graphics._render(t,e,i,s);var o,l=t._children,h=l.length;if(n.viewport){var u,c,_=n.viewport,d=_.x,f=_.y,p=_.right,m=_.bottom;for(g=0;g<h;++g)(o=l[g])._visible&&(u=o._x)<p&&u+o.width>d&&(c=o._y)<m&&c+o.height>f&&o.render(e,i,s)}else for(var g=0;g<h;++g)(o=l[g])._visible&&o.render(e,i,s);a&&e.drawCallOptimize(!1)}}e.LayaGLQuickRunner=n,n.map={},n.curMat=new a.Matrix},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(5),s=i(10),a=i(0);class n{contains(t,e){return!!n._isHitGraphic(t,e,this.hit)&&!n._isHitGraphic(t,e,this.unHit)}static _isHitGraphic(t,e,i){if(!i)return!1;var r,s,a,o=i.cmds;if(!o&&i._one&&((o=n._cmds).length=1,o[0]=i._one),!o)return!1;for(s=o.length,r=0;r<s;r++)if(a=o[r]){switch(a.cmdID){case"Translate":t-=a.tx,e-=a.ty}if(n._isHitCmd(t,e,a))return!0}return!1}static _isHitCmd(t,e,i){if(!i)return!1;var r=!1;switch(i.cmdID){case"DrawRect":n._rect.setTo(i.x,i.y,i.width,i.height),r=n._rect.contains(t,e);break;case"DrawCircle":r=(t-=i.x)*t+(e-=i.y)*e<i.radius*i.radius;break;case"DrawPoly":t-=i.x,e-=i.y,r=n._ptInPolygon(t,e,i.points)}return r}static _ptInPolygon(t,e,i){var r=n._ptPoint;r.setTo(t,e);var s,a,o,l,h,u=0;h=i.length;for(var c=0;c<h;c+=2){if(s=i[c],a=i[c+1],o=i[(c+2)%h],a!=(l=i[(c+3)%h]))if(!(r.y<Math.min(a,l)))if(!(r.y>=Math.max(a,l)))(r.y-a)*(o-s)/(l-a)+s>r.x&&u++}return u%2==1}get hit(){return this._hit||(this._hit=new a.ILaya.Graphics),this._hit}set hit(t){this._hit=t}get unHit(){return this._unHit||(this._unHit=new a.ILaya.Graphics),this._unHit}set unHit(t){this._unHit=t}}e.HitArea=n,n._cmds=[],n._rect=new s.Rectangle,n._ptPoint=new r.Point},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);class s{reset(){return this.bounds&&this.bounds.recover(),this.userBounds&&this.userBounds.recover(),this.bounds=null,this.userBounds=null,this.temBM=null,this}recover(){r.Pool.recover("BoundsStyle",this.reset())}static create(){return r.Pool.getItemByClass("BoundsStyle",s)}}e.BoundsStyle=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(5),s=i(10),a=i(42),n=i(1);class o{constructor(){this.reset()}needBitmapCache(){return this.cacheForFilters||!!this.mask}needEnableCanvasRender(){return"none"!=this.userSetCache||this.cacheForFilters||!!this.mask}releaseContext(){if(this.canvas&&this.canvas.size){n.Pool.recover("CacheCanvas",this.canvas),this.canvas.size(0,0);try{this.canvas.width=0,this.canvas.height=0}catch(t){}}this.canvas=null}createContext(){if(!this.canvas){this.canvas=n.Pool.getItem("CacheCanvas")||new a.HTMLCanvas(!1);var t=this.canvas.context;t||(t=this.canvas.getContext("2d"))}}releaseFilterCache(){var t=this.filterCache;t&&(t.destroy(),t.recycle(),this.filterCache=null)}recover(){this!==o.EMPTY&&n.Pool.recover("SpriteCache",this.reset())}reset(){return this.releaseContext(),this.releaseFilterCache(),this.cacheAs="none",this.enableCanvasRender=!1,this.userSetCache="none",this.cacheForFilters=!1,this.staticCache=!1,this.reCache=!0,this.mask=null,this.maskParent=null,this.filterCache=null,this.filters=null,this.hasGlowFilter=!1,this.cacheRect&&this.cacheRect.recover(),this.cacheRect=null,this}static create(){return n.Pool.getItemByClass("SpriteCache",o)}_calculateCacheRect(t,e,i,r){var a,n=t._cacheStyle;if(n.cacheRect||(n.cacheRect=s.Rectangle.create()),"bitmap"===e?((a=t.getSelfBounds()).width=a.width+2*o.CANVAS_EXTEND_EDGE,a.height=a.height+2*o.CANVAS_EXTEND_EDGE,a.x=a.x-t.pivotX,a.y=a.y-t.pivotY,a.x=a.x-o.CANVAS_EXTEND_EDGE,a.y=a.y-o.CANVAS_EXTEND_EDGE,a.x=Math.floor(a.x+i)-i,a.y=Math.floor(a.y+r)-r,a.width=Math.floor(a.width),a.height=Math.floor(a.height),n.cacheRect.copyFrom(a)):n.cacheRect.setTo(-t._style.pivotX,-t._style.pivotY,1,1),a=n.cacheRect,t._style.scrollRect){var l=t._style.scrollRect;a.x-=l.x,a.y-=l.y}return o._scaleInfo.setTo(1,1),o._scaleInfo}}e.CacheStyle=o,o.EMPTY=new o,o._scaleInfo=new r.Point,o.CANVAS_EXTEND_EDGE=16},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(98),s=i(1);class a extends r.SpriteStyle{constructor(){super(...arguments),this.italic=!1}reset(){return super.reset(),this.italic=!1,this.align="left",this.wordWrap=!1,this.leading=0,this.padding=[0,0,0,0],this.bgColor=null,this.borderColor=null,this.asPassword=!1,this.stroke=0,this.strokeColor="#000000",this.bold=!1,this.underline=!1,this.underlineColor=null,this.currBitmapFont=null,this}recover(){this!==a.EMPTY&&s.Pool.recover("TextStyle",this.reset())}static create(){return s.Pool.getItemByClass("TextStyle",a)}render(t,e,i,r){(this.bgColor||this.borderColor)&&e.drawRect(i,r,t.width,t.height,this.bgColor,this.borderColor,1)}}e.TextStyle=a,a.EMPTY=new a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(28),s=i(32),a=i(56),n=i(27),o=i(22),l=i(2),h=i(58),u=i(4),c=i(5),_=i(25),d=i(26),f=i(33),p=i(8),m=i(99),g=i(20),v=i(100),y=i(95),x=i(18),T=i(15),b=i(0),E=i(3),C=i(9);class S extends r.Sprite{constructor(){super(),this.offset=new c.Point,this._frameRate="fast",this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._canvasTransform=new u.Matrix,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._safariOffsetY=0,this._frameStartTime=0,this._previousOrientation=p.Browser.window.orientation,this._wgColor=[0,0,0,1],this._scene3Ds=[],this._globalRepaintSet=!1,this._globalRepaintGet=!1,this._3dUI=[],this._curUIBase=null,this.useRetinalCanvas=!1,super.set_transform(this._createTransform()),this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._setBit(o.Const.DISPLAYED_INSTAGE,!0),this._setBit(o.Const.ACTIVE_INHIERARCHY,!0),this._isFocused=!0,this._isVisibility=!0,this.useRetinalCanvas=s.Config.useRetinalCanvas;var t=p.Browser.window;t.addEventListener("focus",()=>{this._isFocused=!0,this.event(l.Event.FOCUS),this.event(l.Event.FOCUS_CHANGE)}),t.addEventListener("blur",()=>{this._isFocused=!1,this.event(l.Event.BLUR),this.event(l.Event.FOCUS_CHANGE),this._isInputting()&&(a.Input.inputElement.target.focus=!1)});var e="visibilityState",i="visibilitychange",r=t.document;void 0!==r.hidden?(i="visibilitychange",e="visibilityState"):void 0!==r.mozHidden?(i="mozvisibilitychange",e="mozVisibilityState"):void 0!==r.msHidden?(i="msvisibilitychange",e="msVisibilityState"):void 0!==r.webkitHidden&&(i="webkitvisibilitychange",e="webkitVisibilityState"),t.document.addEventListener(i,()=>{"hidden"==p.Browser.document[e]?(this._isVisibility=!1,this._isInputting()&&(a.Input.inputElement.target.focus=!1)):this._isVisibility=!0,this.renderingEnabled=this._isVisibility,this.event(l.Event.VISIBILITY_CHANGE)}),t.addEventListener("resize",()=>{var t=p.Browser.window.orientation;null!=t&&t!=this._previousOrientation&&this._isInputting()&&(a.Input.inputElement.target.focus=!1),this._previousOrientation=t,this._isInputting()||(p.Browser.onSafari&&(this._safariOffsetY=(p.Browser.window.__innerHeight||p.Browser.document.body.clientHeight||p.Browser.document.documentElement.clientHeight)-p.Browser.window.innerHeight),this._resetCanvas())}),t.addEventListener("orientationchange",t=>{this._resetCanvas()}),this.on(l.Event.MOUSE_MOVE,this,this._onmouseMove),p.Browser.onMobile&&this.on(l.Event.MOUSE_DOWN,this,this._onmouseMove)}_isInputting(){return p.Browser.onMobile&&a.Input.isInputting}set width(t){this.designWidth=t,super.set_width(t),b.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}get width(){return super.get_width()}set height(t){this.designHeight=t,super.set_height(t),b.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}get height(){return super.get_height()}set transform(t){super.set_transform(t)}get transform(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||this._createTransform()}get isFocused(){return this._isFocused}get isVisibility(){return this._isVisibility}_changeCanvasSize(){this.setScreenSize(p.Browser.clientWidth*p.Browser.pixelRatio,p.Browser.clientHeight*p.Browser.pixelRatio)}_resetCanvas(){this.screenAdaptationEnabled&&this._changeCanvasSize()}setScreenSize(t,e){var i=!1;if(this._screenMode!==S.SCREEN_NONE&&(i=(t/e<1?S.SCREEN_VERTICAL:S.SCREEN_HORIZONTAL)!==this._screenMode)){var r=e;e=t,t=r}this.canvasRotation=i;var s=_.Render._mainCanvas,a=s.source.style,o=this._canvasTransform.identity(),h=this._scaleMode,u=t/this.designWidth,c=e/this.designHeight,d=this.useRetinalCanvas?t:this.designWidth,f=this.useRetinalCanvas?e:this.designHeight,m=t,g=e,y=p.Browser.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,h){case S.SCALE_NOSCALE:u=c=1,m=this.designWidth,g=this.designHeight;break;case S.SCALE_SHOWALL:u=c=Math.min(u,c),d=m=Math.round(this.designWidth*u),f=g=Math.round(this.designHeight*c);break;case S.SCALE_NOBORDER:u=c=Math.max(u,c),m=Math.round(this.designWidth*u),g=Math.round(this.designHeight*c);break;case S.SCALE_FULL:u=c=1,this._width=d=t,this._height=f=e;break;case S.SCALE_FIXED_WIDTH:c=u,this._height=f=Math.round(e/u);break;case S.SCALE_FIXED_HEIGHT:u=c,this._width=d=Math.round(t/c);break;case S.SCALE_FIXED_AUTO:t/e<this.designWidth/this.designHeight?(c=u,this._height=f=Math.round(e/u)):(u=c,this._width=d=Math.round(t/c))}this.useRetinalCanvas&&(d=t,f=e),u*=this.scaleX,c*=this.scaleY,1===u&&1===c?this.transform.identity():(this.transform.a=this._formatData(u/(m/d)),this.transform.d=this._formatData(c/(g/f))),s.size(d,f),v.RunDriver.changeWebGLSize(d,f),o.scale(m/d/y,g/f/y),this._alignH===S.ALIGN_LEFT?this.offset.x=0:this._alignH===S.ALIGN_RIGHT?this.offset.x=t-m:this.offset.x=.5*(t-m)/y,this._alignV===S.ALIGN_TOP?this.offset.y=0:this._alignV===S.ALIGN_BOTTOM?this.offset.y=e-g:this.offset.y=.5*(e-g)/y,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),o.translate(this.offset.x,this.offset.y),this._safariOffsetY&&o.translate(0,this._safariOffsetY),this.canvasDegree=0,i&&(this._screenMode===S.SCREEN_HORIZONTAL?(o.rotate(Math.PI/2),o.translate(e/y,0),this.canvasDegree=90):(o.rotate(-Math.PI/2),o.translate(0,t/y),this.canvasDegree=-90)),o.a=this._formatData(o.a),o.d=this._formatData(o.d),o.tx=this._formatData(o.tx),o.ty=this._formatData(o.ty),super.set_transform(this.transform),a.transformOrigin=a.webkitTransformOrigin=a.msTransformOrigin=a.mozTransformOrigin=a.oTransformOrigin="0px 0px 0px",a.transform=a.webkitTransform=a.msTransform=a.mozTransform=a.oTransform="matrix("+o.toString()+")",this._safariOffsetY&&o.translate(0,-this._safariOffsetY),o.translate(parseInt(a.left)||0,parseInt(a.top)||0),this.visible=!0,this._repaint|=n.SpriteConst.REPAINT_CACHE,this.event(l.Event.RESIZE)}_formatData(t){return Math.abs(t)<1e-6?0:Math.abs(1-t)<.001?t>0?1:-1:t}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode=t,b.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}get alignH(){return this._alignH}set alignH(t){this._alignH=t,b.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}get alignV(){return this._alignV}set alignV(t){this._alignV=t,b.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t,this._wgColor=t?g.ColorUtils.create(t).arrColor:null,_.Render.canvas.style.background=t||"none"}get mouseX(){return Math.round(h.MouseManager.instance.mouseX/this.clientScaleX)}get mouseY(){return Math.round(h.MouseManager.instance.mouseY/this.clientScaleY)}getMousePoint(){return c.Point.TEMP.setTo(this.mouseX,this.mouseY)}get clientScaleX(){return this._transform?this._transform.getScaleX():1}get clientScaleY(){return this._transform?this._transform.getScaleY():1}get screenMode(){return this._screenMode}set screenMode(t){this._screenMode=t}repaint(t=n.SpriteConst.REPAINT_CACHE){this._repaint|=t}parentRepaint(t=n.SpriteConst.REPAINT_CACHE){}_loop(){return this._globalRepaintGet=this._globalRepaintSet,this._globalRepaintSet=!1,this.render(_.Render._context,0,0),!0}getFrameTm(){return this._frameStartTime}_onmouseMove(t){this._mouseMoveTime=p.Browser.now()}getTimeFromFrameStart(){return p.Browser.now()-this._frameStartTime}set visible(t){this.visible!==t&&(super.set_visible(t),_.Render._mainCanvas.source.style.visibility=t?"visible":"hidden")}get visible(){return super.visible}render(t,e,i){if(window.conch)this.renderToNative(t,e,i);else{if(S._dbgSprite.graphics.clear(),this._frameRate===S.FRAME_SLEEP){var r=p.Browser.now();if(!(r-this._frameStartTime>=1e3))return;this._frameStartTime=r}else{if(!this._visible)return this._renderCount++,void(this._renderCount%5==0&&(m.CallLater.I._update(),T.Stat.loopCount++,d.RenderInfo.loopCount=T.Stat.loopCount,this._updateTimers()));this._frameStartTime=p.Browser.now(),d.RenderInfo.loopStTm=this._frameStartTime}this._renderCount++;var s=(this._frameRate===S.FRAME_MOUSE?this._frameStartTime-this._mouseMoveTime<2e3?S.FRAME_FAST:S.FRAME_SLOW:this._frameRate)!==S.FRAME_SLOW,a=this._renderCount%2==0;if(T.Stat.renderSlow=!s,s||a){if(m.CallLater.I._update(),T.Stat.loopCount++,d.RenderInfo.loopCount=T.Stat.loopCount,this.renderingEnabled){for(var n=0,o=this._scene3Ds.length;n<o;n++)this._scene3Ds[n]._update();t.clear(),super.render(t,e,i),T.Stat._StatRender.renderNotCanvas(t,e,i)}S._dbgSprite.render(t,0,0),this.renderingEnabled&&(S.clear(this._bgColor),t.flush(),y.VectorGraphManager.instance&&y.VectorGraphManager.getInstance().endDispose()),this._updateTimers()}}}renderToNative(t,e,i){if(this._renderCount++,this._visible){if(m.CallLater.I._update(),T.Stat.loopCount++,d.RenderInfo.loopCount=T.Stat.loopCount,this.renderingEnabled){for(var r=0,s=this._scene3Ds.length;r<s;r++)this._scene3Ds[r]._update();t.clear(),super.render(t,e,i),T.Stat._StatRender.renderNotCanvas(t,e,i)}this.renderingEnabled&&(S.clear(this._bgColor),t.flush(),y.VectorGraphManager.instance&&y.VectorGraphManager.getInstance().endDispose()),this._updateTimers()}else this._renderCount%5==0&&(m.CallLater.I._update(),T.Stat.loopCount++,d.RenderInfo.loopCount=T.Stat.loopCount,this._updateTimers())}_updateTimers(){b.ILaya.systemTimer._update(),b.ILaya.startTimer._update(),b.ILaya.physicsTimer._update(),b.ILaya.updateTimer._update(),b.ILaya.lateTimer._update(),b.ILaya.timer._update()}set fullScreenEnabled(t){var e=p.Browser.document,i=_.Render.canvas;t?(i.addEventListener("mousedown",this._requestFullscreen),i.addEventListener("touchstart",this._requestFullscreen),e.addEventListener("fullscreenchange",this._fullScreenChanged),e.addEventListener("mozfullscreenchange",this._fullScreenChanged),e.addEventListener("webkitfullscreenchange",this._fullScreenChanged),e.addEventListener("msfullscreenchange",this._fullScreenChanged)):(i.removeEventListener("mousedown",this._requestFullscreen),i.removeEventListener("touchstart",this._requestFullscreen),e.removeEventListener("fullscreenchange",this._fullScreenChanged),e.removeEventListener("mozfullscreenchange",this._fullScreenChanged),e.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),e.removeEventListener("msfullscreenchange",this._fullScreenChanged))}get frameRate(){return b.ILaya.Render.isConchApp?this._frameRateNative:this._frameRate}set frameRate(t){if(b.ILaya.Render.isConchApp){var e=window.conch;switch(t){case S.FRAME_FAST:e.config.setLimitFPS(60);break;case S.FRAME_MOUSE:e.config.setMouseFrame(2e3);break;case S.FRAME_SLOW:e.config.setSlowFrame(!0);break;case S.FRAME_SLEEP:e.config.setLimitFPS(1)}this._frameRateNative=t}else this._frameRate=t}_requestFullscreen(){var t=p.Browser.document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}_fullScreenChanged(){b.ILaya.stage.event(l.Event.FULL_SCREEN_CHANGE)}exitFullscreen(){var t=p.Browser.document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()}isGlobalRepaint(){return this._globalRepaintGet}setGlobalRepaint(){this._globalRepaintSet=!0}add3DUI(t){var e=t.rootView;this._3dUI.indexOf(e)>=0||this._3dUI.push(e)}remove3DUI(t){var e=t.rootView,i=this._3dUI.indexOf(e);return i>=0&&(this._3dUI.splice(i,1),!0)}}e.Stage=S,S.SCALE_NOSCALE="noscale",S.SCALE_EXACTFIT="exactfit",S.SCALE_SHOWALL="showall",S.SCALE_NOBORDER="noborder",S.SCALE_FULL="full",S.SCALE_FIXED_WIDTH="fixedwidth",S.SCALE_FIXED_HEIGHT="fixedheight",S.SCALE_FIXED_AUTO="fixedauto",S.ALIGN_LEFT="left",S.ALIGN_RIGHT="right",S.ALIGN_CENTER="center",S.ALIGN_TOP="top",S.ALIGN_MIDDLE="middle",S.ALIGN_BOTTOM="bottom",S.SCREEN_NONE="none",S.SCREEN_HORIZONTAL="horizontal",S.SCREEN_VERTICAL="vertical",S.FRAME_FAST="fast",S.FRAME_SLOW="slow",S.FRAME_MOUSE="mouse",S.FRAME_SLEEP="sleep",S._dbgSprite=new r.Sprite,S.clear=function(t){f.Context.set2DRenderConfig();var e=E.LayaGL.instance;x.RenderState2D.worldScissorTest&&e.disable(e.SCISSOR_TEST);var i=_.Render.context,r=0==i._submits._length||s.Config.preserveDrawingBuffer?g.ColorUtils.create(t).arrColor:b.ILaya.stage._wgColor;r?i.clearBG(r[0],r[1],r[2],r[3]):i.clearBG(0,0,0,0),x.RenderState2D.clear()},C.ClassUtils.regClass("laya.display.Stage",S),C.ClassUtils.regClass("Laya.Stage",S)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(8),a=i(1),n=i(0);class o{constructor(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._event=new r.Event,this._lastClickTime=0}_clearTempArrs(){o._oldArr.length=0,o._newArr.length=0,o._tEleArr.length=0}getTouchFromArr(t,e){var i,r,s;for(r=e.length,i=0;i<r;i++)if((s=e[i]).id==t)return s;return null}removeTouchFromArr(t,e){var i;for(i=e.length-1;i>=0;i--)e[i].id==t&&e.splice(i,1)}createTouchO(t,e){var i;return(i=a.Pool.getItem("TouchData")||{}).id=e,i.tar=t,i}onMouseDown(t,e,i=!1){var a,n,l,h;this.enable&&(a=this.getTouchFromArr(e,this.preOvers),l=this.getEles(t,null,o._tEleArr),a?a.tar=t:(n=this.createTouchO(t,e),this.preOvers.push(n)),s.Browser.onMobile&&this.sendEvents(l,r.Event.MOUSE_OVER),h=i?this.preDowns:this.preRightDowns,(a=this.getTouchFromArr(e,h))?a.tar=t:(n=this.createTouchO(t,e),h.push(n)),this.sendEvents(l,i?r.Event.MOUSE_DOWN:r.Event.RIGHT_MOUSE_DOWN),this._clearTempArrs())}sendEvents(t,e){var i,r,s;for(r=t.length,this._event._stoped=!1,s=t[0],i=0;i<r;i++){var a=t[i];if(a.destroyed)return;if(a.event(e,this._event.setTo(e,a,s)),this._event._stoped)break}}getEles(t,e=null,i=null){for(i?i.length=0:i=[];t&&t!=e;)i.push(t),t=t.parent;return i}checkMouseOutAndOverOfMove(t,e,i=0){var s,a,n,l;if(e!=t)if(e.contains(t))a=this.getEles(t,e,o._tEleArr),this.sendEvents(a,r.Event.MOUSE_OVER);else if(t.contains(e))a=this.getEles(e,t,o._tEleArr),this.sendEvents(a,r.Event.MOUSE_OUT);else{var h,u,c;for((a=o._tEleArr).length=0,h=this.getEles(e,null,o._oldArr),u=this.getEles(t,null,o._newArr),l=h.length,n=0;n<l;n++){if(s=h[n],(c=u.indexOf(s))>=0){u.splice(c,u.length-c);break}a.push(s)}a.length>0&&this.sendEvents(a,r.Event.MOUSE_OUT),u.length>0&&this.sendEvents(u,r.Event.MOUSE_OVER)}}onMouseMove(t,e){var i,s;this.enable&&((i=this.getTouchFromArr(e,this.preOvers))?(this.checkMouseOutAndOverOfMove(t,i.tar),i.tar=t,s=this.getEles(t,null,o._tEleArr)):(s=this.getEles(t,null,o._tEleArr),this.sendEvents(s,r.Event.MOUSE_OVER),this.preOvers.push(this.createTouchO(t,e))),this.sendEvents(s,r.Event.MOUSE_MOVE),this._clearTempArrs())}getLastOvers(){return o._tEleArr.length=0,this.preOvers.length>0&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,o._tEleArr):(o._tEleArr.push(n.ILaya.stage),o._tEleArr)}stageMouseOut(){var t;t=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(t,r.Event.MOUSE_OUT)}onMouseUp(t,e,i=!1){if(this.enable){var n,l,h,u,c,_,d,f,p=s.Browser.onMobile;if(l=this.getEles(t,null,o._tEleArr),this.sendEvents(l,i?r.Event.MOUSE_UP:r.Event.RIGHT_MOUSE_UP),f=i?this.preDowns:this.preRightDowns,n=this.getTouchFromArr(e,f)){var m,g=s.Browser.now();if(m=g-this._lastClickTime<300,this._lastClickTime=g,t==n.tar)d=l;else for(h=this.getEles(n.tar,null,o._oldArr),(d=o._newArr).length=0,c=h.length,u=0;u<c;u++)_=h[u],l.indexOf(_)>=0&&d.push(_);d.length>0&&this.sendEvents(d,i?r.Event.CLICK:r.Event.RIGHT_CLICK),i&&m&&this.sendEvents(d,r.Event.DOUBLE_CLICK),this.removeTouchFromArr(e,f),n.tar=null,a.Pool.recover("TouchData",n)}else;(n=this.getTouchFromArr(e,this.preOvers))&&p&&((d=this.getEles(n.tar,null,d))&&d.length>0&&this.sendEvents(d,r.Event.MOUSE_OUT),this.removeTouchFromArr(e,this.preOvers),n.tar=null,a.Pool.recover("TouchData",n)),this._clearTempArrs()}}}e.TouchManager=o,o.I=new o,o._oldArr=[],o._newArr=[],o._tEleArr=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(0);class a{static __init__(){a._addEvent("keydown"),a._addEvent("keypress"),a._addEvent("keyup")}static _addEvent(t){s.ILaya.Browser.document.addEventListener(t,(function(e){a._dispatch(e,t)}),!0)}static _dispatch(t,e){if(a.enabled){a._event._stoped=!1,a._event.nativeEvent=t,a._event.keyCode=t.keyCode||t.which||t.charCode,"keydown"===e?a._pressKeys[a._event.keyCode]=!0:"keyup"===e&&(a._pressKeys[a._event.keyCode]=null);for(var i=s.ILaya.stage.focus&&null!=s.ILaya.stage.focus.event&&s.ILaya.stage.focus.displayedInStage?s.ILaya.stage.focus:s.ILaya.stage,r=i;r;)r.event(e,a._event.setTo(e,r,i)),r=r.parent}}static hasKeyDown(t){return a._pressKeys[t]}}e.KeyBoardManager=a,a._pressKeys={},a.enabled=!0,a._event=new r.Event},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(59),a=i(8),n=i(0);class o extends s.SoundChannel{constructor(t){super(),this._audio=null,this._onEnd=this.__onEnd.bind(this),this._resumePlay=this.__resumePlay.bind(this),t.addEventListener("ended",this._onEnd),this._audio=t}__onEnd(t){if(1==this.loops)return this.completeHandler&&(n.ILaya.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(r.Event.COMPLETE);this.loops>0&&this.loops--,this.startTime=0,this.play()}__resumePlay(){if(this._audio&&this._audio.removeEventListener("canplay",this._resumePlay),!this.isStopped)try{this._audio.currentTime=this.startTime,a.Browser.container.appendChild(this._audio),this._audio.play()}catch(t){this.event(r.Event.ERROR)}}play(){this.isStopped=!1;try{this._audio.playbackRate=n.ILaya.SoundManager.playbackRate,this._audio.currentTime=this.startTime}catch(t){return void this._audio.addEventListener("canplay",this._resumePlay)}n.ILaya.SoundManager.addChannel(this),a.Browser.container.appendChild(this._audio),"play"in this._audio&&this._audio.play()}get position(){return this._audio?this._audio.currentTime:0}get duration(){return this._audio?this._audio.duration:0}stop(){super.stop(),this.isStopped=!0,n.ILaya.SoundManager.removeChannel(this),this.completeHandler=null,this._audio&&("pause"in this._audio&&n.ILaya.Render.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),n.ILaya.Browser.onIE||this._audio!=n.ILaya.AudioSound._musicAudio&&n.ILaya.Pool.recover("audio:"+this.url,this._audio),a.Browser.removeElement(this._audio),this._audio=null,n.ILaya.SoundManager.autoReleaseSound&&n.ILaya.SoundManager.disposeSoundLater(this.url))}pause(){this.isStopped=!0,n.ILaya.SoundManager.removeChannel(this),"pause"in this._audio&&this._audio.pause(),n.ILaya.SoundManager.autoReleaseSound&&n.ILaya.SoundManager.disposeSoundLater(this.url)}resume(){this._audio&&(this.isStopped=!1,n.ILaya.SoundManager.addChannel(this),"play"in this._audio&&this._audio.play())}set volume(t){this._audio&&(this._audio.volume=t)}get volume(){return this._audio?this._audio.volume:1}}e.AudioSoundChannel=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(59),a=i(8),n=i(6),o=i(0);class l extends s.SoundChannel{constructor(){super(),this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this.context=o.ILaya.WebAudioSound.ctx,this._onPlayEnd=n.Utils.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}play(){if(o.ILaya.SoundManager.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){if(this.startTime>=this.duration)return stop();var t=this.context,e=this.gain,i=t.createBufferSource();this.bufferSource=i,i.buffer=this.audioBuffer,i.connect(e),e&&e.disconnect(),e.connect(t.destination),i.onended=this._onPlayEnd,this._startTime=a.Browser.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,l.SetTargetDelay):this.gain.gain.value=this._volume,0==this.loops&&(i.loop=!0),i.playbackRate.setTargetAtTime?i.playbackRate.setTargetAtTime(o.ILaya.SoundManager.playbackRate,this.context.currentTime,l.SetTargetDelay):i.playbackRate.value=o.ILaya.SoundManager.playbackRate,i.start(0,this.startTime),this._currentTime=0}}__onPlayEnd(){if(1==this.loops)return this.completeHandler&&(o.ILaya.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(r.Event.COMPLETE);this.loops>0&&this.loops--,this.startTime=0,this.play()}get position(){return this.bufferSource?(a.Browser.now()-this._startTime)/1e3+this.startTime:0}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}_clearBufferSource(){if(this.bufferSource){var t=this.bufferSource;t.stop?t.stop(0):t.noteOff(0),t.disconnect(0),t.onended=null,l._tryCleanFailed||this._tryClearBuffer(t),this.bufferSource=null}}_tryClearBuffer(t){if(a.Browser.onMac)try{t.buffer=o.ILaya.WebAudioSound._miniBuffer}catch(t){l._tryCleanFailed=!0}else try{t.buffer=null}catch(t){l._tryCleanFailed=!0}}stop(){super.stop(),this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,o.ILaya.SoundManager.removeChannel(this),this.completeHandler=null,o.ILaya.SoundManager.autoReleaseSound&&o.ILaya.SoundManager.disposeSoundLater(this.url)}pause(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,o.ILaya.SoundManager.removeChannel(this),o.ILaya.SoundManager.autoReleaseSound&&o.ILaya.SoundManager.disposeSoundLater(this.url)}resume(){this.startTime=this._pauseTime,this.play()}set volume(t){this._volume=t,this.isStopped||(this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(t,this.context.currentTime,l.SetTargetDelay):this.gain.gain.value=t)}get volume(){return this._volume}}e.WebAudioSoundChannel=l,l._tryCleanFailed=!1,l.SetTargetDelay=.001},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0);e.Prefab=class{create(){return this.json?r.ILaya.SceneUtils.createByData(null,this.json):null}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(4);class s{constructor(t=null){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,t?(this._u8d_=new Uint8Array(t),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this._resizeBuffer(this._allocated_)}static getSystemEndian(){if(!s._sysEndian){var t=new ArrayBuffer(2);new DataView(t).setInt16(0,256,!0),s._sysEndian=256===new Int16Array(t)[0]?s.LITTLE_ENDIAN:s.BIG_ENDIAN}return s._sysEndian}get buffer(){var t=this._d_.buffer;return t.byteLength===this._length?t:t.slice(0,this._length)}get endian(){return this._xd_?s.LITTLE_ENDIAN:s.BIG_ENDIAN}set endian(t){this._xd_=t===s.LITTLE_ENDIAN}set length(t){this._allocated_<t?this._resizeBuffer(this._allocated_=Math.floor(Math.max(t,2*this._allocated_))):this._allocated_>t&&this._resizeBuffer(this._allocated_=t),this._length=t}get length(){return this._length}_resizeBuffer(t){try{var e=new Uint8Array(t);null!=this._u8d_&&(this._u8d_.length<=t?e.set(this._u8d_):e.set(this._u8d_.subarray(0,t))),this._u8d_=e,this._d_=new DataView(e.buffer)}catch(e){throw"Invalid typed array length:"+t}}getString(){return this.readString()}readString(){return this._rUTF(this.getUint16())}getFloat32Array(t,e){return this.readFloat32Array(t,e)}readFloat32Array(t,e){var i=t+e;i=i>this._length?this._length:i;var r=new Float32Array(this._d_.buffer.slice(t,i));return this._pos_=i,r}getUint8Array(t,e){return this.readUint8Array(t,e)}readUint8Array(t,e){var i=t+e;i=i>this._length?this._length:i;var r=new Uint8Array(this._d_.buffer.slice(t,i));return this._pos_=i,r}getInt16Array(t,e){return this.readInt16Array(t,e)}readInt16Array(t,e){var i=t+e;i=i>this._length?this._length:i;var r=new Int16Array(this._d_.buffer.slice(t,i));return this._pos_=i,r}getFloat32(){return this.readFloat32()}readFloat32(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var t=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,t}getFloat64(){return this.readFloat64()}readFloat64(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var t=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,t}writeFloat32(t){this._ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,t,this._xd_),this._pos_+=4}writeFloat64(t){this._ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,t,this._xd_),this._pos_+=8}getInt32(){return this.readInt32()}readInt32(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var t=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,t}getUint32(){return this.readUint32()}readUint32(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var t=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,t}writeInt32(t){this._ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,t,this._xd_),this._pos_+=4}writeUint32(t){this._ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,t,this._xd_),this._pos_+=4}getInt16(){return this.readInt16()}readInt16(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var t=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,t}getUint16(){return this.readUint16()}readUint16(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var t=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,t}writeUint16(t){this._ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,t,this._xd_),this._pos_+=2}writeInt16(t){this._ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,t,this._xd_),this._pos_+=2}getUint8(){return this.readUint8()}readUint8(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]}writeUint8(t){this._ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,t),this._pos_++}_getUInt8(t){return this._readUInt8(t)}_readUInt8(t){return this._d_.getUint8(t)}_getUint16(t){return this._readUint16(t)}_readUint16(t){return this._d_.getUint16(t,this._xd_)}_getMatrix(){return this._readMatrix()}_readMatrix(){return new r.Matrix(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())}_rUTF(t){var e,i,r=this._pos_+t,s=String.fromCharCode,a=this._u8d_,n=[],o=0;for(n.length=1e3;this._pos_<r;){if((e=a[this._pos_++])<128)0!=e&&(n[o++]=s(e));else if(e<224)n[o++]=s((63&e)<<6|127&a[this._pos_++]);else if(e<240)i=a[this._pos_++],n[o++]=s((31&e)<<12|(127&i)<<6|127&a[this._pos_++]);else{const t=(15&e)<<18|(127&(i=a[this._pos_++]))<<12|(127&a[this._pos_++])<<6|127&a[this._pos_++];if(t>=65536){const e=t-65536,i=55296|e>>10,r=56320|1023&e;n[o++]=s(i),n[o++]=s(r)}else n[o++]=s(t)}0}return n.length=o,n.join("")}getCustomString(t){return this.readCustomString(t)}readCustomString(t){for(var e,i="",r=0,s=String.fromCharCode,a=this._u8d_;t>0;)if((e=a[this._pos_])<128)i+=s(e),this._pos_++,t--;else for(r=e-128,this._pos_++,t-=r;r>0;)e=a[this._pos_++],i+=s(a[this._pos_++]<<8|e),r--;return i}get pos(){return this._pos_}set pos(t){this._pos_=t}get bytesAvailable(){return this._length-this._pos_}clear(){this._pos_=0,this.length=0}__getBuffer(){return this._d_.buffer}writeUTFBytes(t){for(var e=0,i=(t+="").length;e<i;e++){var r=t.charCodeAt(e);if(r<=127)this.writeByte(r);else if(r<=2047)this._ensureWrite(this._pos_+2),this._u8d_.set([192|r>>6,128|63&r],this._pos_),this._pos_+=2;else if(r>=55296&&r<=56319){e++;const i=t.charCodeAt(e);if(!Number.isNaN(i)&&i>=56320&&i<=57343){const t=64+(1023&r),e=1023&i,s=240|t>>8&63,a=128|t>>2&63,n=128|(3&t)<<4|e>>6&15,o=128|63&e;this._ensureWrite(this._pos_+4),this._u8d_.set([s,a,n,o],this._pos_),this._pos_+=4}}else r<=65535?(this._ensureWrite(this._pos_+3),this._u8d_.set([224|r>>12,128|r>>6&63,128|63&r],this._pos_),this._pos_+=3):(this._ensureWrite(this._pos_+4),this._u8d_.set([240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r],this._pos_),this._pos_+=4)}}writeUTFString(t){var e=this.pos;this.writeUint16(1),this.writeUTFBytes(t);var i=this.pos-e-2;this._d_.setUint16(e,i,this._xd_)}readUTFString(){return this.readUTFBytes(this.getUint16())}getUTFString(){return this.readUTFString()}readUTFBytes(t=-1){if(0===t)return"";var e=this.bytesAvailable;if(t>e)throw"readUTFBytes error - Out of bounds";return t=t>0?t:e,this._rUTF(t)}getUTFBytes(t=-1){return this.readUTFBytes(t)}writeByte(t){this._ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,t),this._pos_+=1}readByte(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)}getByte(){return this.readByte()}_ensureWrite(t){this._length<t&&(this._length=t),this._allocated_<t&&(this.length=t)}writeArrayBuffer(t,e=0,i=0){if(e<0||i<0)throw"writeArrayBuffer error - Out of bounds";0==i&&(i=t.byteLength-e),this._ensureWrite(this._pos_+i);var r=new Uint8Array(t);this._u8d_.set(r.subarray(e,e+i),this._pos_),this._pos_+=i}readArrayBuffer(t){var e;return e=this._u8d_.buffer.slice(this._pos_,this._pos_+t),this._pos_=this._pos_+t,e}}e.Byte=s,s.BIG_ENDIAN="bigEndian",s.LITTLE_ENDIAN="littleEndian",s._sysEndian=null},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(10),s=i(17),a=i(16),n=i(0),o=i(9);class l{constructor(){this._fontCharDic={},this._fontWidthMap={},this._maxWidth=0,this._spaceWidth=10,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}loadFont(t,e){this._path=t,this._complete=e,t&&-1!==t.indexOf(".fnt")?n.ILaya.loader.load([{url:t,type:n.ILaya.Loader.XML},{url:t.replace(".fnt",".png"),type:n.ILaya.Loader.IMAGE}],a.Handler.create(this,this._onLoaded)):console.error('Bitmap font configuration information must be a ".fnt" file')}_onLoaded(){this.parseFont(n.ILaya.Loader.getRes(this._path),n.ILaya.Loader.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.run()}parseFont(t,e){if(null!=t&&null!=e){this._texture=e;var i=t.getElementsByTagName("info");if(!i[0].getAttributeNode)return this.parseFont2(t,e);this.fontSize=parseInt(i[0].getAttributeNode("size").nodeValue);var a=i[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];var n=t.getElementsByTagName("char"),o=0;for(o=0;o<n.length;o++){var l=n[o],h=parseInt(l.getAttributeNode("id").nodeValue),u=parseInt(l.getAttributeNode("xoffset").nodeValue)/1,c=parseInt(l.getAttributeNode("yoffset").nodeValue)/1,_=parseInt(l.getAttributeNode("xadvance").nodeValue)/1,d=new r.Rectangle;d.x=parseInt(l.getAttributeNode("x").nodeValue),d.y=parseInt(l.getAttributeNode("y").nodeValue),d.width=parseInt(l.getAttributeNode("width").nodeValue),d.height=parseInt(l.getAttributeNode("height").nodeValue);var f=s.Texture.create(e,d.x,d.y,d.width,d.height,u,c);this._maxWidth=Math.max(this._maxWidth,_+this.letterSpacing),this._fontCharDic[h]=f,this._fontWidthMap[h]=_}}}parseFont2(t,e){if(null!=t&&null!=e){this._texture=e;var i=t.getElementsByTagName("info");this.fontSize=parseInt(i[0].attributes.size.nodeValue);var a=i[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];var n=t.getElementsByTagName("char"),o=0;for(o=0;o<n.length;o++){var l=n[o].attributes,h=parseInt(l.id.nodeValue),u=parseInt(l.xoffset.nodeValue)/1,c=parseInt(l.yoffset.nodeValue)/1,_=parseInt(l.xadvance.nodeValue)/1,d=new r.Rectangle;d.x=parseInt(l.x.nodeValue),d.y=parseInt(l.y.nodeValue),d.width=parseInt(l.width.nodeValue),d.height=parseInt(l.height.nodeValue);var f=s.Texture.create(e,d.x,d.y,d.width,d.height,u,c);this._maxWidth=Math.max(this._maxWidth,_+this.letterSpacing),this._fontCharDic[h]=f,this._fontWidthMap[h]=_}}}getCharTexture(t){return this._fontCharDic[t.charCodeAt(0)]}destroy(){if(this._texture){for(var t in this._fontCharDic){var e=this._fontCharDic[t];e&&e.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null,this._complete=null,this._padding=null}}setSpaceWidth(t){this._spaceWidth=t}getCharWidth(t){var e=t.charCodeAt(0);return this._fontWidthMap[e]?this._fontWidthMap[e]+this.letterSpacing:" "===t?this._spaceWidth+this.letterSpacing:0}getTextWidth(t){for(var e=0,i=0,r=t.length;i<r;i++)e+=this.getCharWidth(t.charAt(i));return e}getMaxWidth(){return this._maxWidth}getMaxHeight(){return this.fontSize}_drawText(t,e,i,r,s,a){var n,o=this.getTextWidth(t),l=0;"center"===s&&(l=(a-o)/2),"right"===s&&(l=a-o);for(var h=0,u=0,c=t.length;u<c;u++)(n=this.getCharTexture(t.charAt(u)))&&(e.graphics.drawImage(n,i+h+l,r),h+=this.getCharWidth(t.charAt(u)))}}e.BitmapFont=l,o.ClassUtils.regClass("laya.display.BitmapFont",l),o.ClassUtils.regClass("Laya.BitmapFont",l)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(2),a=i(12),n=i(14),o=i(24),l=i(17),h=i(16),u=i(6),c=i(163),_=i(29);class d extends a.EventDispatcher{constructor(){super(),this.retryNum=1,this.retryDelay=0,this.maxLoader=5,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},this._statInfo={count:1,loaded:1};for(var t=0;t<this._maxPriority;t++)this._resInfos[t]=[]}getProgress(){return this._statInfo.loaded/this._statInfo.count}resetProgress(){this._statInfo.count=this._statInfo.loaded=1}create(t,e=null,i=null,r=null,s=null,a=null,n=1,o=!0){this._create(t,!0,e,i,r,s,a,n,o)}_create(t,e,i=null,r=null,s=null,a=null,n=null,o=1,l=!0){if(t instanceof Array){var u=!0,c=t,_=c.length,d=0;if(r)var f=h.Handler.create(r.caller,r?r.method:null,r.args,!1);for(var p=0;p<_;p++){var m=c[p];"string"==typeof m&&(m=c[p]={url:m}),m.progress=0}for(p=0;p<_;p++){m=c[p];var g=r?h.Handler.create(null,(function(t,e){t.progress=e;for(var i=0,r=0;r<_;r++){i+=c[r].progress}var s=i/_;f.runWith(s)}),[m],!1):null,v=r||i?h.Handler.create(null,(function(t,e=null){d++,t.progress=1,e||(u=!1),d===_&&i&&i.runWith(u)}),[m]):null;this._createOne(m.url,e,v,g,m.type||s,m.constructParams||a,m.propertyParams||n,m.priority||o,l)}}else this._createOne(t,e,i,r,s,a,n,o,l)}_createOne(t,e,i=null,s=null,a=null,n=null,l=null,c=1,f=!0){var p=this.getRes(t);if(p)!e&&p instanceof o.Resource&&p._addReference(),s&&s.runWith(1),i&&i.runWith(p);else{var m=u.Utils.getFileExtension(t);if(a||(a=d.createMap[m]?d.createMap[m][0]:null),!a)return void this.load(t,i,s,a,c,f);if(!_.Loader.parserMap[a])return void this.load(t,i,s,a,c,f);this._createLoad(t,h.Handler.create(null,(function(s){s&&(!e&&s instanceof o.Resource&&s._addReference(),s._setCreateURL(t)),i&&i.runWith(s),r.ILaya.loader.event(t)})),s,a,n,l,c,f,!0)}}load(t,e=null,i=null,a=null,o=1,l=!0,h=null,u=!1,p=r.ILaya.WorkerLoader.enable){if(t instanceof Array)return this._loadAssets(t,e,i,a,o,l,h);var m;if(m=a===_.Loader.IMAGE?_.Loader.textureMap[n.URL.formatURL(t)]:_.Loader.loadedMap[n.URL.formatURL(t)],u||null==m){var g;g=t,(t=c.AtlasInfoManager.getFileLoadPath(t))!=g&&"nativeimage"!==a?a=_.Loader.ATLAS:g=null;var v=d._resMap[t];v?(e&&(g?e&&v._createListener(s.Event.COMPLETE,this,this._resInfoLoaded,[g,e],!1,!1):e&&v._createListener(s.Event.COMPLETE,e.caller,e.method,e.args,!1,!1)),i&&v._createListener(s.Event.PROGRESS,i.caller,i.method,i.args,!1,!1)):((v=this._infoPool.length?this._infoPool.pop():new f).url=t,v.type=a,v.cache=l,v.group=h,v.ignoreCache=u,v.useWorkerLoader=p,v.originalUrl=g,e&&v.on(s.Event.COMPLETE,e.caller,e.method,e.args),i&&v.on(s.Event.PROGRESS,i.caller,i.method,i.args),d._resMap[t]=v,o=o<this._maxPriority?o:this._maxPriority-1,this._resInfos[o].push(v),this._statInfo.count++,this.event(s.Event.PROGRESS,this.getProgress()),this._next())}else r.ILaya.systemTimer.frameOnce(1,this,(function(){i&&i.runWith(1),e&&e.runWith(m instanceof Array?[m]:m),this._loaderCount||this.event(s.Event.COMPLETE)}));return this}_resInfoLoaded(t,e){e.runWith(_.Loader.getRes(t))}_createLoad(t,e=null,i=null,a=null,n=null,o=null,l=1,h=!0,u=!1){if(t instanceof Array)return this._loadAssets(t,e,i,a,l,h);var c=_.Loader.getRes(t);if(null!=c)r.ILaya.systemTimer.frameOnce(1,this,(function(){i&&i.runWith(1),e&&e.runWith(c),this._loaderCount||this.event(s.Event.COMPLETE)}));else{var p=d._resMap[t];p?(e&&p._createListener(s.Event.COMPLETE,e.caller,e.method,e.args,!1,!1),i&&p._createListener(s.Event.PROGRESS,i.caller,i.method,i.args,!1,!1)):((p=this._infoPool.length?this._infoPool.pop():new f).url=t,p.type=a,p.cache=!1,p.ignoreCache=u,p.originalUrl=null,p.group=null,p.createCache=h,p.createConstructParams=n,p.createPropertyParams=o,e&&p.on(s.Event.COMPLETE,e.caller,e.method,e.args),i&&p.on(s.Event.PROGRESS,i.caller,i.method,i.args),d._resMap[t]=p,l=l<this._maxPriority?l:this._maxPriority-1,this._resInfos[l].push(p),this._statInfo.count++,this.event(s.Event.PROGRESS,this.getProgress()),this._next())}return this}_next(){if(!(this._loaderCount>=this.maxLoader)){for(var t=0;t<this._maxPriority;t++)for(var e=this._resInfos[t];e.length>0;){var i=e.shift();if(i)return this._doLoad(i)}this._loaderCount||this.event(s.Event.COMPLETE)}}_doLoad(t){this._loaderCount++;var e=this._loaders.length?this._loaders.pop():new _.Loader;e.on(s.Event.COMPLETE,null,r),e.on(s.Event.PROGRESS,null,(function(e){t.event(s.Event.PROGRESS,e)})),e.on(s.Event.ERROR,null,(function(t){r(null)}));var i=this;function r(r=null){e.offAll(),e._data=null,e._customParse=!1,i._loaders.push(e),i._endLoad(t,r instanceof Array?[r]:r),i._loaderCount--,i._next()}e._constructParams=t.createConstructParams,e._propertyParams=t.createPropertyParams,e._createCache=t.createCache,e.load(t.url,t.type,t.cache,t.group,t.ignoreCache,t.useWorkerLoader)}_endLoad(t,e){var i=t.url;if(null==e){var a=this._failRes[i]||0;if(a<this.retryNum)return console.warn("[warn]Retry to load:",i),this._failRes[i]=a+1,void r.ILaya.systemTimer.once(this.retryDelay,this,this._addReTry,[t],!1);_.Loader.clearRes(i),console.warn("[error]Failed to load:",i),this.event(s.Event.ERROR,i)}this._failRes[i]&&(this._failRes[i]=0),delete d._resMap[i],t.originalUrl&&(e=_.Loader.getRes(t.originalUrl)),t.event(s.Event.COMPLETE,e),t.offAll(),this._infoPool.push(t),this._statInfo.loaded++,this.event(s.Event.PROGRESS,this.getProgress())}_addReTry(t){this._resInfos[this._maxPriority-1].push(t),this._next()}clearRes(t){_.Loader.clearRes(t)}clearTextureRes(t){_.Loader.clearTextureRes(t)}getRes(t){return _.Loader.getRes(t)}cacheRes(t,e){_.Loader.cacheRes(t,e)}setGroup(t,e){_.Loader.setGroup(t,e)}clearResByGroup(t){_.Loader.clearResByGroup(t)}static cacheRes(t,e){_.Loader.cacheRes(t,e)}clearUnLoaded(){for(var t=0;t<this._maxPriority;t++){for(var e=this._resInfos[t],i=e.length-1;i>-1;i--){var r=e[i];r&&(r.offAll(),this._infoPool.push(r))}e.length=0}this._loaderCount=0,d._resMap={}}cancelLoadByUrls(t){if(t)for(var e=0,i=t.length;e<i;e++)this.cancelLoadByUrl(t[e])}cancelLoadByUrl(t){for(var e=0;e<this._maxPriority;e++)for(var i=this._resInfos[e],r=i.length-1;r>-1;r--){var s=i[r];s&&s.url===t&&(i[r]=null,s.offAll(),this._infoPool.push(s))}d._resMap[t]&&delete d._resMap[t]}_loadAssets(t,e=null,i=null,r=null,s=1,a=!0,n=null){for(var o=t.length,l=0,u=0,c=[],_=!0,d=0;d<o;d++){let o,l=t[d];o="string"==typeof l?{url:l,type:r,size:1,priority:s}:l,o.size||(o.size=1),o.progress=0,u+=o.size,c.push(o);var f=i?h.Handler.create(null,g,[o],!1):null,p=e||i?h.Handler.create(null,m,[o]):null;this.load(o.url,p,f,o.type,o.priority||1,a,o.group||n,!1,o.useWorkerLoader)}function m(t,i=null){l++,t.progress=1,i||(_=!1),l===o&&e&&e.runWith(_)}function g(t,e){if(null!=i){t.progress=e;for(var r=0,s=0;s<c.length;s++){var a=c[s];if(a){let t=null==a.progress?0:a.progress;r+=null==a.size?0:a.size*t}}var n=r/u;i.runWith(n)}}return this}decodeBitmaps(t){var e,i,s=t.length;for(i=r.ILaya.Render._context,e=0;e<s;e++){var a,n;if(a=_.Loader.getAtlas(t[e]))this._decodeTexture(a[0],i);else(n=this.getRes(t[e]))&&n instanceof l.Texture&&this._decodeTexture(n,i)}}_decodeTexture(t,e){var i=t.bitmap;if(t&&i){var r=i.source||i.image;if(r&&r instanceof HTMLImageElement){e.drawImage(r,0,0,1,1);e.getImageData(0,0,1,1)}}}}e.LoaderManager=d,d._resMap={},d.createMap={atlas:[null,_.Loader.ATLAS]};class f extends a.EventDispatcher{}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(16),s=i(0),a=i(29);class n{static enable(t,e=null){s.ILaya.loader.load(t,r.Handler.create(null,n._onInfoLoaded,[e]),null,a.Loader.JSON)}static _onInfoLoaded(t,e){var i,r,s,a,o;for(i in e)for(r=(s=e[i])[0],o=(s=s[1]).length,a=0;a<o;a++)n._fileLoadDic[r+s[a]]=i;t&&t.run()}static getFileLoadPath(t){return n._fileLoadDic[t]||t}}e.AtlasInfoManager=n,n._fileLoadDic={}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static __init__(){return r._baseClass||(r._baseClass=s,s.init()),r.items=r._baseClass.items,r.support=r._baseClass.support,r.support}static setItem(t,e){r._baseClass.setItem(t,e)}static getItem(t){return r._baseClass.getItem(t)}static setJSON(t,e){r._baseClass.setJSON(t,e)}static getJSON(t){return r._baseClass.getJSON(t)}static removeItem(t){r._baseClass.removeItem(t)}static clear(){r._baseClass.clear()}}e.LocalStorage=r,r.support=!1;class s{static init(){try{s.support=!0,s.items=window.localStorage,s.setItem("laya","1"),s.removeItem("laya")}catch(t){s.support=!1}s.support||console.log("LocalStorage is not supprot or browser is private mode.")}static setItem(t,e){try{s.support&&s.items.setItem(t,e)}catch(t){console.warn("set localStorage failed",t)}}static getItem(t){return s.support?s.items.getItem(t):null}static setJSON(t,e){try{s.support&&s.items.setItem(t,JSON.stringify(e))}catch(t){console.warn("set localStorage failed",t)}}static getJSON(t){return JSON.parse(s.support?s.items.getItem(t):null)}static removeItem(t){s.support&&s.items.removeItem(t)}static clear(){s.support&&s.items.clear()}}s.support=!1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0),s=i(2),a=i(8),n=i(104),o=i(29);class l{load(t){this._url=t;var e=t.split(".ttf")[0].split("/");this.fontName=e[e.length-1],r.ILaya.Render.isConchApp?this._loadConch():window.FontFace?this._loadWithFontFace():this._loadWithCSS()}_loadConch(){this._http=new n.HttpRequest,this._http.on(s.Event.ERROR,this,this._onErr),this._http.on(s.Event.COMPLETE,this,this._onHttpLoaded),this._http.send(this._url,null,"get",o.Loader.BUFFER)}_onHttpLoaded(t=null){window.conchTextCanvas.setFontFaceFromBuffer(this.fontName,t),this._clearHttp(),this._complete()}_clearHttp(){this._http&&(this._http.off(s.Event.ERROR,this,this._onErr),this._http.off(s.Event.COMPLETE,this,this._onHttpLoaded),this._http=null)}_onErr(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)}_complete(){r.ILaya.systemTimer.clear(this,this._complete),r.ILaya.systemTimer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)}_checkComplete(){r.ILaya.Browser.measureText(l._testString,this._fontTxt).width!=this._txtWidth&&this._complete()}_loadWithFontFace(){var t=new window.FontFace(this.fontName,"url('"+this._url+"')");document.fonts.add(t);var e=this;t.loaded.then((function(){e._complete()})),t.load()}_createDiv(){this._div=a.Browser.createElement("div"),this._div.innerHTML="laya";var t=this._div.style;t.fontFamily=this.fontName,t.position="absolute",t.left="-100px",t.top="-100px",document.body.appendChild(this._div)}_loadWithCSS(){var t=a.Browser.createElement("style");t.type="text/css",document.body.appendChild(t),t.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=a.Browser.measureText(l._testString,this._fontTxt).width;var e=this;t.onload=function(){r.ILaya.systemTimer.once(1e4,e,this._complete)},r.ILaya.systemTimer.loop(20,this,this._checkComplete),this._createDiv()}}e.TTFLoader=l,l._testString="LayaTTFFont"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(58),a=i(0),n=i(105),o=i(16),l=i(167);e.Dragging=class{constructor(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}start(t,e,i,s,n,o,l,h=.92){this.clearTimer(),this.target=t,this.area=e,this.hasInertia=i,this.elasticDistance=e?s:0,this.elasticBackTime=n,this.data=o,this._disableMouseEvent=l,this.ratio=h,this._parent=t.parent,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,a.ILaya.stage.on(r.Event.MOUSE_UP,this,this.onStageMouseUp),a.ILaya.stage.on(r.Event.MOUSE_OUT,this,this.onStageMouseUp),a.ILaya.systemTimer.frameLoop(1,this,this.loop)}clearTimer(){a.ILaya.systemTimer.clear(this,this.loop),a.ILaya.systemTimer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)}stop(){this._dragging&&(s.MouseManager.instance.disableMouseEvent=!1,a.ILaya.stage.off(r.Event.MOUSE_UP,this,this.onStageMouseUp),a.ILaya.stage.off(r.Event.MOUSE_OUT,this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())}loop(){var t=this._parent.getMousePoint(),e=t.x,i=t.y,n=e-this._lastX,o=i-this._lastY;if(this._clickOnly){if(!(Math.abs(n*a.ILaya.stage._canvasTransform.getScaleX())>1||Math.abs(o*a.ILaya.stage._canvasTransform.getScaleY())>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event(r.Event.DRAG_START,this.data),s.MouseManager.instance.disableMouseEvent=this._disableMouseEvent}else this._offsets.push(n,o);0===n&&0===o||(this._lastX=e,this._lastY=i,this.target.x+=n*this._elasticRateX,this.target.y+=o*this._elasticRateY,this.area&&this.checkArea(),this.target.event(r.Event.DRAG_MOVE,this.data))}checkArea(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target._x<this.area.x)var t=this.area.x-this.target._x;else t=this.target._x>this.area.x+this.area.width?this.target._x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-t/this.elasticDistance),this.target._y<this.area.y)var e=this.area.y-this.target.y;else e=this.target._y>this.area.y+this.area.height?this.target._y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-e/this.elasticDistance)}}backToArea(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height)}onStageMouseUp(t){if(s.MouseManager.instance.disableMouseEvent=!1,a.ILaya.stage.off(r.Event.MOUSE_UP,this,this.onStageMouseUp),a.ILaya.stage.off(r.Event.MOUSE_OUT,this,this.onStageMouseUp),a.ILaya.systemTimer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var e=this._offsets.length,i=Math.min(e,6),n=this._offsets.length-i,o=e-1;o>n;o--)this._offsetY+=this._offsets[o--],this._offsetX+=this._offsets[o];this._offsetX=this._offsetX/i*2,this._offsetY=this._offsetY/i*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset),a.ILaya.systemTimer.frameLoop(1,this,this.tweenMove)}else this.elasticDistance>0?this.checkElastic():this.clear()}checkElastic(){var t=NaN,e=NaN;if(this.target.x<this.area.x?t=this.area.x:this.target._x>this.area.x+this.area.width&&(t=this.area.x+this.area.width),this.target.y<this.area.y?e=this.area.y:this.target._y>this.area.y+this.area.height&&(e=this.area.y+this.area.height),isNaN(t)&&isNaN(e))this.clear();else{var i={};isNaN(t)||(i.x=t),isNaN(e)||(i.y=e),this._tween=l.Tween.to(this.target,i,this.elasticBackTime,n.Ease.sineOut,o.Handler.create(this,this.clear),0,!1,!1)}}tweenMove(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event(r.Event.DRAG_MOVE,this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(a.ILaya.systemTimer.clear(this,this.tweenMove),this.elasticDistance>0?this.checkElastic():this.clear())}clear(){if(this.target){this.clearTimer();var t=this.target;this.target=null,this._parent=null,t.event(r.Event.DRAG_END,this.data)}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1),s=i(8),a=i(6),n=i(0);class o{constructor(){this.gid=0,this.repeat=1,this._count=0}static to(t,e,i,s=null,a=null,n=0,l=!1,h=!0){return r.Pool.getItemByClass("tween",o)._create(t,e,i,s,a,n,l,!0,h,!0)}static from(t,e,i,s=null,a=null,n=0,l=!1,h=!0){return r.Pool.getItemByClass("tween",o)._create(t,e,i,s,a,n,l,!1,h,!0)}to(t,e,i,r=null,s=null,a=0,n=!1){return this._create(t,e,i,r,s,a,n,!0,!1,!0)}from(t,e,i,r=null,s=null,a=0,n=!1){return this._create(t,e,i,r,s,a,n,!1,!1,!0)}_create(t,e,i,r,l,h,u,c,_,d){if(!t)throw new Error("Tween:target is null");this._target=t,this._duration=i,this._ease=r||e.ease||o.easeNone,this._complete=l||e.complete,this._delay=h,this._props=[],this._usedTimer=0,this._startTimer=s.Browser.now(),this._usedPool=_,this._delayParam=null,this.update=e.update;var f=t.$_GID||(t.$_GID=a.Utils.getGID());return o.tweenMap[f]?(u&&o.clearTween(t),o.tweenMap[f].push(this)):o.tweenMap[f]=[this],d?h<=0?this.firstStart(t,e,c):(this._delayParam=[t,e,c],n.ILaya.timer.once(h,this,this.firstStart,this._delayParam)):this._initProps(t,e,c),this}firstStart(t,e,i){this._delayParam=null,t.destroyed?this.clear():(this._initProps(t,e,i),this._beginLoop())}_initProps(t,e,i){for(var r in e)if("number"==typeof t[r]){var s=i?t[r]:e[r],a=i?e[r]:t[r];this._props.push([r,s,a-s]),i||(t[r]=s)}}_beginLoop(){n.ILaya.timer.frameLoop(1,this,this._doEase)}_doEase(){this._updateEase(s.Browser.now())}_updateEase(t){var e=this._target;if(e){if(e.destroyed)return o.clearTween(e);var i=this._usedTimer=t-this._startTimer-this._delay;if(!(i<0)){if(i>=this._duration)return this.complete();for(var r=i>0?this._ease(i,0,1,this._duration):0,s=this._props,a=0,n=s.length;a<n;a++){var l=s[a];e[l[0]]=l[1]+r*l[2]}this.update&&this.update.run()}}}set progress(t){var e=t*this._duration;this._startTimer=s.Browser.now()-this._delay-e}complete(){if(this._target){n.ILaya.timer.runTimer(this,this.firstStart);for(var t=this._target,e=this._props,i=this._complete,r=0,s=e.length;r<s;r++){var a=e[r];t[a[0]]=a[1]+a[2]}this.update&&this.update.run(),this._count++,0!=this.repeat&&this._count>=this.repeat?(this.clear(),i&&i.run()):this.restart()}}pause(){var t;n.ILaya.timer.clear(this,this._beginLoop),n.ILaya.timer.clear(this,this._doEase),n.ILaya.timer.clear(this,this.firstStart),(t=s.Browser.now()-this._startTimer-this._delay)<0&&(this._usedTimer=t)}setStartTime(t){this._startTimer=t}static clearAll(t){if(t&&t.$_GID){var e=o.tweenMap[t.$_GID];if(e){for(var i=0,r=e.length;i<r;i++)e[i]._clear();e.length=0}}}static clear(t){t.clear()}static clearTween(t){o.clearAll(t)}clear(){this._target&&(this._remove(),this._clear())}_clear(){this.pause(),n.ILaya.timer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this.repeat=1,this._usedPool&&(this.update=null,r.Pool.recover("tween",this))}recover(){this._usedPool=!0,this._clear()}_remove(){var t=o.tweenMap[this._target.$_GID];if(t)for(var e=0,i=t.length;e<i;e++)if(t[e]===this){t.splice(e,1);break}}restart(){if(this.pause(),this._usedTimer=0,this._startTimer=s.Browser.now(),this._delayParam)n.ILaya.timer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var t=this._props,e=0,i=t.length;e<i;e++){var r=t[e];this._target[r[0]]=r[1]}n.ILaya.timer.once(this._delay,this,this._beginLoop)}}resume(){this._usedTimer>=this._duration||(this._startTimer=s.Browser.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?n.ILaya.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())}static easeNone(t,e,i,r){return i*t/r+e}}e.Tween=o,o.tweenMap=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1),s=i(22),a=i(106),n=i(169),o=i(57),l=i(60);class h{static __init(){h._funMap=new l.WeakObject}static getBindFun(t){var e=h._funMap.get(t);if(null==e){var i='"'+t+'"',r="(function(data){if(data==null)return;with(data){try{\nreturn "+(i=i.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";e=window.Laya._runScript(r),h._funMap.set(t,e)}return e}static createByData(t,e){var i=f.create();if((t=h.createComp(e,t,t,null,i))._setBit(s.Const.NOT_READY,!0),"_idMap"in t&&(t._idMap=i._idMap),e.animations){var r,a,o,l=[],u=e.animations,c=u.length;for(r=0;r<c;r++){switch(a=new n.FrameAnimation,o=u[r],a._setUp(i._idMap,o),t[o.name]=a,a._setControlNode(t),o.action){case 1:a.play(0,!1);break;case 2:a.play(0,!0)}l.push(a)}t._aniList=l}return"Scene"===t._$componentType&&t._width>0&&null==e.props.hitTestPrior&&!t.mouseThrough&&(t.hitTestPrior=!0),i.beginLoad(t),t}static createInitTool(){return f.create()}static createComp(t,e=null,i=null,r=null,s=null){if("Scene3D"==t.type||"Sprite3D"==t.type){var n=[],l=_.ILaya.Laya.Utils3D._createSceneByJsonForMaker(t,n,s);return"Sprite3D"==t.type?_.ILaya.Laya.StaticBatchManager.combine(l,n):_.ILaya.Laya.StaticBatchManager.combine(null,n),l}if(!(e=e||h.getCompInstance(t)))return t.props&&t.props.runtime?console.warn("runtime not found:"+t.props.runtime):console.warn("can not create:"+t.type),null;var u=t.child;if(u)for(var c="List"==e._$componentType,d=0,f=u.length;d<f;d++){var p=u[d];if("itemRender"in e&&("render"==p.props.name||"render"===p.props.renderType))e.itemRender=p;else if("Graphic"==p.type)_.ILaya.ClassUtils._addGraphicsToSprite(p,e);else if(_.ILaya.ClassUtils._isDrawType(p.type))_.ILaya.ClassUtils._addGraphicToSprite(p,e,!0);else{if(c){var m=[],g=h.createComp(p,null,i,m,s);m.length&&(g._$bindData=m)}else g=h.createComp(p,null,i,r,s);"Script"==p.type?g instanceof a.Component?e._addComponentInstance(g):"owner"in g?g.owner=e:"target"in g&&(g.target=e):"mask"==p.props.renderType||"mask"==p.props.name?e.mask=g:g instanceof o.Node&&e.addChild(g)}}var v=t.props;for(var y in v){var x=v[y];"string"==typeof x&&(x.indexOf("@node:")>=0||x.indexOf("@Prefab:")>=0)?s&&s.addNodeRef(e,y,x):h.setCompValue(e,y,x,i,r)}return e._afterInited&&e._afterInited(),t.compId&&s&&s._idMap&&(s._idMap[t.compId]=e),e}static setCompValue(t,e,i,r=null,s=null){if("string"==typeof i&&i.indexOf("${")>-1){if(h._sheet||(h._sheet=_.ILaya.ClassUtils.getClass("laya.data.Table")),!h._sheet)return void console.warn("Can not find class Sheet");if(s)s.push(t,e,i);else if(r){-1==i.indexOf("].")&&(i=i.replace(".","[0]."));var a,n,o=new d(t,e,i);o.exe(r);for(var l=i.replace(/\[.*?\]\./g,".");null!=(a=h._parseWatchData.exec(l));){for(var u=a[1];null!=(n=h._parseKeyWord.exec(u));){var c=n[0],f=r._watchMap[c]||(r._watchMap[c]=[]);f.push(o),h._sheet.I.notifer.on(c,r,r.changeData,[c])}(f=r._watchMap[u]||(r._watchMap[u]=[])).push(o),h._sheet.I.notifer.on(u,r,r.changeData,[u])}}}else"var"===e&&r?r[i]=t:t[e]="true"===i||"false"!==i&&i}static getCompInstance(t){if("UIView"==t.type&&t.props&&t.props.pageData)return h.createByData(null,t.props.pageData);var e=t.props&&t.props.runtime||t.type,i=_.ILaya.ClassUtils.getClass(e);if(!i)throw"Can not find class "+e;if("Script"===t.type&&i.prototype._doAwake){var s=r.Pool.createByClass(i);return s._destroyed=!1,s}return t.props&&"renderType"in t.props&&"instance"==t.props.renderType?(i.instance||(i.instance=new i),i.instance):new i}}e.SceneUtils=h,h._parseWatchData=/\${(.*?)}/g,h._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;const u=i(29),c=i(16),_=i(0);class d{constructor(t,e,i){this.comp=t,this.prop=e,this.value=i}exe(t){var e=h.getBindFun(this.value);this.comp[this.prop]=e.call(this,t)}}class f{reset(){this._nodeRefList=null,this._initList=null,this._idMap=null,this._loadList=null,this._scene=null}recover(){this.reset(),r.Pool.recover("InitTool",this)}static create(){var t=r.Pool.getItemByClass("InitTool",f);return t._idMap=[],t}addLoadRes(t,e=null){this._loadList||(this._loadList=[]),e?this._loadList.push({url:t,type:e}):this._loadList.push(t)}addNodeRef(t,e,i){this._nodeRefList||(this._nodeRefList=[]),this._nodeRefList.push([t,e,i]),i.indexOf("@Prefab:")>=0&&this.addLoadRes(i.replace("@Prefab:",""),u.Loader.PREFAB)}setNodeRef(){if(this._nodeRefList)if(this._idMap){var t,e,i;for(e=this._nodeRefList.length,t=0;t<e;t++)(i=this._nodeRefList[t])[0][i[1]]=this.getReferData(i[2]);this._nodeRefList=null}else this._nodeRefList=null}getReferData(t){if(t.indexOf("@Prefab:")>=0)return u.Loader.getRes(t.replace("@Prefab:",""));if(t.indexOf("@arr:")>=0){var e,i,r,s;for(r=(e=(t=t.replace("@arr:","")).split(",")).length,i=0;i<r;i++)s=e[i],e[i]=s?this._idMap[s.replace("@node:","")]:null;return e}return this._idMap[t.replace("@node:","")]}addInitItem(t){this._initList||(this._initList=[]),this._initList.push(t)}doInits(){this._initList&&(this._initList=null)}finish(){this.setNodeRef(),this.doInits(),this._scene._setBit(s.Const.NOT_READY,!1),this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active&&this._scene._processActive(),this._scene.event("onViewCreated"),this.recover()}beginLoad(t){this._scene=t,!this._loadList||this._loadList.length<1?this.finish():_.ILaya.loader.load(this._loadList,c.Handler.create(this,this.finish))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(170),s=i(171),a=i(105),n=i(9);class o extends r.AnimationBase{constructor(){super(),null===o._sortIndexFun&&(o._sortIndexFun=s.MathUtil.sortByKey("index",!1,!0))}_setUp(t,e){this._targetDic=t,this._animationData=e,this.interval=1e3/e.frameRate,e.parsed?(this._count=e.count,this._labels=e.labels,this._usedFrames=e.animationNewFrames):(this._usedFrames=[],this._calculateDatas(),e.parsed=!0,e.labels=this._labels,e.count=this._count,e.animationNewFrames=this._usedFrames)}clear(){return super.clear(),this._targetDic=null,this._animationData=null,this}_displayToIndex(t){if(this._animationData){t<0&&(t=0),t>this._count&&(t=this._count);var e,i=this._animationData.nodes,r=i.length;for(e=0;e<r;e++)this._displayNodeToFrame(i[e],t)}}_displayNodeToFrame(t,e,i=null){i||(i=this._targetDic);var r=i[t.target];if(r){var s,a,n,o,l=t.frames,h=t.keys,u=h.length;for(o=0;o<u;o++)n=(a=l[s=h[o]]).length>e?a[e]:a[a.length-1],r[s]=n;var c,_=t.funkeys;if(0!=(u=_.length))for(o=0;o<u;o++)void 0!==(c=l[s=_[o]])[e]&&r[s]&&r[s].apply(r,c[e])}}_calculateDatas(){if(this._animationData){var t,e,i=this._animationData.nodes,r=i.length;for(this._count=0,t=0;t<r;t++)e=i[t],this._calculateKeyFrames(e);this._count+=1}}_calculateKeyFrames(t){var e,i,r=t.keyframes,s=t.target;for(e in t.frames||(t.frames={}),t.keys?t.keys.length=0:t.keys=[],t.funkeys?t.funkeys.length=0:t.funkeys=[],t.initValues||(t.initValues={}),r){var a=-1!=e.indexOf("()");if(i=r[e],a&&(e=e.substr(0,e.length-2)),t.frames[e]||(t.frames[e]=[]),a){t.funkeys.push(e);for(var n=t.frames[e],l=0;l<i.length;l++){var h=i[l];n[h.index]=h.value,h.index>this._count&&(this._count=h.index)}}else this._targetDic&&this._targetDic[s]&&(t.initValues[e]=this._targetDic[s][e]),i.sort(o._sortIndexFun),t.keys.push(e),this._calculateNodePropFrames(i,t.frames[e],e,s)}}resetNodes(){if(this._targetDic&&this._animationData){var t,e,i,r=this._animationData.nodes,s=r.length;for(t=0;t<s;t++)if(i=(e=r[t]).initValues){var a,n=this._targetDic[e.target];if(n)for(a in i)n[a]=i[a]}}}_calculateNodePropFrames(t,e,i,r){var s,a=t.length-1;for(e.length=t[a].index+1,s=0;s<a;s++)this._dealKeyFrame(t[s]),this._calculateFrameValues(t[s],t[s+1],e);0==a&&(e[0]=t[0].value,this._usedFrames&&(this._usedFrames[t[0].index]=!0)),this._dealKeyFrame(t[s])}_dealKeyFrame(t){t.label&&""!=t.label&&this.addLabel(t.label,t.index)}_calculateFrameValues(t,e,i){var r,s,n=t.index,o=e.index,l=t.value,h=e.value-t.value,u=o-n,c=this._usedFrames;if(o>this._count&&(this._count=o),t.tween)for(null==(s=a.Ease[t.tweenMethod])&&(s=a.Ease.linearNone),r=n;r<o;r++)i[r]=s(r-n,l,h,u),c&&(c[r]=!0);else for(r=n;r<o;r++)i[r]=l;c&&(c[t.index]=!0,c[e.index]=!0),i[e.index]=e.value}}e.FrameAnimation=o,n.ClassUtils.regClass("laya.display.FrameAnimation",o),n.ClassUtils.regClass("Laya.FrameAnimation",o)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(28),s=i(32),a=i(22),n=i(2),o=i(9);class l extends r.Sprite{constructor(){super(),this.wrapMode=0,this._interval=s.Config.animationInterval,this._isReverse=!1,this._frameRateChanged=!1,this._setBitUp(a.Const.DISPLAY)}play(t=0,e=!0,i=""){this._isPlaying=!0,this._actionName=i,this.index="string"==typeof t?this._getFrameByLabel(t):t,this.loop=e,this._isReverse=this.wrapMode===l.WRAP_REVERSE,0==this.index&&this._isReverse&&(this.index=this.count-1),this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)}get interval(){return this._interval}set interval(t){this._interval!=t&&(this._frameRateChanged=!0,this._interval=t,this._isPlaying&&t>0&&this.timerLoop(t,this,this._frameLoop,null,!0,!0))}_getFrameByLabel(t){for(var e=0;e<this._count;e++){var i=this._labels[e];if(i&&i.indexOf(t)>-1)return e}return 0}_frameLoop(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event(n.Event.COMPLETE);this.wrapMode==l.WRAP_PINGPONG?(this._index=this._count>0?1:0,this._isReverse=!1):this._index=this._count-1,this.event(n.Event.COMPLETE)}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event(n.Event.COMPLETE);this.wrapMode==l.WRAP_PINGPONG?(this._index=this._count-2>=0?this._count-2:0,this._isReverse=!0):this._index=0,this.event(n.Event.COMPLETE)}this.index=this._index}_setControlNode(t){this._controlNode&&(this._controlNode.off(n.Event.DISPLAY,this,this._resumePlay),this._controlNode.off(n.Event.UNDISPLAY,this,this._resumePlay)),this._controlNode=t,t&&t!=this&&(t.on(n.Event.DISPLAY,this,this._resumePlay),t.on(n.Event.UNDISPLAY,this,this._resumePlay))}_setDisplay(t){super._setDisplay(t),this._resumePlay()}_resumePlay(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))}stop(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)}get isPlaying(){return this._isPlaying}addLabel(t,e){this._labels||(this._labels={}),this._labels[e]||(this._labels[e]=[]),this._labels[e].push(t)}removeLabel(t){if(t){if(this._labels)for(var e in this._labels)this._removeLabelFromList(this._labels[e],t)}else this._labels=null}_removeLabelFromList(t,e){if(t)for(var i=t.length-1;i>=0;i--)t[i]==e&&t.splice(i,1)}gotoAndStop(t){this.index="string"==typeof t?this._getFrameByLabel(t):t,this.stop()}get index(){return this._index}set index(t){if(this._index=t,this._displayToIndex(t),this._labels&&this._labels[t])for(var e=this._labels[t],i=0,r=e.length;i<r;i++)this.event(n.Event.LABEL,e[i])}_displayToIndex(t){}get count(){return this._count}clear(){return this.stop(),this._labels=null,this}}e.AnimationBase=l,l.WRAP_POSITIVE=0,l.WRAP_REVERSE=1,l.WRAP_PINGPONG=2,o.ClassUtils.regClass("laya.display.AnimationBase",l),o.ClassUtils.regClass("Laya.AnimationBase",l)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static subtractVector3(t,e,i){i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2]}static lerp(t,e,i){return t*(1-i)+e*i}static scaleVector3(t,e,i){i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e}static lerpVector3(t,e,i,r){var s=t[0],a=t[1],n=t[2];r[0]=s+i*(e[0]-s),r[1]=a+i*(e[1]-a),r[2]=n+i*(e[2]-n)}static lerpVector4(t,e,i,r){var s=t[0],a=t[1],n=t[2],o=t[3];r[0]=s+i*(e[0]-s),r[1]=a+i*(e[1]-a),r[2]=n+i*(e[2]-n),r[3]=o+i*(e[3]-o)}static slerpQuaternionArray(t,e,i,r,s,a,n){var o,l,h,u,c,_=t[e+0],d=t[e+1],f=t[e+2],p=t[e+3],m=i[r+0],g=i[r+1],v=i[r+2],y=i[r+3];return(l=_*m+d*g+f*v+p*y)<0&&(l=-l,m=-m,g=-g,v=-v,y=-y),1-l>1e-6?(o=Math.acos(l),h=Math.sin(o),u=Math.sin((1-s)*o)/h,c=Math.sin(s*o)/h):(u=1-s,c=s),a[n+0]=u*_+c*m,a[n+1]=u*d+c*g,a[n+2]=u*f+c*v,a[n+3]=u*p+c*y,a}static getRotation(t,e,i,r){return Math.atan2(r-e,i-t)/Math.PI*180}static sortBigFirst(t,e){return t==e?0:e>t?1:-1}static sortSmallFirst(t,e){return t==e?0:e>t?-1:1}static sortNumBigFirst(t,e){return parseFloat(e)-parseFloat(t)}static sortNumSmallFirst(t,e){return parseFloat(t)-parseFloat(e)}static sortByKey(t,e=!1,i=!0){var s;return s=e?i?r.sortNumBigFirst:r.sortBigFirst:i?r.sortNumSmallFirst:r.sortSmallFirst,function(e,i){return s(e[t],i[t])}}}e.MathUtil=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(173),s=i(8),a=i(28),n=i(36),o=i(25),l=i(42),h=i(24),u=i(15),c=i(0);class _ extends r.IStatRender{constructor(){super(...arguments),this._show=!1,this._useCanvas=!1,this._height=100,this._view=[]}show(t=0,e=0){u.Stat;s.Browser.onMiniGame||c.ILaya.Render.isConchApp||s.Browser.onBDMiniGame||s.Browser.onKGMiniGame||s.Browser.onQGMiniGame||s.Browser.onQQMiniGame||s.Browser.onAlipayMiniGame||(this._useCanvas=!0),this._show=!0,u.Stat._fpsData.length=60,this._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},this._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},this._view[2]={title:"RenderBatches",value:"renderBatches",color:"white",units:"int"},this._view[3]={title:"SavedRenderBatches",value:"savedRenderBatches",color:"white",units:"int"},this._view[4]={title:"CPUMemory",value:"cpuMemory",color:"yellow",units:"M"},this._view[5]={title:"GPUMemory",value:"gpuMemory",color:"yellow",units:"M"},this._view[6]={title:"Shader",value:"shaderCall",color:"white",units:"int"},o.Render.is3DMode?(this._view[0].title="FPS(3D)",this._view[7]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},this._view[8]={title:"FrustumCulling",value:"frustumCulling",color:"white",units:"int"},this._view[9]={title:"OctreeNodeCulling",value:"octreeNodeCulling",color:"white",units:"int"}):(this._view[0].title="FPS(WebGL)",this._view[7]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"}),this._useCanvas?this.createUIPre(t,e):this.createUI(t,e),this.enable()}createUIPre(t,e){var i=s.Browser.pixelRatio;this._width=180*i,this._vx=120*i,this._height=i*(12*this._view.length+3*i)+4,_._fontSize=12*i;for(var r=0;r<this._view.length;r++)this._view[r].x=4,this._view[r].y=r*_._fontSize+2*i;this._canvas||(this._canvas=new l.HTMLCanvas(!0),this._canvas.size(this._width,this._height),this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline="top",this._ctx.font=_._fontSize+"px Arial",this._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+t+"px;top:"+e+"px;width:"+this._width/i+"px;height:"+this._height/i+"px;"),s.Browser.onKGMiniGame||s.Browser.container.appendChild(this._canvas.source),this._first=!0,this.loop(),this._first=!1}createUI(t,e){var i=this._sp,r=s.Browser.pixelRatio;i||(i=new a.Sprite,this._leftText=new n.Text,this._leftText.pos(5,5),this._leftText.color="#ffffff",i.addChild(this._leftText),this._txt=new n.Text,this._txt.pos(130*r,5),this._txt.color="#ffffff",i.addChild(this._txt),this._sp=i),i.pos(t,e);for(var o="",l=0;l<this._view.length;l++){o+=this._view[l].title+"\n"}this._leftText.text=o;var h=138*r,u=r*(12*this._view.length+3*r)+4;this._txt.fontSize=_._fontSize*r,this._leftText.fontSize=_._fontSize*r,i.size(h,u),i.graphics.clear(),i.graphics.alpha(.5),i.graphics.drawRect(0,0,h+110,u+30,"#999999"),i.graphics.alpha(2),this.loop()}enable(){c.ILaya.systemTimer.frameLoop(1,this,this.loop)}hide(){this._show=!1,c.ILaya.systemTimer.clear(this,this.loop),this._canvas&&s.Browser.removeElement(this._canvas.source)}set_onclick(t){this._sp&&this._sp.on("click",this._sp,t),this._canvas&&(this._canvas.source.onclick=t,this._canvas.source.style.pointerEvents="")}loop(){u.Stat._count++;var t=s.Browser.now();if(!(t-u.Stat._timer<1e3)){var e=u.Stat._count;if(u.Stat.FPS=Math.round(1e3*e/(t-u.Stat._timer)),this._show){u.Stat.trianglesFaces=Math.round(u.Stat.trianglesFaces/e),this._useCanvas?u.Stat.renderBatches=Math.round(u.Stat.renderBatches/e):u.Stat.renderBatches=Math.round(u.Stat.renderBatches/e)-1,u.Stat.savedRenderBatches=Math.round(u.Stat.savedRenderBatches/e),u.Stat.shaderCall=Math.round(u.Stat.shaderCall/e),u.Stat.spriteRenderUseCacheCount=Math.round(u.Stat.spriteRenderUseCacheCount/e),u.Stat.canvasNormal=Math.round(u.Stat.canvasNormal/e),u.Stat.canvasBitmap=Math.round(u.Stat.canvasBitmap/e),u.Stat.canvasReCache=Math.ceil(u.Stat.canvasReCache/e),u.Stat.frustumCulling=Math.round(u.Stat.frustumCulling/e),u.Stat.octreeNodeCulling=Math.round(u.Stat.octreeNodeCulling/e);var i=u.Stat.FPS>0?Math.floor(1e3/u.Stat.FPS).toString():" ";u.Stat._fpsStr=u.Stat.FPS+(u.Stat.renderSlow?" slow":"")+" "+i,u.Stat._spriteStr=u.Stat.spriteCount+(u.Stat.spriteRenderUseCacheCount?"/"+u.Stat.spriteRenderUseCacheCount:""),u.Stat._canvasStr=u.Stat.canvasReCache+"/"+u.Stat.canvasNormal+"/"+u.Stat.canvasBitmap,u.Stat.cpuMemory=h.Resource.cpuMemory,u.Stat.gpuMemory=h.Resource.gpuMemory,this._useCanvas?this.renderInfoPre():this.renderInfo(),u.Stat.clear()}u.Stat._count=0,u.Stat._timer=t}}renderInfoPre(){var t,e,i=0;if(this._canvas){var r=this._ctx;for(r.clearRect(this._first?0:this._vx,0,this._width,this._height),i=0;i<this._view.length;i++)t=this._view[i],this._first&&(r.fillStyle="white",r.fillText(t.title,t.x,t.y)),r.fillStyle=t.color,e=u.Stat[t.value],"M"==t.units&&(e=Math.floor(e/1048576*100)/100+" M"),r.fillText(e+"",t.x+this._vx,t.y)}}renderInfo(){for(var t="",e=0;e<this._view.length;e++){var i=this._view[e],r=u.Stat[i.value];"M"==i.units&&(r=Math.floor(r/1048576*100)/100+" M"),"K"==i.units&&(r=Math.floor(r/1024*100)/100+" K"),t+=r+"\n"}this._txt.text=t}isCanvasRender(){return this._useCanvas}renderNotCanvas(t,e,i){this._show&&this._sp&&this._sp.render(t,0,0)}}e.StatUI=_,_._fontSize=12},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.IStatRender=class{show(t=0,e=0){}enable(){}hide(){}set_onclick(t){}isCanvasRender(){return!0}renderNotCanvas(t,e,i){}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(99),s=i(0);class a{constructor(t=!0){this.scale=1,this.currTimer=Date.now(),this.currFrame=0,this._delta=0,this._lastTimer=Date.now(),this._map=[],this._handlers=[],this._temp=[],this._count=0,t&&a.gSysTimer&&a.gSysTimer.frameLoop(1,this,this._update)}get delta(){return this._delta}_update(){if(this.scale<=0)return this._lastTimer=Date.now(),void(this._delta=0);var t=this.currFrame=this.currFrame+this.scale,e=Date.now(),i=e-this._lastTimer>3e4;this._delta=(e-this._lastTimer)*this.scale;var r=this.currTimer=this.currTimer+this._delta;this._lastTimer=e;var s=this._handlers;this._count=0;for(var a=0,n=s.length;a<n;a++){var o=s[a];if(null!==o.method){var l=o.userFrame?t:r;if(l>=o.exeTime)if(o.repeat)if(!o.jumpFrame||i)o.exeTime+=o.delay,o.run(!1),l>o.exeTime&&(o.exeTime+=Math.ceil((l-o.exeTime)/o.delay)*o.delay);else for(;l>=o.exeTime;)o.exeTime+=o.delay,o.run(!1);else o.run(!0)}else this._count++}(this._count>30||t%200==0)&&this._clearHandlers()}_clearHandlers(){for(var t=this._handlers,e=0,i=t.length;e<i;e++){var r=t[e];null!==r.method?this._temp.push(r):this._recoverHandler(r)}this._handlers=this._temp,t.length=0,this._temp=t}_recoverHandler(t){this._map[t.key]==t&&(this._map[t.key]=null),t.clear(),a._pool.push(t)}_create(t,e,i,r,s,o,l){if(!i)return s.apply(r,o),null;if(l){var h=this._getHandler(r,s);if(h)return h.repeat=e,h.userFrame=t,h.delay=i,h.caller=r,h.method=s,h.args=o,h.exeTime=i+(t?this.currFrame:this.currTimer+Date.now()-this._lastTimer),h}return(h=a._pool.length>0?a._pool.pop():new n).repeat=e,h.userFrame=t,h.delay=i,h.caller=r,h.method=s,h.args=o,h.exeTime=i+(t?this.currFrame:this.currTimer+Date.now()-this._lastTimer),this._indexHandler(h),this._handlers.push(h),h}_indexHandler(t){var e=t.caller,i=t.method,r=e?e.$_GID||(e.$_GID=s.ILaya.Utils.getGID()):0,n=i.$_TID||(i.$_TID=1e5*a._mid++);t.key=r+n,this._map[t.key]=t}once(t,e,i,r=null,s=!0){this._create(!1,!1,t,e,i,r,s)}loop(t,e,i,r=null,s=!0,a=!1){var n=this._create(!1,!0,t,e,i,r,s);n&&(n.jumpFrame=a)}frameOnce(t,e,i,r=null,s=!0){this._create(!0,!1,t,e,i,r,s)}frameLoop(t,e,i,r=null,s=!0){this._create(!0,!0,t,e,i,r,s)}toString(){return" handlers:"+this._handlers.length+" pool:"+a._pool.length}clear(t,e){var i=this._getHandler(t,e);i&&(this._map[i.key]=null,i.key=0,i.clear())}clearAll(t){if(t)for(var e=0,i=this._handlers.length;e<i;e++){var r=this._handlers[e];r.caller===t&&(this._map[r.key]=null,r.key=0,r.clear())}}_getHandler(t,e){var i=t?t.$_GID||(t.$_GID=s.ILaya.Utils.getGID()):0,r=e.$_TID||(e.$_TID=1e5*a._mid++);return this._map[i+r]}callLater(t,e,i=null){r.CallLater.I.callLater(t,e,i)}runCallLater(t,e){r.CallLater.I.runCallLater(t,e)}runTimer(t,e){var i=this._getHandler(t,e);i&&null!=i.method&&(this._map[i.key]=null,i.run(!0))}pause(){this.scale=0}resume(){this.scale=1}}e.Timer=a,a.gSysTimer=null,a._pool=[],a._mid=1;class n{clear(){this.caller=null,this.method=null,this.args=null}run(t){var e=this.caller;if(e&&e.destroyed)return this.clear();var i=this.method,r=this.args;t&&this.clear(),null!=i&&(r?i.apply(e,r):i.call(e))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(11),s=i(13),a=i(35),n=i(7);class o extends s.Value2D{constructor(t){super(r.ShaderDefines2D.SKINMESH,0),this.offsetX=300,this.offsetY=0;var e=n.WebGLContext.mainContext,i=8*a.CONST3D2D.BYTES_PE;this.position=[2,e.FLOAT,!1,i,0],this.texcoord=[2,e.FLOAT,!1,i,2*a.CONST3D2D.BYTES_PE],this.color=[4,e.FLOAT,!1,i,4*a.CONST3D2D.BYTES_PE]}}e.SkinSV=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(13),s=i(11);class a extends r.Value2D{constructor(t){super(s.ShaderDefines2D.PRIMITIVE,0),this._attribLocation=["position",0,"attribColor",1]}}e.PrimitiveSV=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(13),s=i(11);class a extends r.Value2D{constructor(t=0){super(s.ShaderDefines2D.TEXTURE2D,t),this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2]}clear(){this.texture=null,this.shader=null,this.defines._value=this.subID}}e.TextureSV=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(3),s=i(31),a=i(179),n=i(180);class o{constructor(t,e,i){this.defs={};let r=this;function s(t){t=t.replace(o._clearCR,"");var e=[],i=new n.ShaderNode(e);return r._compileToTree(i,t.split("\n"),0,e,r.defs),i}var a=Date.now();this._VS=s(t),this._PS=s(e),this._nameMap=i,Date.now()-a>2&&console.log("ShaderCompile use time:"+(Date.now()-a)+"  size:"+t.length+"/"+e.length)}static __init__(){var t=r.LayaGL.instance;o.shaderParamsMap={float:t.FLOAT,int:t.INT,bool:t.BOOL,vec2:t.FLOAT_VEC2,vec3:t.FLOAT_VEC3,vec4:t.FLOAT_VEC4,ivec2:t.INT_VEC2,ivec3:t.INT_VEC3,ivec4:t.INT_VEC4,bvec2:t.BOOL_VEC2,bvec3:t.BOOL_VEC3,bvec4:t.BOOL_VEC4,mat2:t.FLOAT_MAT2,mat3:t.FLOAT_MAT3,mat4:t.FLOAT_MAT4,sampler2D:t.SAMPLER_2D,samplerCube:t.SAMPLER_CUBE}}static _parseOne(t,e,i,r,s,a){var n={type:o.shaderParamsMap[i[r+1]],name:i[r+2],size:isNaN(parseInt(i[r+3]))?1:parseInt(i[r+3])};return a&&("attribute"==s?t.push(n):e.push(n)),":"==i[r+3]&&(n.type=i[r+4],r+=2),r+=2}static addInclude(t,e){if(!e||0===e.length)throw new Error("add shader include file err:"+t);if(o.includes[t])throw new Error("add shader include file err, has add:"+t);o.includes[t]=new a.InlcudeFile(e)}static preGetParams(t,e){var i,r,s=[t,e],a={},n=[],l=[],h={},u=[];a.attributes=n,a.uniforms=l,a.defines=h;for(var c=0;c<2;c++){s[c]=s[c].replace(o._removeAnnotation,"");var _,d=s[c].match(o._reg);for(i=0,r=d.length;i<r;i++){var f=d[i];if("attribute"==f||"uniform"==f)i=o._parseOne(n,l,d,i,f,!0);else{if("#define"==f){u[f=d[++i]]=1;continue}if("#ifdef"==f){h[_=d[++i]]=h[_]||[];for(i++;i<r;i++)if("attribute"==(f=d[i])||"uniform"==f)i=o._parseOne(n,l,d,i,f,u[_]);else if("#else"==f)for(i++;i<r;i++)if("attribute"==(f=d[i])||"uniform"==f)i=o._parseOne(n,l,d,i,f,!u[_]);else if("#endif"==f)break}}}}return a}static splitToWords(t,e){for(var i,r,s=[],a=-1,n=0,o=t.length;n<o;n++)if(i=t.charAt(n)," \t=+-*/&%!<>()'\",;".indexOf(i)>=0){if(a>=0&&n-a>1&&(r=t.substr(a,n-a),s.push(r)),'"'==i||"'"==i){var l=t.indexOf(i,n+1);if(l<0)throw"Sharder err:"+t;s.push(t.substr(n+1,l-n-1)),n=l,a=-1;continue}"("==i&&e&&s.length>0&&(r=s[s.length-1]+";","vec4;main;".indexOf(r)<0&&(e.useFuns+=r)),a=-1}else a<0&&(a=n);return a<o&&o-a>1&&(r=t.substr(a,o-a),s.push(r)),s}_compileToTree(t,e,i,r,s){var a,l,h,u,c,_,d,f,p,m,g;for(p=i;p<e.length;p++)if(!((h=e[p]).length<1)&&0!==(_=h.indexOf("//"))){if(_>=0&&(h=h.substr(0,_)),a=f||new n.ShaderNode(r),f=null,a.text=h,a.noCompile=!0,(_=h.indexOf("#"))>=0){for(u="#",g=_+1,m=h.length;g<m;g++){var v=h.charAt(g);if(" "===v||"\t"===v||"?"===v)break;u+=v}switch(a.name=u,u){case"#ifdef":case"#ifndef":if(a.src=h,a.noCompile=null!=h.match(/[!&|()=<>]/),a.noCompile?console.log("function():Boolean{return "+h.substr(_+a.name.length)+"}"):(d=h.replace(/^\s*/,"").split(/\s+/),a.setCondition(d[1],"#ifdef"===u?o.IFDEF_YES:o.IFDEF_ELSE),a.text="//"+a.text),a.setParent(t),t=a,s)for(d=h.substr(g).split(o._splitToWordExps3),g=0;g<d.length;g++)(h=d[g]).length&&(s[h]=!0);continue;case"#if":if(a.src=h,a.noCompile=!0,a.setParent(t),t=a,s)for(d=h.substr(g).split(o._splitToWordExps3),g=0;g<d.length;g++)(h=d[g]).length&&"defined"!=h&&(s[h]=!0);continue;case"#else":a.src=h,l=(t=t.parent).childs[t.childs.length-1],a.noCompile=l.noCompile,a.noCompile||(a.condition=l.condition,a.conditionType=l.conditionType==o.IFDEF_YES?o.IFDEF_ELSE:o.IFDEF_YES,a.text="//"+a.text+" "+l.text+" "+a.conditionType),a.setParent(t),t=a;continue;case"#endif":l=(t=t.parent).childs[t.childs.length-1],a.noCompile=l.noCompile,a.noCompile||(a.text="//"+a.text),a.setParent(t);continue;case"#include":d=o.splitToWords(h,null);var y=o.includes[d[1]];if(!y)throw"ShaderCompile error no this include file:"+d[1];if((_=d[0].indexOf("?"))<0){a.setParent(t),h=y.getWith("with"==d[2]?d[3]:null),this._compileToTree(a,h.split("\n"),0,r,s),a.text="";continue}a.setCondition(d[0].substr(_+1),o.IFDEF_YES),a.text=y.getWith("with"==d[2]?d[3]:null);break;case"#import":c=(d=o.splitToWords(h,null))[1],r.push({node:a,file:o.includes[c],ofs:a.text.length});continue}}else{if((l=t.childs[t.childs.length-1])&&!l.name){r.length>0&&o.splitToWords(h,l),f=a,l.text+="\n"+h;continue}r.length>0&&o.splitToWords(h,a)}a.setParent(t)}}createShader(t,e,i,r){var a={},n="";if(t)for(var o in t)n+="#define "+o+"\n",a[o]=!0;var l=this._VS.toscript(a,[]),h=this._PS.toscript(a,[]);return(i||s.Shader.create)(n+l.join("\n"),n+h.join("\n"),e,this._nameMap,r)}}e.ShaderCompile=o,o.IFDEF_NO=0,o.IFDEF_YES=1,o.IFDEF_ELSE=2,o.IFDEF_PARENT=3,o._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),o._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),o._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),o.includes={},o._clearCR=new RegExp("\r","g"),o._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0);e.InlcudeFile=class{constructor(t){this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=t;for(var e,i,s=0;!((s=t.indexOf("#begin",s))<0);){for(i=s+5;!((i=t.indexOf("#end",i))<0)&&"i"===t.charAt(i+4);)i+=5;if(i<0)throw"add include err,no #end:"+t;e=t.indexOf("\n",s);var a=r.ILaya.ShaderCompile.splitToWords(t.substr(s,e-s),null);"code"==a[1]?this.codes[a[2]]=t.substr(e+1,i-e-1):"function"==a[1]&&(e=t.indexOf("function",s),e+="function".length,this.funs[a[3]]=t.substr(e+1,i-e-1),this.funnames+=a[3]+";"),s=i+1}}getWith(t=null){var e=t?this.codes[t]:this.script;if(!e)throw"get with error:"+t;return e}getFunsScript(t){var e="";for(var i in this.funs)t.indexOf(i+";")>=0&&(e+=this.funs[i]);return e}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(0);class s{constructor(t){this.childs=[],this.text="",this.useFuns="",this.z=0,this.includefiles=t}setParent(t){t.childs.push(this),this.z=t.z+1,this.parent=t}setCondition(t,e){t&&(this.conditionType=e,t=t.replace(/(\s*$)/g,""),this.condition=function(){return this[t]},this.condition.__condition=t)}toscript(t,e){return this._toscript(t,e,++s.__id)}_toscript(t,e,i){if(this.childs.length<1&&!this.text)return e;e.length;if(this.condition){var s=!!this.condition.call(t);if(this.conditionType===r.ILaya.ShaderCompile.IFDEF_ELSE&&(s=!s),!s)return e}if(this.text&&e.push(this.text),this.childs.length>0&&this.childs.forEach((function(r,s,a){r._toscript(t,e,i)})),this.includefiles.length>0&&this.useFuns.length>0)for(var a,n=0,o=this.includefiles.length;n<o;n++)this.includefiles[n].curUseID!=i&&(a=this.includefiles[n].file.getFunsScript(this.useFuns)).length>0&&(this.includefiles[n].curUseID=i,e[0]=a+e[0]);return e}}e.ShaderNode=s,s.__id=1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(29),s=i(14),a=i(12),n=i(23);class o extends a.EventDispatcher{constructor(){super(),this.worker=new Worker(o.workerPath);let t=this;this.worker.onmessage=function(e){t.workerMessage(e.data)}}static __init__(){return null==o._preLoadFun&&(!!Worker&&(o._preLoadFun=r.Loader.prototype._loadImage,r.Loader.prototype._loadImage=o.prototype._loadImage,o.I||(o.I=new o),!0))}static workerSupported(){return!!Worker}static enableWorkerLoader(){o._tryEnabled||(o.enable=!0,o._tryEnabled=!0)}static set enable(t){o._enable!=t&&(o._enable=t,t&&null==o._preLoadFun&&(o._enable=o.__init__()))}static get enable(){return o._enable}workerMessage(t){if(t)switch(t.type){case"Image":this.imageLoaded(t);break;case"Disable":o.enable=!1}}imageLoaded(t){if(t.dataType&&"imageBitmap"==t.dataType){var e=t.imageBitmap,i=new n.Texture2D;i.loadImageSource(e),console.log("load:",t.url),this.event(t.url,i)}else this.event(t.url,null)}loadImage(t){this.worker.postMessage(t)}_loadImage(t){var e=this;if(this._useWorkerLoader&&o._enable){t=s.URL.formatURL(t);var i=function(r){o.I.off(t,e,i),r?e.onLoaded(r):o._preLoadFun.call(e,t)};o.I.on(t,e,i),o.I.loadImage(t)}else o._preLoadFun.call(e,t)}}e.WorkerLoader=o,o.workerPath="libs/workerloader.js",o._enable=!1,o._tryEnabled=!1},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{static set cursor(t){r._style.cursor=t}static get cursor(){return r._style.cursor}static __init__(){}static hide(){"none"!=r.cursor&&(r._preCursor=r.cursor,r.cursor="none")}static show(){"none"==r.cursor&&(r._preCursor?r.cursor=r._preCursor:r.cursor="auto")}}e.Mouse=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(41),s=i(3);class a extends r.Mesh2D{constructor(t){super(a.const_stride,4*t*a.const_stride,4),this.canReuse=!0,this.setAttributes(a._fixattriInfo),this.createQuadIB(t),this._quadNum=t}static __init__(){var t=s.LayaGL.instance;a._fixattriInfo=[t.FLOAT,4,0,t.FLOAT,3,16,t.FLOAT,3,28,t.FLOAT,4,40,t.FLOAT,4,56,t.FLOAT,3,72,t.FLOAT,2,84,t.FLOAT,4,92,t.FLOAT,1,108,t.FLOAT,1,112]}setMaxParticleNum(t){this._vb._resizeBuffer(4*t*a.const_stride,!1),this.createQuadIB(t)}static getAMesh(t){if(a._POOL.length){var e=a._POOL.pop();return e.setMaxParticleNum(t),e}return new a(t)}releaseMesh(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,a._POOL.push(this)}destroy(){this._ib.destroy(),this._vb.destroy(),this._vb.deleteBuffer()}}e.MeshParticle2D=a,a.const_stride=116,a._POOL=[]},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(45),s=i(23),a=i(39);class n extends r.Bitmap{}e.HTMLImage=n,n.create=function(t,e,i){var r=new s.Texture2D(t,e,i,!1,!1);return r.wrapModeU=a.BaseTexture.WARPMODE_CLAMP,r.wrapModeV=a.BaseTexture.WARPMODE_CLAMP,r}},function(t,e,i){"use strict";
/** @license React v16.12.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=i(108),s="function"==typeof Symbol&&Symbol.for,a=s?Symbol.for("react.element"):60103,n=s?Symbol.for("react.portal"):60106,o=s?Symbol.for("react.fragment"):60107,l=s?Symbol.for("react.strict_mode"):60108,h=s?Symbol.for("react.profiler"):60114,u=s?Symbol.for("react.provider"):60109,c=s?Symbol.for("react.context"):60110,_=s?Symbol.for("react.forward_ref"):60112,d=s?Symbol.for("react.suspense"):60113;s&&Symbol.for("react.suspense_list");var f=s?Symbol.for("react.memo"):60115,p=s?Symbol.for("react.lazy"):60116;s&&Symbol.for("react.fundamental"),s&&Symbol.for("react.responder"),s&&Symbol.for("react.scope");var m="function"==typeof Symbol&&Symbol.iterator;function g(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y={};function x(t,e,i){this.props=t,this.context=e,this.refs=y,this.updater=i||v}function T(){}function b(t,e,i){this.props=t,this.context=e,this.refs=y,this.updater=i||v}x.prototype.isReactComponent={},x.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(g(85));this.updater.enqueueSetState(this,t,e,"setState")},x.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},T.prototype=x.prototype;var E=b.prototype=new T;E.constructor=b,r(E,x.prototype),E.isPureReactComponent=!0;var C={current:null},S={current:null},R=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function M(t,e,i){var r,s={},n=null,o=null;if(null!=e)for(r in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(n=""+e.key),e)R.call(e,r)&&!w.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var h=Array(l),u=0;u<l;u++)h[u]=arguments[u+2];s.children=h}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:a,type:t,key:n,ref:o,props:s,_owner:S.current}}function L(t){return"object"==typeof t&&null!==t&&t.$$typeof===a}var I=/\/+/g,A=[];function P(t,e,i,r){if(A.length){var s=A.pop();return s.result=t,s.keyPrefix=e,s.func=i,s.context=r,s.count=0,s}return{result:t,keyPrefix:e,func:i,context:r,count:0}}function D(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>A.length&&A.push(t)}function B(t,e,i){return null==t?0:function t(e,i,r,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case a:case n:l=!0}}if(l)return r(s,e,""===i?"."+O(e,0):i),1;if(l=0,i=""===i?".":i+":",Array.isArray(e))for(var h=0;h<e.length;h++){var u=i+O(o=e[h],h);l+=t(o,u,r,s)}else if(null===e||"object"!=typeof e?u=null:u="function"==typeof(u=m&&e[m]||e["@@iterator"])?u:null,"function"==typeof u)for(e=u.call(e),h=0;!(o=e.next()).done;)l+=t(o=o.value,u=i+O(o,h++),r,s);else if("object"===o)throw r=""+e,Error(g(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return l}(t,"",e,i)}function O(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function F(t,e){t.func.call(t.context,e,t.count++)}function N(t,e,i){var r=t.result,s=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?U(t,r,i,(function(t){return t})):null!=t&&(L(t)&&(t=function(t,e){return{$$typeof:a,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,s+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(I,"$&/")+"/")+i)),r.push(t))}function U(t,e,i,r,s){var a="";null!=i&&(a=(""+i).replace(I,"$&/")+"/"),B(t,N,e=P(e,a,r,s)),D(e)}function k(){var t=C.current;if(null===t)throw Error(g(321));return t}var G={Children:{map:function(t,e,i){if(null==t)return t;var r=[];return U(t,r,null,e,i),r},forEach:function(t,e,i){if(null==t)return t;B(t,F,e=P(null,null,e,i)),D(e)},count:function(t){return B(t,(function(){return null}),null)},toArray:function(t){var e=[];return U(t,e,null,(function(t){return t})),e},only:function(t){if(!L(t))throw Error(g(143));return t}},createRef:function(){return{current:null}},Component:x,PureComponent:b,createContext:function(t,e){return void 0===e&&(e=null),(t={$$typeof:c,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:t},t.Consumer=t},forwardRef:function(t){return{$$typeof:_,render:t}},lazy:function(t){return{$$typeof:p,_ctor:t,_status:-1,_result:null}},memo:function(t,e){return{$$typeof:f,type:t,compare:void 0===e?null:e}},useCallback:function(t,e){return k().useCallback(t,e)},useContext:function(t,e){return k().useContext(t,e)},useEffect:function(t,e){return k().useEffect(t,e)},useImperativeHandle:function(t,e,i){return k().useImperativeHandle(t,e,i)},useDebugValue:function(){},useLayoutEffect:function(t,e){return k().useLayoutEffect(t,e)},useMemo:function(t,e){return k().useMemo(t,e)},useReducer:function(t,e,i){return k().useReducer(t,e,i)},useRef:function(t){return k().useRef(t)},useState:function(t){return k().useState(t)},Fragment:o,Profiler:h,StrictMode:l,Suspense:d,createElement:M,cloneElement:function(t,e,i){if(null==t)throw Error(g(267,t));var s=r({},t.props),n=t.key,o=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,l=S.current),void 0!==e.key&&(n=""+e.key),t.type&&t.type.defaultProps)var h=t.type.defaultProps;for(u in e)R.call(e,u)&&!w.hasOwnProperty(u)&&(s[u]=void 0===e[u]&&void 0!==h?h[u]:e[u])}var u=arguments.length-2;if(1===u)s.children=i;else if(1<u){h=Array(u);for(var c=0;c<u;c++)h[c]=arguments[c+2];s.children=h}return{$$typeof:a,type:t.type,key:n,ref:o,props:s,_owner:l}},createFactory:function(t){var e=M.bind(null,t);return e.type=t,e},isValidElement:L,version:"16.12.0",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:C,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:r}},W={default:G},Y=W&&G||W;t.exports=Y.default||Y},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=r(i(187)),a=i(191);!function(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}(i(111));const n=s.default(a.HostConfig);e.CustomRenderer={render(t,e,i){const r=n.createContainer(e,!1,!0);n.updateContainer(t,r,null,i)}}},function(t,e,i){"use strict";t.exports=i(188)},function(t,e,i){
/** @license React v0.24.0
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
t.exports=function e(r){"use strict";var s=i(108),a=i(107),n=i(189);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;l.hasOwnProperty("ReactCurrentDispatcher")||(l.ReactCurrentDispatcher={current:null}),l.hasOwnProperty("ReactCurrentBatchConfig")||(l.ReactCurrentBatchConfig={suspense:null});var h="function"==typeof Symbol&&Symbol.for,u=h?Symbol.for("react.element"):60103,c=h?Symbol.for("react.portal"):60106,_=h?Symbol.for("react.fragment"):60107,d=h?Symbol.for("react.strict_mode"):60108,f=h?Symbol.for("react.profiler"):60114,p=h?Symbol.for("react.provider"):60109,m=h?Symbol.for("react.context"):60110,g=h?Symbol.for("react.concurrent_mode"):60111,v=h?Symbol.for("react.forward_ref"):60112,y=h?Symbol.for("react.suspense"):60113,x=h?Symbol.for("react.suspense_list"):60120,T=h?Symbol.for("react.memo"):60115,b=h?Symbol.for("react.lazy"):60116;h&&Symbol.for("react.fundamental"),h&&Symbol.for("react.responder"),h&&Symbol.for("react.scope");var E="function"==typeof Symbol&&Symbol.iterator;function C(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=E&&t[E]||t["@@iterator"])?t:null}function S(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case _:return"Fragment";case c:return"Portal";case f:return"Profiler";case d:return"StrictMode";case y:return"Suspense";case x:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case m:return"Context.Consumer";case p:return"Context.Provider";case v:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case T:return S(t.type);case b:if(t=1===t._status?t._result:null)return S(t)}return null}function R(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(1026&(e=t).effectTag)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function w(t){if(R(t)!==t)throw Error(o(188))}function M(t){var e=t.alternate;if(!e){if(null===(e=R(t)))throw Error(o(188));return e!==t?null:t}for(var i=t,r=e;;){var s=i.return;if(null===s)break;var a=s.alternate;if(null===a){if(null!==(r=s.return)){i=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===i)return w(s),t;if(a===r)return w(s),e;a=a.sibling}throw Error(o(188))}if(i.return!==r.return)i=s,r=a;else{for(var n=!1,l=s.child;l;){if(l===i){n=!0,i=s,r=a;break}if(l===r){n=!0,r=s,i=a;break}l=l.sibling}if(!n){for(l=a.child;l;){if(l===i){n=!0,i=a,r=s;break}if(l===r){n=!0,r=a,i=s;break}l=l.sibling}if(!n)throw Error(o(189))}}if(i.alternate!==r)throw Error(o(190))}if(3!==i.tag)throw Error(o(188));return i.stateNode.current===i?t:e}function L(t){if(!(t=M(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}var I=r.getPublicInstance,A=r.getRootHostContext,P=r.getChildHostContext,D=r.prepareForCommit,B=r.resetAfterCommit,O=r.createInstance,F=r.appendInitialChild,N=r.finalizeInitialChildren,U=r.prepareUpdate,k=r.shouldSetTextContent,G=r.shouldDeprioritizeSubtree,W=r.createTextInstance,Y=r.setTimeout,V=r.clearTimeout,z=r.noTimeout,H=r.isPrimaryRenderer,X=r.supportsMutation,j=r.supportsPersistence,q=r.supportsHydration,Q=r.appendChild,K=r.appendChildToContainer,$=r.commitTextUpdate,Z=r.commitMount,J=r.commitUpdate,tt=r.insertBefore,et=r.insertInContainerBefore,it=r.removeChild,rt=r.removeChildFromContainer,st=r.resetTextContent,at=r.hideInstance,nt=r.hideTextInstance,ot=r.unhideInstance,lt=r.unhideTextInstance,ht=r.cloneInstance,ut=r.createContainerChildSet,ct=r.appendChildToContainerChildSet,_t=r.finalizeContainerChildren,dt=r.replaceContainerChildren,ft=r.cloneHiddenInstance,pt=r.cloneHiddenTextInstance,mt=r.canHydrateInstance,gt=r.canHydrateTextInstance,vt=r.isSuspenseInstancePending,yt=r.isSuspenseInstanceFallback,xt=r.getNextHydratableSibling,Tt=r.getFirstHydratableChild,bt=r.hydrateInstance,Et=r.hydrateTextInstance,Ct=r.getNextHydratableInstanceAfterSuspenseInstance,St=r.commitHydratedContainer,Rt=r.commitHydratedSuspenseInstance,wt=/^(.*)[\\\/]/;function Mt(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var i="";break t;default:var r=t._debugOwner,s=t._debugSource,a=S(t.type);i=null,r&&(i=S(r.type)),r=a,a="",s?a=" (at "+s.fileName.replace(wt,"")+":"+s.lineNumber+")":i&&(a=" (created by "+i+")"),i="\n    in "+(r||"Unknown")+a}e+=i,t=t.return}while(t);return e}new Set;var Lt=[],It=-1;function At(t){0>It||(t.current=Lt[It],Lt[It]=null,It--)}function Pt(t,e){It++,Lt[It]=t.current,t.current=e}var Dt={},Bt={current:Dt},Ot={current:!1},Ft=Dt;function Nt(t,e){var i=t.type.contextTypes;if(!i)return Dt;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s,a={};for(s in i)a[s]=e[s];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Ut(t){return null!=(t=t.childContextTypes)}function kt(t){At(Ot),At(Bt)}function Gt(t){At(Ot),At(Bt)}function Wt(t,e,i){if(Bt.current!==Dt)throw Error(o(168));Pt(Bt,e),Pt(Ot,i)}function Yt(t,e,i){var r=t.stateNode;if(t=e.childContextTypes,"function"!=typeof r.getChildContext)return i;for(var a in r=r.getChildContext())if(!(a in t))throw Error(o(108,S(e)||"Unknown",a));return s({},i,{},r)}function Vt(t){var e=t.stateNode;return e=e&&e.__reactInternalMemoizedMergedChildContext||Dt,Ft=Bt.current,Pt(Bt,e),Pt(Ot,Ot.current),!0}function zt(t,e,i){var r=t.stateNode;if(!r)throw Error(o(169));i?(e=Yt(t,e,Ft),r.__reactInternalMemoizedMergedChildContext=e,At(Ot),At(Bt),Pt(Bt,e)):At(Ot),Pt(Ot,i)}var Ht=n.unstable_runWithPriority,Xt=n.unstable_scheduleCallback,jt=n.unstable_cancelCallback,qt=n.unstable_shouldYield,Qt=n.unstable_requestPaint,Kt=n.unstable_now,$t=n.unstable_getCurrentPriorityLevel,Zt=n.unstable_ImmediatePriority,Jt=n.unstable_UserBlockingPriority,te=n.unstable_NormalPriority,ee=n.unstable_LowPriority,ie=n.unstable_IdlePriority,re={},se=void 0!==Qt?Qt:function(){},ae=null,ne=null,oe=!1,le=Kt(),he=1e4>le?Kt:function(){return Kt()-le};function ue(){switch($t()){case Zt:return 99;case Jt:return 98;case te:return 97;case ee:return 96;case ie:return 95;default:throw Error(o(332))}}function ce(t){switch(t){case 99:return Zt;case 98:return Jt;case 97:return te;case 96:return ee;case 95:return ie;default:throw Error(o(332))}}function _e(t,e){return t=ce(t),Ht(t,e)}function de(t,e,i){return t=ce(t),Xt(t,e,i)}function fe(t){return null===ae?(ae=[t],ne=Xt(Zt,me)):ae.push(t),re}function pe(){if(null!==ne){var t=ne;ne=null,jt(t)}me()}function me(){if(!oe&&null!==ae){oe=!0;var t=0;try{var e=ae;_e(99,(function(){for(;t<e.length;t++){var i=e[t];do{i=i(!0)}while(null!==i)}})),ae=null}catch(e){throw null!==ae&&(ae=ae.slice(t+1)),Xt(Zt,pe),e}finally{oe=!1}}}var ge=3;function ve(t,e,i){return 1073741821-(1+((1073741821-t+e/10)/(i/=10)|0))*i}var ye="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},xe=Object.prototype.hasOwnProperty;function Te(t,e){if(ye(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++)if(!xe.call(e,i[r])||!ye(t[i[r]],e[i[r]]))return!1;return!0}function be(t,e){if(t&&t.defaultProps)for(var i in e=s({},e),t=t.defaultProps)void 0===e[i]&&(e[i]=t[i]);return e}var Ee={current:null},Ce=null,Se=null,Re=null;function we(){Re=Se=Ce=null}function Me(t,e){var i=t.type._context;H?(Pt(Ee,i._currentValue),i._currentValue=e):(Pt(Ee,i._currentValue2),i._currentValue2=e)}function Le(t){var e=Ee.current;At(Ee),t=t.type._context,H?t._currentValue=e:t._currentValue2=e}function Ie(t,e){for(;null!==t;){var i=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,null!==i&&i.childExpirationTime<e&&(i.childExpirationTime=e);else{if(!(null!==i&&i.childExpirationTime<e))break;i.childExpirationTime=e}t=t.return}}function Ae(t,e){Ce=t,Re=Se=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(t.expirationTime>=e&&(cr=!0),t.firstContext=null)}function Pe(t,e){if(Re!==t&&!1!==e&&0!==e)if("number"==typeof e&&1073741823!==e||(Re=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Se){if(null===Ce)throw Error(o(308));Se=e,Ce.dependencies={expirationTime:0,firstContext:e,responders:null}}else Se=Se.next=e;return H?t._currentValue:t._currentValue2}var De=!1;function Be(t){return{baseState:t,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Oe(t){return{baseState:t.baseState,firstUpdate:t.firstUpdate,lastUpdate:t.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Fe(t,e){return{expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function Ne(t,e){null===t.lastUpdate?t.firstUpdate=t.lastUpdate=e:(t.lastUpdate.next=e,t.lastUpdate=e)}function Ue(t,e){var i=t.alternate;if(null===i){var r=t.updateQueue,s=null;null===r&&(r=t.updateQueue=Be(t.memoizedState))}else r=t.updateQueue,s=i.updateQueue,null===r?null===s?(r=t.updateQueue=Be(t.memoizedState),s=i.updateQueue=Be(i.memoizedState)):r=t.updateQueue=Oe(s):null===s&&(s=i.updateQueue=Oe(r));null===s||r===s?Ne(r,e):null===r.lastUpdate||null===s.lastUpdate?(Ne(r,e),Ne(s,e)):(Ne(r,e),s.lastUpdate=e)}function ke(t,e){var i=t.updateQueue;null===(i=null===i?t.updateQueue=Be(t.memoizedState):Ge(t,i)).lastCapturedUpdate?i.firstCapturedUpdate=i.lastCapturedUpdate=e:(i.lastCapturedUpdate.next=e,i.lastCapturedUpdate=e)}function Ge(t,e){var i=t.alternate;return null!==i&&e===i.updateQueue&&(e=t.updateQueue=Oe(e)),e}function We(t,e,i,r,a,n){switch(i.tag){case 1:return"function"==typeof(t=i.payload)?t.call(n,r,a):t;case 3:t.effectTag=-4097&t.effectTag|64;case 0:if(null==(a="function"==typeof(t=i.payload)?t.call(n,r,a):t))break;return s({},r,a);case 2:De=!0}return r}function Ye(t,e,i,r,s){De=!1;for(var a=(e=Ge(t,e)).baseState,n=null,o=0,l=e.firstUpdate,h=a;null!==l;){var u=l.expirationTime;u<s?(null===n&&(n=l,a=h),o<u&&(o=u)):(ks(u,l.suspenseConfig),h=We(t,0,l,h,i,r),null!==l.callback&&(t.effectTag|=32,l.nextEffect=null,null===e.lastEffect?e.firstEffect=e.lastEffect=l:(e.lastEffect.nextEffect=l,e.lastEffect=l))),l=l.next}for(u=null,l=e.firstCapturedUpdate;null!==l;){var c=l.expirationTime;c<s?(null===u&&(u=l,null===n&&(a=h)),o<c&&(o=c)):(h=We(t,0,l,h,i,r),null!==l.callback&&(t.effectTag|=32,l.nextEffect=null,null===e.lastCapturedEffect?e.firstCapturedEffect=e.lastCapturedEffect=l:(e.lastCapturedEffect.nextEffect=l,e.lastCapturedEffect=l))),l=l.next}null===n&&(e.lastUpdate=null),null===u?e.lastCapturedUpdate=null:t.effectTag|=32,null===n&&null===u&&(a=h),e.baseState=a,e.firstUpdate=n,e.firstCapturedUpdate=u,Gs(o),t.expirationTime=o,t.memoizedState=h}function Ve(t,e,i){null!==e.firstCapturedUpdate&&(null!==e.lastUpdate&&(e.lastUpdate.next=e.firstCapturedUpdate,e.lastUpdate=e.lastCapturedUpdate),e.firstCapturedUpdate=e.lastCapturedUpdate=null),ze(e.firstEffect,i),e.firstEffect=e.lastEffect=null,ze(e.firstCapturedEffect,i),e.firstCapturedEffect=e.lastCapturedEffect=null}function ze(t,e){for(;null!==t;){var i=t.callback;if(null!==i){t.callback=null;var r=e;if("function"!=typeof i)throw Error(o(191,i));i.call(r)}t=t.nextEffect}}var He=l.ReactCurrentBatchConfig,Xe=(new a.Component).refs;function je(t,e,i,r){i=null==(i=i(r,e=t.memoizedState))?e:s({},e,i),t.memoizedState=i,null!==(r=t.updateQueue)&&0===t.expirationTime&&(r.baseState=i)}var qe={isMounted:function(t){return!!(t=t._reactInternalFiber)&&R(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternalFiber;var r=ws(),s=He.suspense;(s=Fe(r=Ms(r,t,s),s)).payload=e,null!=i&&(s.callback=i),Ue(t,s),Ls(t,r)},enqueueReplaceState:function(t,e,i){t=t._reactInternalFiber;var r=ws(),s=He.suspense;(s=Fe(r=Ms(r,t,s),s)).tag=1,s.payload=e,null!=i&&(s.callback=i),Ue(t,s),Ls(t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var i=ws(),r=He.suspense;(r=Fe(i=Ms(i,t,r),r)).tag=2,null!=e&&(r.callback=e),Ue(t,r),Ls(t,i)}};function Qe(t,e,i,r,s,a,n){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,a,n):!e.prototype||!e.prototype.isPureReactComponent||(!Te(i,r)||!Te(s,a))}function Ke(t,e,i){var r=!1,s=Dt,a=e.contextType;return"object"==typeof a&&null!==a?a=Pe(a):(s=Ut(e)?Ft:Bt.current,a=(r=null!=(r=e.contextTypes))?Nt(t,s):Dt),e=new e(i,a),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=qe,t.stateNode=e,e._reactInternalFiber=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function $e(t,e,i,r){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,r),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,r),e.state!==t&&qe.enqueueReplaceState(e,e.state,null)}function Ze(t,e,i,r){var s=t.stateNode;s.props=i,s.state=t.memoizedState,s.refs=Xe;var a=e.contextType;"object"==typeof a&&null!==a?s.context=Pe(a):(a=Ut(e)?Ft:Bt.current,s.context=Nt(t,a)),null!==(a=t.updateQueue)&&(Ye(t,a,i,s,r),s.state=t.memoizedState),"function"==typeof(a=e.getDerivedStateFromProps)&&(je(t,e,a,i),s.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof s.getSnapshotBeforeUpdate||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||(e=s.state,"function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),e!==s.state&&qe.enqueueReplaceState(s,s.state,null),null!==(a=t.updateQueue)&&(Ye(t,a,i,s,r),s.state=t.memoizedState)),"function"==typeof s.componentDidMount&&(t.effectTag|=4)}var Je=Array.isArray;function ti(t,e,i){if(null!==(t=i.ref)&&"function"!=typeof t&&"object"!=typeof t){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(o(309));var r=i.stateNode}if(!r)throw Error(o(147,t));var s=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===s?e.ref:((e=function(t){var e=r.refs;e===Xe&&(e=r.refs={}),null===t?delete e[s]:e[s]=t})._stringRef=s,e)}if("string"!=typeof t)throw Error(o(284));if(!i._owner)throw Error(o(290,t))}return t}function ei(t,e){if("textarea"!==t.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function ii(t){function e(e,i){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i,i.nextEffect=null,i.effectTag=8}}function i(i,r){if(!t)return null;for(;null!==r;)e(i,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function s(t,e,i){return(t=na(t,e)).index=0,t.sibling=null,t}function a(e,i,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<i?(e.effectTag=2,i):r:(e.effectTag=2,i):i}function n(e){return t&&null===e.alternate&&(e.effectTag=2),e}function l(t,e,i,r){return null===e||6!==e.tag?((e=ha(i,t.mode,r)).return=t,e):((e=s(e,i)).return=t,e)}function h(t,e,i,r){return null!==e&&e.elementType===i.type?((r=s(e,i.props)).ref=ti(t,e,i),r.return=t,r):((r=oa(i.type,i.key,i.props,null,t.mode,r)).ref=ti(t,e,i),r.return=t,r)}function d(t,e,i,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=ua(i,t.mode,r)).return=t,e):((e=s(e,i.children||[])).return=t,e)}function f(t,e,i,r,a){return null===e||7!==e.tag?((e=la(i,t.mode,r,a)).return=t,e):((e=s(e,i)).return=t,e)}function p(t,e,i){if("string"==typeof e||"number"==typeof e)return(e=ha(""+e,t.mode,i)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case u:return(i=oa(e.type,e.key,e.props,null,t.mode,i)).ref=ti(t,null,e),i.return=t,i;case c:return(e=ua(e,t.mode,i)).return=t,e}if(Je(e)||C(e))return(e=la(e,t.mode,i,null)).return=t,e;ei(t,e)}return null}function m(t,e,i,r){var s=null!==e?e.key:null;if("string"==typeof i||"number"==typeof i)return null!==s?null:l(t,e,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case u:return i.key===s?i.type===_?f(t,e,i.props.children,r,s):h(t,e,i,r):null;case c:return i.key===s?d(t,e,i,r):null}if(Je(i)||C(i))return null!==s?null:f(t,e,i,r,null);ei(t,i)}return null}function g(t,e,i,r,s){if("string"==typeof r||"number"==typeof r)return l(e,t=t.get(i)||null,""+r,s);if("object"==typeof r&&null!==r){switch(r.$$typeof){case u:return t=t.get(null===r.key?i:r.key)||null,r.type===_?f(e,t,r.props.children,s,r.key):h(e,t,r,s);case c:return d(e,t=t.get(null===r.key?i:r.key)||null,r,s)}if(Je(r)||C(r))return f(e,t=t.get(i)||null,r,s,null);ei(e,r)}return null}function v(s,n,o,l){for(var h=null,u=null,c=n,_=n=0,d=null;null!==c&&_<o.length;_++){c.index>_?(d=c,c=null):d=c.sibling;var f=m(s,c,o[_],l);if(null===f){null===c&&(c=d);break}t&&c&&null===f.alternate&&e(s,c),n=a(f,n,_),null===u?h=f:u.sibling=f,u=f,c=d}if(_===o.length)return i(s,c),h;if(null===c){for(;_<o.length;_++)null!==(c=p(s,o[_],l))&&(n=a(c,n,_),null===u?h=c:u.sibling=c,u=c);return h}for(c=r(s,c);_<o.length;_++)null!==(d=g(c,s,_,o[_],l))&&(t&&null!==d.alternate&&c.delete(null===d.key?_:d.key),n=a(d,n,_),null===u?h=d:u.sibling=d,u=d);return t&&c.forEach((function(t){return e(s,t)})),h}function y(s,n,l,h){var u=C(l);if("function"!=typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var c=u=null,_=n,d=n=0,f=null,v=l.next();null!==_&&!v.done;d++,v=l.next()){_.index>d?(f=_,_=null):f=_.sibling;var y=m(s,_,v.value,h);if(null===y){null===_&&(_=f);break}t&&_&&null===y.alternate&&e(s,_),n=a(y,n,d),null===c?u=y:c.sibling=y,c=y,_=f}if(v.done)return i(s,_),u;if(null===_){for(;!v.done;d++,v=l.next())null!==(v=p(s,v.value,h))&&(n=a(v,n,d),null===c?u=v:c.sibling=v,c=v);return u}for(_=r(s,_);!v.done;d++,v=l.next())null!==(v=g(_,s,d,v.value,h))&&(t&&null!==v.alternate&&_.delete(null===v.key?d:v.key),n=a(v,n,d),null===c?u=v:c.sibling=v,c=v);return t&&_.forEach((function(t){return e(s,t)})),u}return function(t,r,a,l){var h="object"==typeof a&&null!==a&&a.type===_&&null===a.key;h&&(a=a.props.children);var d="object"==typeof a&&null!==a;if(d)switch(a.$$typeof){case u:t:{for(d=a.key,h=r;null!==h;){if(h.key===d){if(7===h.tag?a.type===_:h.elementType===a.type){i(t,h.sibling),(r=s(h,a.type===_?a.props.children:a.props)).ref=ti(t,h,a),r.return=t,t=r;break t}i(t,h);break}e(t,h),h=h.sibling}a.type===_?((r=la(a.props.children,t.mode,l,a.key)).return=t,t=r):((l=oa(a.type,a.key,a.props,null,t.mode,l)).ref=ti(t,r,a),l.return=t,t=l)}return n(t);case c:t:{for(h=a.key;null!==r;){if(r.key===h){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){i(t,r.sibling),(r=s(r,a.children||[])).return=t,t=r;break t}i(t,r);break}e(t,r),r=r.sibling}(r=ua(a,t.mode,l)).return=t,t=r}return n(t)}if("string"==typeof a||"number"==typeof a)return a=""+a,null!==r&&6===r.tag?(i(t,r.sibling),(r=s(r,a)).return=t,t=r):(i(t,r),(r=ha(a,t.mode,l)).return=t,t=r),n(t);if(Je(a))return v(t,r,a,l);if(C(a))return y(t,r,a,l);if(d&&ei(t,a),void 0===a&&!h)switch(t.tag){case 1:case 0:throw t=t.type,Error(o(152,t.displayName||t.name||"Component"))}return i(t,r)}}var ri=ii(!0),si=ii(!1),ai={},ni={current:ai},oi={current:ai},li={current:ai};function hi(t){if(t===ai)throw Error(o(174));return t}function ui(t,e){Pt(li,e),Pt(oi,t),Pt(ni,ai),e=A(e),At(ni),Pt(ni,e)}function ci(t){At(ni),At(oi),At(li)}function _i(t){var e=hi(li.current),i=hi(ni.current);i!==(e=P(i,t.type,e))&&(Pt(oi,t),Pt(ni,e))}function di(t){oi.current===t&&(At(ni),At(oi))}var fi={current:0};function pi(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||vt(i)||yt(i)))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(64&e.effectTag))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function mi(t,e){return{responder:t,props:e}}var gi=l.ReactCurrentDispatcher,vi=l.ReactCurrentBatchConfig,yi=0,xi=null,Ti=null,bi=null,Ei=null,Ci=null,Si=null,Ri=0,wi=null,Mi=0,Li=!1,Ii=null,Ai=0;function Pi(){throw Error(o(321))}function Di(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!ye(t[i],e[i]))return!1;return!0}function Bi(t,e,i,r,s,a){if(yi=a,xi=e,bi=null!==t?t.memoizedState:null,gi.current=null===bi?Ji:tr,e=i(r,s),Li){do{Li=!1,Ai+=1,bi=null!==t?t.memoizedState:null,Si=Ei,wi=Ci=Ti=null,gi.current=tr,e=i(r,s)}while(Li);Ii=null,Ai=0}if(gi.current=Zi,(t=xi).memoizedState=Ei,t.expirationTime=Ri,t.updateQueue=wi,t.effectTag|=Mi,t=null!==Ti&&null!==Ti.next,yi=0,Si=Ci=Ei=bi=Ti=xi=null,Ri=0,wi=null,Mi=0,t)throw Error(o(300));return e}function Oi(){gi.current=Zi,yi=0,Si=Ci=Ei=bi=Ti=xi=null,Ri=0,wi=null,Mi=0,Li=!1,Ii=null,Ai=0}function Fi(){var t={memoizedState:null,baseState:null,queue:null,baseUpdate:null,next:null};return null===Ci?Ei=Ci=t:Ci=Ci.next=t,Ci}function Ni(){if(null!==Si)Si=(Ci=Si).next,bi=null!==(Ti=bi)?Ti.next:null;else{if(null===bi)throw Error(o(310));var t={memoizedState:(Ti=bi).memoizedState,baseState:Ti.baseState,queue:Ti.queue,baseUpdate:Ti.baseUpdate,next:null};Ci=null===Ci?Ei=t:Ci.next=t,bi=Ti.next}return Ci}function Ui(t,e){return"function"==typeof e?e(t):e}function ki(t){var e=Ni(),i=e.queue;if(null===i)throw Error(o(311));if(i.lastRenderedReducer=t,0<Ai){var r=i.dispatch;if(null!==Ii){var s=Ii.get(i);if(void 0!==s){Ii.delete(i);var a=e.memoizedState;do{a=t(a,s.action),s=s.next}while(null!==s);return ye(a,e.memoizedState)||(cr=!0),e.memoizedState=a,e.baseUpdate===i.last&&(e.baseState=a),i.lastRenderedState=a,[a,r]}}return[e.memoizedState,r]}r=i.last;var n=e.baseUpdate;if(a=e.baseState,null!==n?(null!==r&&(r.next=null),r=n.next):r=null!==r?r.next:null,null!==r){var l=s=null,h=r,u=!1;do{var c=h.expirationTime;c<yi?(u||(u=!0,l=n,s=a),c>Ri&&Gs(Ri=c)):(ks(c,h.suspenseConfig),a=h.eagerReducer===t?h.eagerState:t(a,h.action)),n=h,h=h.next}while(null!==h&&h!==r);u||(l=n,s=a),ye(a,e.memoizedState)||(cr=!0),e.memoizedState=a,e.baseUpdate=l,e.baseState=s,i.lastRenderedState=a}return[e.memoizedState,i.dispatch]}function Gi(t){var e=Fi();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={last:null,dispatch:null,lastRenderedReducer:Ui,lastRenderedState:t}).dispatch=$i.bind(null,xi,t),[e.memoizedState,t]}function Wi(t){return ki(Ui)}function Yi(t,e,i,r){return t={tag:t,create:e,destroy:i,deps:r,next:null},null===wi?(wi={lastEffect:null}).lastEffect=t.next=t:null===(e=wi.lastEffect)?wi.lastEffect=t.next=t:(i=e.next,e.next=t,t.next=i,wi.lastEffect=t),t}function Vi(t,e,i,r){var s=Fi();Mi|=t,s.memoizedState=Yi(e,i,void 0,void 0===r?null:r)}function zi(t,e,i,r){var s=Ni();r=void 0===r?null:r;var a=void 0;if(null!==Ti){var n=Ti.memoizedState;if(a=n.destroy,null!==r&&Di(r,n.deps))return void Yi(0,i,a,r)}Mi|=t,s.memoizedState=Yi(e,i,a,r)}function Hi(t,e){return Vi(516,192,t,e)}function Xi(t,e){return zi(516,192,t,e)}function ji(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function qi(){}function Qi(t,e){return Fi().memoizedState=[t,void 0===e?null:e],t}function Ki(t,e){var i=Ni();e=void 0===e?null:e;var r=i.memoizedState;return null!==r&&null!==e&&Di(e,r[1])?r[0]:(i.memoizedState=[t,e],t)}function $i(t,e,i){if(!(25>Ai))throw Error(o(301));var r=t.alternate;if(t===xi||null!==r&&r===xi)if(Li=!0,t={expirationTime:yi,suspenseConfig:null,action:i,eagerReducer:null,eagerState:null,next:null},null===Ii&&(Ii=new Map),void 0===(i=Ii.get(e)))Ii.set(e,t);else{for(e=i;null!==e.next;)e=e.next;e.next=t}else{var s=ws(),a=He.suspense;a={expirationTime:s=Ms(s,t,a),suspenseConfig:a,action:i,eagerReducer:null,eagerState:null,next:null};var n=e.last;if(null===n)a.next=a;else{var l=n.next;null!==l&&(a.next=l),n.next=a}if(e.last=a,0===t.expirationTime&&(null===r||0===r.expirationTime)&&null!==(r=e.lastRenderedReducer))try{var h=e.lastRenderedState,u=r(h,i);if(a.eagerReducer=r,a.eagerState=u,ye(u,h))return}catch(t){}Ls(t,s)}}var Zi={readContext:Pe,useCallback:Pi,useContext:Pi,useEffect:Pi,useImperativeHandle:Pi,useLayoutEffect:Pi,useMemo:Pi,useReducer:Pi,useRef:Pi,useState:Pi,useDebugValue:Pi,useResponder:Pi,useDeferredValue:Pi,useTransition:Pi},Ji={readContext:Pe,useCallback:Qi,useContext:Pe,useEffect:Hi,useImperativeHandle:function(t,e,i){return i=null!=i?i.concat([t]):null,Vi(4,36,ji.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Vi(4,36,t,e)},useMemo:function(t,e){var i=Fi();return e=void 0===e?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var r=Fi();return e=void 0!==i?i(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={last:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=$i.bind(null,xi,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},Fi().memoizedState=t},useState:Gi,useDebugValue:qi,useResponder:mi,useDeferredValue:function(t,e){var i=Gi(t),r=i[0],s=i[1];return Hi((function(){n.unstable_next((function(){var i=vi.suspense;vi.suspense=void 0===e?null:e;try{s(t)}finally{vi.suspense=i}}))}),[t,e]),r},useTransition:function(t){var e=Gi(!1),i=e[0],r=e[1];return[Qi((function(e){r(!0),n.unstable_next((function(){var i=vi.suspense;vi.suspense=void 0===t?null:t;try{r(!1),e()}finally{vi.suspense=i}}))}),[t,i]),i]}},tr={readContext:Pe,useCallback:Ki,useContext:Pe,useEffect:Xi,useImperativeHandle:function(t,e,i){return i=null!=i?i.concat([t]):null,zi(4,36,ji.bind(null,e,t),i)},useLayoutEffect:function(t,e){return zi(4,36,t,e)},useMemo:function(t,e){var i=Ni();e=void 0===e?null:e;var r=i.memoizedState;return null!==r&&null!==e&&Di(e,r[1])?r[0]:(t=t(),i.memoizedState=[t,e],t)},useReducer:ki,useRef:function(){return Ni().memoizedState},useState:Wi,useDebugValue:qi,useResponder:mi,useDeferredValue:function(t,e){var i=Wi(),r=i[0],s=i[1];return Xi((function(){n.unstable_next((function(){var i=vi.suspense;vi.suspense=void 0===e?null:e;try{s(t)}finally{vi.suspense=i}}))}),[t,e]),r},useTransition:function(t){var e=Wi(),i=e[0],r=e[1];return[Ki((function(e){r(!0),n.unstable_next((function(){var i=vi.suspense;vi.suspense=void 0===t?null:t;try{r(!1),e()}finally{vi.suspense=i}}))}),[t,i]),i]}},er=null,ir=null,rr=!1;function sr(t,e){var i=sa(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=e,i.return=t,i.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i}function ar(t,e){switch(t.tag){case 5:return null!==(e=mt(e,t.type,t.pendingProps))&&(t.stateNode=e,!0);case 6:return null!==(e=gt(e,t.pendingProps))&&(t.stateNode=e,!0);case 13:default:return!1}}function nr(t){if(rr){var e=ir;if(e){var i=e;if(!ar(t,e)){if(!(e=xt(i))||!ar(t,e))return t.effectTag=-1025&t.effectTag|2,rr=!1,void(er=t);sr(er,i)}er=t,ir=Tt(e)}else t.effectTag=-1025&t.effectTag|2,rr=!1,er=t}}function or(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;er=t}function lr(t){if(!q||t!==er)return!1;if(!rr)return or(t),rr=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!k(e,t.memoizedProps))for(e=ir;e;)sr(t,e),e=xt(e);if(or(t),13===t.tag){if(!q)throw Error(o(316));if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));ir=Ct(t)}else ir=er?xt(t.stateNode):null;return!0}function hr(){q&&(ir=er=null,rr=!1)}var ur=l.ReactCurrentOwner,cr=!1;function _r(t,e,i,r){e.child=null===t?si(e,null,i,r):ri(e,t.child,i,r)}function dr(t,e,i,r,s){i=i.render;var a=e.ref;return Ae(e,s),r=Bi(t,e,i,r,a,s),null===t||cr?(e.effectTag|=1,_r(t,e,r,s),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=s&&(t.expirationTime=0),Ir(t,e,s))}function fr(t,e,i,r,s,a){if(null===t){var n=i.type;return"function"!=typeof n||aa(n)||void 0!==n.defaultProps||null!==i.compare||void 0!==i.defaultProps?((t=oa(i.type,null,r,null,e.mode,a)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=n,pr(t,e,n,r,s,a))}return n=t.child,s<a&&(s=n.memoizedProps,(i=null!==(i=i.compare)?i:Te)(s,r)&&t.ref===e.ref)?Ir(t,e,a):(e.effectTag|=1,(t=na(n,r)).ref=e.ref,t.return=e,e.child=t)}function pr(t,e,i,r,s,a){return null!==t&&Te(t.memoizedProps,r)&&t.ref===e.ref&&(cr=!1,s<a)?Ir(t,e,a):gr(t,e,i,r,a)}function mr(t,e){var i=e.ref;(null===t&&null!==i||null!==t&&t.ref!==i)&&(e.effectTag|=128)}function gr(t,e,i,r,s){var a=Ut(i)?Ft:Bt.current;return a=Nt(e,a),Ae(e,s),i=Bi(t,e,i,r,a,s),null===t||cr?(e.effectTag|=1,_r(t,e,i,s),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=s&&(t.expirationTime=0),Ir(t,e,s))}function vr(t,e,i,r,s){if(Ut(i)){var a=!0;Vt(e)}else a=!1;if(Ae(e,s),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),Ke(e,i,r),Ze(e,i,r,s),r=!0;else if(null===t){var n=e.stateNode,o=e.memoizedProps;n.props=o;var l=n.context,h=i.contextType;"object"==typeof h&&null!==h?h=Pe(h):h=Nt(e,h=Ut(i)?Ft:Bt.current);var u=i.getDerivedStateFromProps,c="function"==typeof u||"function"==typeof n.getSnapshotBeforeUpdate;c||"function"!=typeof n.UNSAFE_componentWillReceiveProps&&"function"!=typeof n.componentWillReceiveProps||(o!==r||l!==h)&&$e(e,n,r,h),De=!1;var _=e.memoizedState;l=n.state=_;var d=e.updateQueue;null!==d&&(Ye(e,d,r,n,s),l=e.memoizedState),o!==r||_!==l||Ot.current||De?("function"==typeof u&&(je(e,i,u,r),l=e.memoizedState),(o=De||Qe(e,i,o,r,_,l,h))?(c||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||("function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount()),"function"==typeof n.componentDidMount&&(e.effectTag|=4)):("function"==typeof n.componentDidMount&&(e.effectTag|=4),e.memoizedProps=r,e.memoizedState=l),n.props=r,n.state=l,n.context=h,r=o):("function"==typeof n.componentDidMount&&(e.effectTag|=4),r=!1)}else n=e.stateNode,o=e.memoizedProps,n.props=e.type===e.elementType?o:be(e.type,o),l=n.context,"object"==typeof(h=i.contextType)&&null!==h?h=Pe(h):h=Nt(e,h=Ut(i)?Ft:Bt.current),(c="function"==typeof(u=i.getDerivedStateFromProps)||"function"==typeof n.getSnapshotBeforeUpdate)||"function"!=typeof n.UNSAFE_componentWillReceiveProps&&"function"!=typeof n.componentWillReceiveProps||(o!==r||l!==h)&&$e(e,n,r,h),De=!1,l=e.memoizedState,_=n.state=l,null!==(d=e.updateQueue)&&(Ye(e,d,r,n,s),_=e.memoizedState),o!==r||l!==_||Ot.current||De?("function"==typeof u&&(je(e,i,u,r),_=e.memoizedState),(u=De||Qe(e,i,o,r,l,_,h))?(c||"function"!=typeof n.UNSAFE_componentWillUpdate&&"function"!=typeof n.componentWillUpdate||("function"==typeof n.componentWillUpdate&&n.componentWillUpdate(r,_,h),"function"==typeof n.UNSAFE_componentWillUpdate&&n.UNSAFE_componentWillUpdate(r,_,h)),"function"==typeof n.componentDidUpdate&&(e.effectTag|=4),"function"==typeof n.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!=typeof n.componentDidUpdate||o===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!=typeof n.getSnapshotBeforeUpdate||o===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),e.memoizedProps=r,e.memoizedState=_),n.props=r,n.state=_,n.context=h,r=u):("function"!=typeof n.componentDidUpdate||o===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!=typeof n.getSnapshotBeforeUpdate||o===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),r=!1);return yr(t,e,i,r,a,s)}function yr(t,e,i,r,s,a){mr(t,e);var n=0!=(64&e.effectTag);if(!r&&!n)return s&&zt(e,i,!1),Ir(t,e,a);r=e.stateNode,ur.current=e;var o=n&&"function"!=typeof i.getDerivedStateFromError?null:r.render();return e.effectTag|=1,null!==t&&n?(e.child=ri(e,t.child,null,a),e.child=ri(e,null,o,a)):_r(t,e,o,a),e.memoizedState=r.state,s&&zt(e,i,!0),e.child}function xr(t){var e=t.stateNode;e.pendingContext?Wt(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Wt(0,e.context,!1),ui(t,e.containerInfo)}var Tr,br,Er,Cr,Sr={dehydrated:null,retryTime:0};function Rr(t,e,i){var r,s=e.mode,a=e.pendingProps,n=fi.current,o=!1;if((r=0!=(64&e.effectTag))||(r=0!=(2&n)&&(null===t||null!==t.memoizedState)),r?(o=!0,e.effectTag&=-65):null!==t&&null===t.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(n|=1),Pt(fi,1&n),null===t){if(void 0!==a.fallback&&nr(e),o){if(o=a.fallback,(a=la(null,s,0,null)).return=e,0==(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,a.child=t;null!==t;)t.return=a,t=t.sibling;return(i=la(o,s,i,null)).return=e,a.sibling=i,e.memoizedState=Sr,e.child=a,i}return s=a.children,e.memoizedState=null,e.child=si(e,null,s,i)}if(null!==t.memoizedState){if(s=(t=t.child).sibling,o){if(a=a.fallback,(i=na(t,t.pendingProps)).return=e,0==(2&e.mode)&&(o=null!==e.memoizedState?e.child.child:e.child)!==t.child)for(i.child=o;null!==o;)o.return=i,o=o.sibling;return(s=na(s,a,s.expirationTime)).return=e,i.sibling=s,i.childExpirationTime=0,e.memoizedState=Sr,e.child=i,s}return i=ri(e,t.child,a.children,i),e.memoizedState=null,e.child=i}if(t=t.child,o){if(o=a.fallback,(a=la(null,s,0,null)).return=e,a.child=t,null!==t&&(t.return=a),0==(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,a.child=t;null!==t;)t.return=a,t=t.sibling;return(i=la(o,s,i,null)).return=e,a.sibling=i,i.effectTag|=2,a.childExpirationTime=0,e.memoizedState=Sr,e.child=a,i}return e.memoizedState=null,e.child=ri(e,t,a.children,i)}function wr(t,e){t.expirationTime<e&&(t.expirationTime=e);var i=t.alternate;null!==i&&i.expirationTime<e&&(i.expirationTime=e),Ie(t.return,e)}function Mr(t,e,i,r,s,a){var n=t.memoizedState;null===n?t.memoizedState={isBackwards:e,rendering:null,last:r,tail:i,tailExpiration:0,tailMode:s,lastEffect:a}:(n.isBackwards=e,n.rendering=null,n.last=r,n.tail=i,n.tailExpiration=0,n.tailMode=s,n.lastEffect=a)}function Lr(t,e,i){var r=e.pendingProps,s=r.revealOrder,a=r.tail;if(_r(t,e,r.children,i),0!=(2&(r=fi.current)))r=1&r|2,e.effectTag|=64;else{if(null!==t&&0!=(64&t.effectTag))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&wr(t,i);else if(19===t.tag)wr(t,i);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Pt(fi,r),0==(2&e.mode))e.memoizedState=null;else switch(s){case"forwards":for(i=e.child,s=null;null!==i;)null!==(t=i.alternate)&&null===pi(t)&&(s=i),i=i.sibling;null===(i=s)?(s=e.child,e.child=null):(s=i.sibling,i.sibling=null),Mr(e,!1,s,i,a,e.lastEffect);break;case"backwards":for(i=null,s=e.child,e.child=null;null!==s;){if(null!==(t=s.alternate)&&null===pi(t)){e.child=s;break}t=s.sibling,s.sibling=i,i=s,s=t}Mr(e,!0,i,null,a,e.lastEffect);break;case"together":Mr(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function Ir(t,e,i){null!==t&&(e.dependencies=t.dependencies);var r=e.expirationTime;if(0!==r&&Gs(r),e.childExpirationTime<i)return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(i=na(t=e.child,t.pendingProps,t.expirationTime),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=na(t,t.pendingProps,t.expirationTime)).return=e;i.sibling=null}return e.child}function Ar(t){t.effectTag|=4}if(X)Tr=function(t,e){for(var i=e.child;null!==i;){if(5===i.tag||6===i.tag)F(t,i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},br=function(){},Er=function(t,e,i,r,s){if((t=t.memoizedProps)!==r){var a=e.stateNode,n=hi(ni.current);i=U(a,i,t,r,s,n),(e.updateQueue=i)&&Ar(e)}},Cr=function(t,e,i,r){i!==r&&Ar(e)};else if(j){Tr=function(t,e,i,r){for(var s=e.child;null!==s;){if(5===s.tag){var a=s.stateNode;i&&r&&(a=ft(a,s.type,s.memoizedProps,s)),F(t,a)}else if(6===s.tag)a=s.stateNode,i&&r&&(a=pt(a,s.memoizedProps,s)),F(t,a);else if(4!==s.tag){if(13===s.tag&&0!=(4&s.effectTag)&&(a=null!==s.memoizedState)){var n=s.child;if(null!==n&&(null!==n.child&&(n.child.return=n,Tr(t,n,!0,a)),null!==(a=n.sibling))){a.return=s,s=a;continue}}if(null!==s.child){s.child.return=s,s=s.child;continue}}if(s===e)break;for(;null===s.sibling;){if(null===s.return||s.return===e)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};var Pr=function(t,e,i,r){for(var s=e.child;null!==s;){if(5===s.tag){var a=s.stateNode;i&&r&&(a=ft(a,s.type,s.memoizedProps,s)),ct(t,a)}else if(6===s.tag)a=s.stateNode,i&&r&&(a=pt(a,s.memoizedProps,s)),ct(t,a);else if(4!==s.tag){if(13===s.tag&&0!=(4&s.effectTag)&&(a=null!==s.memoizedState)){var n=s.child;if(null!==n&&(null!==n.child&&(n.child.return=n,Pr(t,n,!0,a)),null!==(a=n.sibling))){a.return=s,s=a;continue}}if(null!==s.child){s.child.return=s,s=s.child;continue}}if(s===e)break;for(;null===s.sibling;){if(null===s.return||s.return===e)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};br=function(t){var e=t.stateNode;if(null!==t.firstEffect){var i=e.containerInfo,r=ut(i);Pr(r,t,!1,!1),e.pendingChildren=r,Ar(t),_t(i,r)}},Er=function(t,e,i,r,s){var a=t.stateNode,n=t.memoizedProps;if((t=null===e.firstEffect)&&n===r)e.stateNode=a;else{var o=e.stateNode,l=hi(ni.current),h=null;n!==r&&(h=U(o,i,n,r,s,l)),t&&null===h?e.stateNode=a:(a=ht(a,h,i,n,r,e,t,o),N(a,i,r,s,l)&&Ar(e),e.stateNode=a,t?Ar(e):Tr(a,e,!1,!1))}},Cr=function(t,e,i,r){i!==r&&(t=hi(li.current),i=hi(ni.current),e.stateNode=W(r,t,i,e),Ar(e))}}else br=function(){},Er=function(){},Cr=function(){};function Dr(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var r=null;null!==i;)null!==i.alternate&&(r=i),i=i.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Br(t){switch(t.tag){case 1:Ut(t.type)&&kt();var e=t.effectTag;return 4096&e?(t.effectTag=-4097&e|64,t):null;case 3:if(ci(),Gt(),0!=(64&(e=t.effectTag)))throw Error(o(285));return t.effectTag=-4097&e|64,t;case 5:return di(t),null;case 13:return At(fi),4096&(e=t.effectTag)?(t.effectTag=-4097&e|64,t):null;case 19:return At(fi),null;case 4:return ci(),null;case 10:return Le(t),null;default:return null}}function Or(t,e){return{value:t,source:e,stack:Mt(e)}}var Fr="function"==typeof WeakSet?WeakSet:Set;function Nr(t,e){var i=e.source,r=e.stack;null===r&&null!==i&&(r=Mt(i)),null!==i&&S(i.type),e=e.value,null!==t&&1===t.tag&&S(t.type);try{console.error(e)}catch(t){setTimeout((function(){throw t}))}}function Ur(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){Zs(t,e)}else e.current=null}function kr(t,e){switch(e.tag){case 0:case 11:case 15:Gr(2,0,e);break;case 1:if(256&e.effectTag&&null!==t){var i=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?i:be(e.type,i),r),t.__reactInternalSnapshotBeforeUpdate=e}break;case 3:case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}function Gr(t,e,i){if(null!==(i=null!==(i=i.updateQueue)?i.lastEffect:null)){var r=i=i.next;do{if(0!=(r.tag&t)){var s=r.destroy;r.destroy=void 0,void 0!==s&&s()}0!=(r.tag&e)&&(s=r.create,r.destroy=s()),r=r.next}while(r!==i)}}function Wr(t,e,i){switch("function"==typeof ia&&ia(e),e.tag){case 0:case 11:case 14:case 15:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var r=t.next;_e(97<i?97:i,(function(){var t=r;do{var i=t.destroy;if(void 0!==i){var s=e;try{i()}catch(t){Zs(s,t)}}t=t.next}while(t!==r)}))}break;case 1:Ur(e),"function"==typeof(i=e.stateNode).componentWillUnmount&&function(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Zs(t,e)}}(e,i);break;case 5:Ur(e);break;case 4:X?Xr(t,e,i):j&&function(t){if(j){t=t.stateNode.containerInfo;var e=ut(t);dt(t,e)}}(e)}}function Yr(t,e,i){for(var r=e;;)if(Wr(t,r,i),null===r.child||X&&4===r.tag){if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}else r.child.return=r,r=r.child}function Vr(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,null!==e&&Vr(e)}function zr(t){return 5===t.tag||3===t.tag||4===t.tag}function Hr(t){if(X){t:{for(var e=t.return;null!==e;){if(zr(e)){var i=e;break t}e=e.return}throw Error(o(160))}switch(e=i.stateNode,i.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(o(161))}16&i.effectTag&&(st(e),i.effectTag&=-17);t:e:for(i=t;;){for(;null===i.sibling;){if(null===i.return||zr(i.return)){i=null;break t}i=i.return}for(i.sibling.return=i.return,i=i.sibling;5!==i.tag&&6!==i.tag&&18!==i.tag;){if(2&i.effectTag)continue e;if(null===i.child||4===i.tag)continue e;i.child.return=i,i=i.child}if(!(2&i.effectTag)){i=i.stateNode;break t}}for(var s=t;;){var a=5===s.tag||6===s.tag;if(a)a=a?s.stateNode:s.stateNode.instance,i?r?et(e,a,i):tt(e,a,i):r?K(e,a):Q(e,a);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}}}function Xr(t,e,i){for(var r,s,a=e,n=!1;;){if(!n){n=a.return;t:for(;;){if(null===n)throw Error(o(160));switch(r=n.stateNode,n.tag){case 5:s=!1;break t;case 3:case 4:r=r.containerInfo,s=!0;break t}n=n.return}n=!0}if(5===a.tag||6===a.tag)Yr(t,a,i),s?rt(r,a.stateNode):it(r,a.stateNode);else if(4===a.tag){if(null!==a.child){r=a.stateNode.containerInfo,s=!0,a.child.return=a,a=a.child;continue}}else if(Wr(t,a,i),null!==a.child){a.child.return=a,a=a.child;continue}if(a===e)break;for(;null===a.sibling;){if(null===a.return||a.return===e)return;4===(a=a.return).tag&&(n=!1)}a.sibling.return=a.return,a=a.sibling}}function jr(t,e){if(X)switch(e.tag){case 0:case 11:case 14:case 15:Gr(4,8,e);break;case 1:break;case 5:var i=e.stateNode;if(null!=i){var r=e.memoizedProps;t=null!==t?t.memoizedProps:r;var s=e.type,a=e.updateQueue;e.updateQueue=null,null!==a&&J(i,a,s,t,r,e)}break;case 6:if(null===e.stateNode)throw Error(o(162));i=e.memoizedProps,$(e.stateNode,null!==t?t.memoizedProps:i,i);break;case 3:q&&((e=e.stateNode).hydrate&&(e.hydrate=!1,St(e.containerInfo)));break;case 12:break;case 13:qr(e),Qr(e);break;case 19:Qr(e);break;case 17:case 20:case 21:break;default:throw Error(o(163))}else{switch(e.tag){case 0:case 11:case 14:case 15:return void Gr(4,8,e);case 12:return;case 13:return qr(e),void Qr(e);case 19:return void Qr(e);case 3:q&&((i=e.stateNode).hydrate&&(i.hydrate=!1,St(i.containerInfo)))}t:if(j)switch(e.tag){case 1:case 5:case 6:case 20:break t;case 3:case 4:e=e.stateNode,dt(e.containerInfo,e.pendingChildren);break t;default:throw Error(o(163))}}}function qr(t){var e=t;if(null===t.memoizedState)var i=!1;else i=!0,e=t.child,ps=he();if(X&&null!==e)t:if(t=e,X)for(e=t;;){if(5===e.tag){var r=e.stateNode;i?at(r):ot(e.stateNode,e.memoizedProps)}else if(6===e.tag)r=e.stateNode,i?nt(r):lt(r,e.memoizedProps);else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(r=e.child.sibling).return=e,e=r;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===t)break t;for(;null===e.sibling;){if(null===e.return||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}}function Qr(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var i=t.stateNode;null===i&&(i=t.stateNode=new Fr),e.forEach((function(e){var r=ta.bind(null,t,e);i.has(e)||(i.add(e),e.then(r,r))}))}}var Kr="function"==typeof WeakMap?WeakMap:Map;function $r(t,e,i){(i=Fe(i,null)).tag=3,i.payload={element:null};var r=e.value;return i.callback=function(){gs||(gs=!0,vs=r),Nr(t,e)},i}function Zr(t,e,i){(i=Fe(i,null)).tag=3;var r=t.type.getDerivedStateFromError;if("function"==typeof r){var s=e.value;i.payload=function(){return Nr(t,e),r(s)}}var a=t.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(i.callback=function(){"function"!=typeof r&&(null===ys?ys=new Set([this]):ys.add(this),Nr(t,e));var i=e.stack;this.componentDidCatch(e.value,{componentStack:null!==i?i:""})}),i}var Jr,ts=Math.ceil,es=l.ReactCurrentDispatcher,is=l.ReactCurrentOwner,rs=16,ss=0,as=null,ns=null,os=0,ls=0,hs=null,us=1073741823,cs=1073741823,_s=null,ds=0,fs=!1,ps=0,ms=null,gs=!1,vs=null,ys=null,xs=!1,Ts=null,bs=90,Es=null,Cs=0,Ss=null,Rs=0;function ws(){return 0!=(48&ss)?1073741821-(he()/10|0):0!==Rs?Rs:Rs=1073741821-(he()/10|0)}function Ms(t,e,i){if(0==(2&(e=e.mode)))return 1073741823;var r=ue();if(0==(4&e))return 99===r?1073741823:1073741822;if(0!=(ss&rs))return os;if(null!==i)t=ve(t,0|i.timeoutMs||5e3,250);else switch(r){case 99:t=1073741823;break;case 98:t=ve(t,150,100);break;case 97:case 96:t=ve(t,5e3,250);break;case 95:t=2;break;default:throw Error(o(326))}return null!==as&&t===os&&--t,t}function Ls(t,e){if(50<Cs)throw Cs=0,Ss=null,Error(o(185));if(null!==(t=Is(t,e))){var i=ue();1073741823===e?0!=(8&ss)&&0==(48&ss)?Bs(t):(Ps(t),0===ss&&pe()):Ps(t),0==(4&ss)||98!==i&&99!==i||(null===Es?Es=new Map([[t,e]]):(void 0===(i=Es.get(t))||i>e)&&Es.set(t,e))}}function Is(t,e){t.expirationTime<e&&(t.expirationTime=e);var i=t.alternate;null!==i&&i.expirationTime<e&&(i.expirationTime=e);var r=t.return,s=null;if(null===r&&3===t.tag)s=t.stateNode;else for(;null!==r;){if(i=r.alternate,r.childExpirationTime<e&&(r.childExpirationTime=e),null!==i&&i.childExpirationTime<e&&(i.childExpirationTime=e),null===r.return&&3===r.tag){s=r.stateNode;break}r=r.return}return null!==s&&(as===s&&(Gs(e),4===ls&&da(s,os)),fa(s,e)),s}function As(t){var e=t.lastExpiredTime;return 0!==e?e:_a(t,e=t.firstPendingTime)?(e=t.lastPingedTime)>(t=t.nextKnownPendingLevel)?e:t:e}function Ps(t){if(0!==t.lastExpiredTime)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=fe(Bs.bind(null,t));else{var e=As(t),i=t.callbackNode;if(0===e)null!==i&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var r=ws();if(1073741823===e?r=99:1===e||2===e?r=95:r=0>=(r=10*(1073741821-e)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==i){var s=t.callbackPriority;if(t.callbackExpirationTime===e&&s>=r)return;i!==re&&jt(i)}t.callbackExpirationTime=e,t.callbackPriority=r,e=1073741823===e?fe(Bs.bind(null,t)):de(r,Ds.bind(null,t),{timeout:10*(1073741821-e)-he()}),t.callbackNode=e}}}function Ds(t,e){if(Rs=0,e)return pa(t,e=ws()),Ps(t),null;var i=As(t);if(0!==i){if(e=t.callbackNode,0!=(48&ss))throw Error(o(327));if(Qs(),t===as&&i===os||Fs(t,i),null!==ns){var r=ss;ss|=rs;for(var s=Us();;)try{Ys();break}catch(e){Ns(t,e)}if(we(),ss=r,es.current=s,1===ls)throw e=hs,Fs(t,i),da(t,i),Ps(t),e;if(null===ns)switch(s=t.finishedWork=t.current.alternate,t.finishedExpirationTime=i,r=ls,as=null,r){case 0:case 1:throw Error(o(345));case 2:pa(t,2<i?2:i);break;case 3:if(da(t,i),i===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=Hs(s)),1073741823===us&&10<(s=ps+500-he())){if(fs){var a=t.lastPingedTime;if(0===a||a>=i){t.lastPingedTime=i,Fs(t,i);break}}if(0!==(a=As(t))&&a!==i)break;if(0!==r&&r!==i){t.lastPingedTime=r;break}t.timeoutHandle=Y(Xs.bind(null,t),s);break}Xs(t);break;case 4:if(da(t,i),i===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=Hs(s)),fs&&(0===(s=t.lastPingedTime)||s>=i)){t.lastPingedTime=i,Fs(t,i);break}if(0!==(s=As(t))&&s!==i)break;if(0!==r&&r!==i){t.lastPingedTime=r;break}if(1073741823!==cs?r=10*(1073741821-cs)-he():1073741823===us?r=0:(r=10*(1073741821-us)-5e3,0>(r=(s=he())-r)&&(r=0),(i=10*(1073741821-i)-s)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ts(r/1960))-r)&&(r=i)),10<r){t.timeoutHandle=Y(Xs.bind(null,t),r);break}Xs(t);break;case 5:if(1073741823!==us&&null!==_s){a=us;var n=_s;if(0>=(r=0|n.busyMinDurationMs)?r=0:(s=0|n.busyDelayMs,r=(a=he()-(10*(1073741821-a)-(0|n.timeoutMs||5e3)))<=s?0:s+r-a),10<r){da(t,i),t.timeoutHandle=Y(Xs.bind(null,t),r);break}}Xs(t);break;default:throw Error(o(329))}if(Ps(t),t.callbackNode===e)return Ds.bind(null,t)}}return null}function Bs(t){var e=t.lastExpiredTime;if(e=0!==e?e:1073741823,t.finishedExpirationTime===e)Xs(t);else{if(0!=(48&ss))throw Error(o(327));if(Qs(),t===as&&e===os||Fs(t,e),null!==ns){var i=ss;ss|=rs;for(var r=Us();;)try{Ws();break}catch(e){Ns(t,e)}if(we(),ss=i,es.current=r,1===ls)throw i=hs,Fs(t,e),da(t,e),Ps(t),i;if(null!==ns)throw Error(o(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,as=null,Xs(t),Ps(t)}}return null}function Os(t,e){if(0!=(48&ss))throw Error(o(187));var i=ss;ss|=1;try{return _e(99,t.bind(null,e))}finally{ss=i,pe()}}function Fs(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var i=t.timeoutHandle;if(i!==z&&(t.timeoutHandle=z,V(i)),null!==ns)for(i=ns.return;null!==i;){var r=i;switch(r.tag){case 1:var s=r.type.childContextTypes;null!=s&&kt();break;case 3:ci(),Gt();break;case 5:di(r);break;case 4:ci();break;case 13:case 19:At(fi);break;case 10:Le(r)}i=i.return}as=t,ns=na(t.current,null),os=e,ls=0,hs=null,cs=us=1073741823,_s=null,ds=0,fs=!1}function Ns(t,e){for(;;){try{if(we(),Oi(),null===ns||null===ns.return)return ls=1,hs=e,null;t:{var i=t,r=ns.return,s=ns,a=e;if(e=os,s.effectTag|=2048,s.firstEffect=s.lastEffect=null,null!==a&&"object"==typeof a&&"function"==typeof a.then){var n=a,o=0!=(1&fi.current),l=r;do{var h;if(h=13===l.tag){var u=l.memoizedState;if(null!==u)h=null!==u.dehydrated;else{var c=l.memoizedProps;h=void 0!==c.fallback&&(!0!==c.unstable_avoidThisFallback||!o)}}if(h){var _=l.updateQueue;if(null===_){var d=new Set;d.add(n),l.updateQueue=d}else _.add(n);if(0==(2&l.mode)){if(l.effectTag|=64,s.effectTag&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var f=Fe(1073741823,null);f.tag=2,Ue(s,f)}s.expirationTime=1073741823;break t}a=void 0,s=e;var p=i.pingCache;if(null===p?(p=i.pingCache=new Kr,a=new Set,p.set(n,a)):void 0===(a=p.get(n))&&(a=new Set,p.set(n,a)),!a.has(s)){a.add(s);var m=Js.bind(null,i,n,s);n.then(m,m)}l.effectTag|=4096,l.expirationTime=e;break t}l=l.return}while(null!==l);a=Error((S(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+Mt(s))}5!==ls&&(ls=2),a=Or(a,s),l=r;do{switch(l.tag){case 3:n=a,l.effectTag|=4096,l.expirationTime=e,ke(l,$r(l,n,e));break t;case 1:n=a;var g=l.type,v=l.stateNode;if(0==(64&l.effectTag)&&("function"==typeof g.getDerivedStateFromError||null!==v&&"function"==typeof v.componentDidCatch&&(null===ys||!ys.has(v)))){l.effectTag|=4096,l.expirationTime=e,ke(l,Zr(l,n,e));break t}}l=l.return}while(null!==l)}ns=zs(ns)}catch(t){e=t;continue}break}}function Us(){var t=es.current;return es.current=Zi,null===t?Zi:t}function ks(t,e){t<us&&2<t&&(us=t),null!==e&&t<cs&&2<t&&(cs=t,_s=e)}function Gs(t){t>ds&&(ds=t)}function Ws(){for(;null!==ns;)ns=Vs(ns)}function Ys(){for(;null!==ns&&!qt();)ns=Vs(ns)}function Vs(t){var e=Jr(t.alternate,t,os);return t.memoizedProps=t.pendingProps,null===e&&(e=zs(t)),is.current=null,e}function zs(t){ns=t;do{var e=ns.alternate;if(t=ns.return,0==(2048&ns.effectTag)){t:{var i=e,r=os,s=(e=ns).pendingProps;switch(e.tag){case 2:case 16:break;case 15:case 0:break;case 1:Ut(e.type)&&kt();break;case 3:ci(),Gt(),(s=e.stateNode).pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(null===i||null===i.child)&&lr(e)&&Ar(e),br(e);break;case 5:di(e);var a=hi(li.current);if(r=e.type,null!==i&&null!=e.stateNode)Er(i,e,r,s,a),i.ref!==e.ref&&(e.effectTag|=128);else if(s){if(i=hi(ni.current),lr(e)){if(s=e,!q)throw Error(o(175));i=bt(s.stateNode,s.type,s.memoizedProps,a,i,s),s.updateQueue=i,(i=null!==i)&&Ar(e)}else{var n=O(r,s,a,i,e);Tr(n,e,!1,!1),e.stateNode=n,N(n,r,s,a,i)&&Ar(e)}null!==e.ref&&(e.effectTag|=128)}else if(null===e.stateNode)throw Error(o(166));break;case 6:if(i&&null!=e.stateNode)Cr(i,e,i.memoizedProps,s);else{if("string"!=typeof s&&null===e.stateNode)throw Error(o(166));if(i=hi(li.current),a=hi(ni.current),lr(e)){if(i=e,!q)throw Error(o(176));(i=Et(i.stateNode,i.memoizedProps,i))&&Ar(e)}else e.stateNode=W(s,i,a,e)}break;case 11:break;case 13:if(At(fi),s=e.memoizedState,0!=(64&e.effectTag)){e.expirationTime=r;break t}s=null!==s,a=!1,null===i?void 0!==e.memoizedProps.fallback&&lr(e):(a=null!==(r=i.memoizedState),s||null===r||null!==(r=i.child.sibling)&&(null!==(n=e.firstEffect)?(e.firstEffect=r,r.nextEffect=n):(e.firstEffect=e.lastEffect=r,r.nextEffect=null),r.effectTag=8)),s&&!a&&0!=(2&e.mode)&&(null===i&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!=(1&fi.current)?0===ls&&(ls=3):(0!==ls&&3!==ls||(ls=4),0!==ds&&null!==as&&(da(as,os),fa(as,ds)))),j&&s&&(e.effectTag|=4),X&&(s||a)&&(e.effectTag|=4);break;case 7:case 8:case 12:break;case 4:ci(),br(e);break;case 10:Le(e);break;case 9:case 14:break;case 17:Ut(e.type)&&kt();break;case 19:if(At(fi),null===(s=e.memoizedState))break;if(a=0!=(64&e.effectTag),null===(n=s.rendering)){if(a)Dr(s,!1);else if(0!==ls||null!==i&&0!=(64&i.effectTag))for(i=e.child;null!==i;){if(null!==(n=pi(i))){for(e.effectTag|=64,Dr(s,!1),null!==(i=n.updateQueue)&&(e.updateQueue=i,e.effectTag|=4),null===s.lastEffect&&(e.firstEffect=null),e.lastEffect=s.lastEffect,i=r,s=e.child;null!==s;)r=i,(a=s).effectTag&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(n=a.alternate)?(a.childExpirationTime=0,a.expirationTime=r,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null):(a.childExpirationTime=n.childExpirationTime,a.expirationTime=n.expirationTime,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,r=n.dependencies,a.dependencies=null===r?null:{expirationTime:r.expirationTime,firstContext:r.firstContext,responders:r.responders}),s=s.sibling;Pt(fi,1&fi.current|2),e=e.child;break t}i=i.sibling}}else{if(!a)if(null!==(i=pi(n))){if(e.effectTag|=64,a=!0,null!==(i=i.updateQueue)&&(e.updateQueue=i,e.effectTag|=4),Dr(s,!0),null===s.tail&&"hidden"===s.tailMode&&!n.alternate){null!==(e=e.lastEffect=s.lastEffect)&&(e.nextEffect=null);break}}else he()>s.tailExpiration&&1<r&&(e.effectTag|=64,a=!0,Dr(s,!1),e.expirationTime=e.childExpirationTime=r-1);s.isBackwards?(n.sibling=e.child,e.child=n):(null!==(i=s.last)?i.sibling=n:e.child=n,s.last=n)}if(null!==s.tail){0===s.tailExpiration&&(s.tailExpiration=he()+500),i=s.tail,s.rendering=i,s.tail=i.sibling,s.lastEffect=e.lastEffect,i.sibling=null,s=fi.current,Pt(fi,s=a?1&s|2:1&s),e=i;break t}break;case 20:case 21:break;default:throw Error(o(156,e.tag))}e=null}if(i=ns,1===os||1!==i.childExpirationTime){for(s=0,a=i.child;null!==a;)(r=a.expirationTime)>s&&(s=r),(n=a.childExpirationTime)>s&&(s=n),a=a.sibling;i.childExpirationTime=s}if(null!==e)return e;null!==t&&0==(2048&t.effectTag)&&(null===t.firstEffect&&(t.firstEffect=ns.firstEffect),null!==ns.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=ns.firstEffect),t.lastEffect=ns.lastEffect),1<ns.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=ns:t.firstEffect=ns,t.lastEffect=ns))}else{if(null!==(e=Br(ns)))return e.effectTag&=2047,e;null!==t&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(null!==(e=ns.sibling))return e;ns=t}while(null!==ns);return 0===ls&&(ls=5),null}function Hs(t){var e=t.expirationTime;return e>(t=t.childExpirationTime)?e:t}function Xs(t){var e=ue();return _e(99,js.bind(null,t,e)),null}function js(t,e){do{Qs()}while(null!==Ts);if(0!=(48&ss))throw Error(o(327));var i=t.finishedWork,r=t.finishedExpirationTime;if(null===i)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,i===t.current)throw Error(o(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var s=Hs(i);if(t.firstPendingTime=s,r<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:r<=t.firstSuspendedTime&&(t.firstSuspendedTime=r-1),r<=t.lastPingedTime&&(t.lastPingedTime=0),r<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===as&&(ns=as=null,os=0),1<i.effectTag?null!==i.lastEffect?(i.lastEffect.nextEffect=i,s=i.firstEffect):s=i:s=i.firstEffect,null!==s){var a=ss;ss|=32,is.current=null,D(t.containerInfo),ms=s;do{try{qs()}catch(t){if(null===ms)throw Error(o(330));Zs(ms,t),ms=ms.nextEffect}}while(null!==ms);ms=s;do{try{for(var n=t,l=e;null!==ms;){var h=ms.effectTag;if(16&h&&X&&st(ms.stateNode),128&h){var u=ms.alternate;if(null!==u){var c=u.ref;null!==c&&("function"==typeof c?c(null):c.current=null)}}switch(1038&h){case 2:Hr(ms),ms.effectTag&=-3;break;case 6:Hr(ms),ms.effectTag&=-3,jr(ms.alternate,ms);break;case 1024:ms.effectTag&=-1025;break;case 1028:ms.effectTag&=-1025,jr(ms.alternate,ms);break;case 4:jr(ms.alternate,ms);break;case 8:var _=n,d=ms,f=l;X?Xr(_,d,f):Yr(_,d,f),Vr(d)}ms=ms.nextEffect}}catch(t){if(null===ms)throw Error(o(330));Zs(ms,t),ms=ms.nextEffect}}while(null!==ms);B(t.containerInfo),t.current=i,ms=s;do{try{for(h=r;null!==ms;){var p=ms.effectTag;if(36&p){var m=ms.alternate;switch(c=h,(u=ms).tag){case 0:case 11:case 15:Gr(16,32,u);break;case 1:var g=u.stateNode;if(4&u.effectTag)if(null===m)g.componentDidMount();else{var v=u.elementType===u.type?m.memoizedProps:be(u.type,m.memoizedProps);g.componentDidUpdate(v,m.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var y=u.updateQueue;null!==y&&Ve(0,y,g);break;case 3:var x=u.updateQueue;if(null!==x){if(n=null,null!==u.child)switch(u.child.tag){case 5:n=I(u.child.stateNode);break;case 1:n=u.child.stateNode}Ve(0,x,n)}break;case 5:var T=u.stateNode;null===m&&4&u.effectTag&&Z(T,u.type,u.memoizedProps,u);break;case 6:case 4:case 12:break;case 13:if(q&&null===u.memoizedState){var b=u.alternate;if(null!==b){var E=b.memoizedState;if(null!==E){var C=E.dehydrated;null!==C&&Rt(C)}}}break;case 19:case 17:case 20:case 21:break;default:throw Error(o(163))}}if(128&p){u=void 0;var S=ms.ref;if(null!==S){var R=ms.stateNode;switch(ms.tag){case 5:u=I(R);break;default:u=R}"function"==typeof S?S(u):S.current=u}}ms=ms.nextEffect}}catch(t){if(null===ms)throw Error(o(330));Zs(ms,t),ms=ms.nextEffect}}while(null!==ms);ms=null,se(),ss=a}else t.current=i;if(xs)xs=!1,Ts=t,bs=e;else for(ms=s;null!==ms;)e=ms.nextEffect,ms.nextEffect=null,ms=e;if(0===(e=t.firstPendingTime)&&(ys=null),1073741823===e?t===Ss?Cs++:(Cs=0,Ss=t):Cs=0,"function"==typeof ea&&ea(i.stateNode,r),Ps(t),gs)throw gs=!1,t=vs,vs=null,t;return 0!=(8&ss)?null:(pe(),null)}function qs(){for(;null!==ms;){var t=ms.effectTag;0!=(256&t)&&kr(ms.alternate,ms),0==(512&t)||xs||(xs=!0,de(97,(function(){return Qs(),null}))),ms=ms.nextEffect}}function Qs(){if(90!==bs){var t=97<bs?97:bs;return bs=90,_e(t,Ks)}}function Ks(){if(null===Ts)return!1;var t=Ts;if(Ts=null,0!=(48&ss))throw Error(o(331));var e=ss;for(ss|=32,t=t.current.firstEffect;null!==t;){try{var i=t;if(0!=(512&i.effectTag))switch(i.tag){case 0:case 11:case 15:Gr(128,0,i),Gr(0,64,i)}}catch(e){if(null===t)throw Error(o(330));Zs(t,e)}i=t.nextEffect,t.nextEffect=null,t=i}return ss=e,pe(),!0}function $s(t,e,i){Ue(t,e=$r(t,e=Or(i,e),1073741823)),null!==(t=Is(t,1073741823))&&Ps(t)}function Zs(t,e){if(3===t.tag)$s(t,t,e);else for(var i=t.return;null!==i;){if(3===i.tag){$s(i,t,e);break}if(1===i.tag){var r=i.stateNode;if("function"==typeof i.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===ys||!ys.has(r))){Ue(i,t=Zr(i,t=Or(e,t),1073741823)),null!==(i=Is(i,1073741823))&&Ps(i);break}}i=i.return}}function Js(t,e,i){var r=t.pingCache;null!==r&&r.delete(e),as===t&&os===i?4===ls||3===ls&&1073741823===us&&he()-ps<500?Fs(t,os):fs=!0:_a(t,i)&&(0!==(e=t.lastPingedTime)&&e<i||(t.lastPingedTime=i,t.finishedExpirationTime===i&&(t.finishedExpirationTime=0,t.finishedWork=null),Ps(t)))}function ta(t,e){var i=t.stateNode;null!==i&&i.delete(e),0===(e=0)&&(e=Ms(e=ws(),t,null)),null!==(t=Is(t,e))&&Ps(t)}Jr=function(t,e,i){var r=e.expirationTime;if(null!==t){var s=e.pendingProps;if(t.memoizedProps!==s||Ot.current)cr=!0;else{if(r<i){switch(cr=!1,e.tag){case 3:xr(e),hr();break;case 5:if(_i(e),4&e.mode&&1!==i&&G(e.type,s))return e.expirationTime=e.childExpirationTime=1,null;break;case 1:Ut(e.type)&&Vt(e);break;case 4:ui(e,e.stateNode.containerInfo);break;case 10:Me(e,e.memoizedProps.value);break;case 13:if(null!==e.memoizedState)return 0!==(r=e.child.childExpirationTime)&&r>=i?Rr(t,e,i):(Pt(fi,1&fi.current),null!==(e=Ir(t,e,i))?e.sibling:null);Pt(fi,1&fi.current);break;case 19:if(r=e.childExpirationTime>=i,0!=(64&t.effectTag)){if(r)return Lr(t,e,i);e.effectTag|=64}if(null!==(s=e.memoizedState)&&(s.rendering=null,s.tail=null),Pt(fi,fi.current),!r)return null}return Ir(t,e,i)}cr=!1}}else cr=!1;switch(e.expirationTime=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,s=Nt(e,Bt.current),Ae(e,i),s=Bi(null,e,r,t,s,i),e.effectTag|=1,"object"==typeof s&&null!==s&&"function"==typeof s.render&&void 0===s.$$typeof){if(e.tag=1,Oi(),Ut(r)){var a=!0;Vt(e)}else a=!1;e.memoizedState=null!==s.state&&void 0!==s.state?s.state:null;var n=r.getDerivedStateFromProps;"function"==typeof n&&je(e,r,n,t),s.updater=qe,e.stateNode=s,s._reactInternalFiber=e,Ze(e,r,t,i),e=yr(null,e,r,!0,a,i)}else e.tag=0,_r(null,e,s,i),e=e.child;return e;case 16:if(s=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(s),1!==s._status)throw s._result;switch(s=s._result,e.type=s,a=e.tag=function(t){if("function"==typeof t)return aa(t)?1:0;if(null!=t){if((t=t.$$typeof)===v)return 11;if(t===T)return 14}return 2}(s),t=be(s,t),a){case 0:e=gr(null,e,s,t,i);break;case 1:e=vr(null,e,s,t,i);break;case 11:e=dr(null,e,s,t,i);break;case 14:e=fr(null,e,s,be(s.type,t),r,i);break;default:throw Error(o(306,s,""))}return e;case 0:return r=e.type,s=e.pendingProps,gr(t,e,r,s=e.elementType===r?s:be(r,s),i);case 1:return r=e.type,s=e.pendingProps,vr(t,e,r,s=e.elementType===r?s:be(r,s),i);case 3:if(xr(e),null===(r=e.updateQueue))throw Error(o(282));if(s=null!==(s=e.memoizedState)?s.element:null,Ye(e,r,e.pendingProps,null,i),(r=e.memoizedState.element)===s)hr(),e=Ir(t,e,i);else{if((s=e.stateNode.hydrate)&&(q?(ir=Tt(e.stateNode.containerInfo),er=e,s=rr=!0):s=!1),s)for(i=si(e,null,r,i),e.child=i;i;)i.effectTag=-3&i.effectTag|1024,i=i.sibling;else _r(t,e,r,i),hr();e=e.child}return e;case 5:return _i(e),null===t&&nr(e),r=e.type,s=e.pendingProps,a=null!==t?t.memoizedProps:null,n=s.children,k(r,s)?n=null:null!==a&&k(r,a)&&(e.effectTag|=16),mr(t,e),4&e.mode&&1!==i&&G(r,s)?(e.expirationTime=e.childExpirationTime=1,e=null):(_r(t,e,n,i),e=e.child),e;case 6:return null===t&&nr(e),null;case 13:return Rr(t,e,i);case 4:return ui(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=ri(e,null,r,i):_r(t,e,r,i),e.child;case 11:return r=e.type,s=e.pendingProps,dr(t,e,r,s=e.elementType===r?s:be(r,s),i);case 7:return _r(t,e,e.pendingProps,i),e.child;case 8:case 12:return _r(t,e,e.pendingProps.children,i),e.child;case 10:t:{if(r=e.type._context,s=e.pendingProps,n=e.memoizedProps,Me(e,a=s.value),null!==n){var l=n.value;if(0===(a=ye(l,a)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,a):1073741823))){if(n.children===s.children&&!Ot.current){e=Ir(t,e,i);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var h=l.dependencies;if(null!==h){n=l.child;for(var u=h.firstContext;null!==u;){if(u.context===r&&0!=(u.observedBits&a)){1===l.tag&&((u=Fe(i,null)).tag=2,Ue(l,u)),l.expirationTime<i&&(l.expirationTime=i),null!==(u=l.alternate)&&u.expirationTime<i&&(u.expirationTime=i),Ie(l.return,i),h.expirationTime<i&&(h.expirationTime=i);break}u=u.next}}else n=10===l.tag&&l.type===e.type?null:l.child;if(null!==n)n.return=l;else for(n=l;null!==n;){if(n===e){n=null;break}if(null!==(l=n.sibling)){l.return=n.return,n=l;break}n=n.return}l=n}}_r(t,e,s.children,i),e=e.child}return e;case 9:return s=e.type,r=(a=e.pendingProps).children,Ae(e,i),r=r(s=Pe(s,a.unstable_observedBits)),e.effectTag|=1,_r(t,e,r,i),e.child;case 14:return a=be(s=e.type,e.pendingProps),fr(t,e,s,a=be(s.type,a),r,i);case 15:return pr(t,e,e.type,e.pendingProps,r,i);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:be(r,s),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,Ut(r)?(t=!0,Vt(e)):t=!1,Ae(e,i),Ke(e,r,s),Ze(e,r,s,i),yr(null,e,r,!0,t,i);case 19:return Lr(t,e,i)}throw Error(o(156,e.tag))};var ea=null,ia=null;function ra(t,e,i,r){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function sa(t,e,i,r){return new ra(t,e,i,r)}function aa(t){return!(!(t=t.prototype)||!t.isReactComponent)}function na(t,e){var i=t.alternate;return null===i?((i=sa(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.effectTag=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childExpirationTime=t.childExpirationTime,i.expirationTime=t.expirationTime,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function oa(t,e,i,r,s,a){var n=2;if(r=t,"function"==typeof t)aa(t)&&(n=1);else if("string"==typeof t)n=5;else t:switch(t){case _:return la(i.children,s,a,e);case g:n=8,s|=7;break;case d:n=8,s|=1;break;case f:return(t=sa(12,i,e,8|s)).elementType=f,t.type=f,t.expirationTime=a,t;case y:return(t=sa(13,i,e,s)).type=y,t.elementType=y,t.expirationTime=a,t;case x:return(t=sa(19,i,e,s)).elementType=x,t.expirationTime=a,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case p:n=10;break t;case m:n=9;break t;case v:n=11;break t;case T:n=14;break t;case b:n=16,r=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=sa(n,i,e,s)).elementType=t,e.type=r,e.expirationTime=a,e}function la(t,e,i,r){return(t=sa(7,t,r,e)).expirationTime=i,t}function ha(t,e,i){return(t=sa(6,t,null,e)).expirationTime=i,t}function ua(t,e,i){return(e=sa(4,null!==t.children?t.children:[],t.key,e)).expirationTime=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ca(t,e,i){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=z,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function _a(t,e){var i=t.firstSuspendedTime;return t=t.lastSuspendedTime,0!==i&&i>=e&&t<=e}function da(t,e){var i=t.firstSuspendedTime,r=t.lastSuspendedTime;i<e&&(t.firstSuspendedTime=e),(r>e||0===i)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function fa(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var i=t.firstSuspendedTime;0!==i&&(e>=i?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function pa(t,e){var i=t.lastExpiredTime;(0===i||i>e)&&(t.lastExpiredTime=e)}function ma(t){var e=t._reactInternalFiber;if(void 0===e){if("function"==typeof t.render)throw Error(o(188));throw Error(o(268,Object.keys(t)))}return null===(t=L(e))?null:t.stateNode}function ga(t,e){null!==(t=t.memoizedState)&&null!==t.dehydrated&&t.retryTime<e&&(t.retryTime=e)}function va(t,e){ga(t,e),(t=t.alternate)&&ga(t,e)}var ya={createContainer:function(t,e,i){return t=new ca(t,e,i),e=sa(3,null,null,2===e?7:1===e?3:0),t.current=e,e.stateNode=t},updateContainer:function(t,e,i,r){var s=e.current,a=ws(),n=He.suspense;a=Ms(a,s,n);t:if(i){e:{if(R(i=i._reactInternalFiber)!==i||1!==i.tag)throw Error(o(170));var l=i;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Ut(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(o(171))}if(1===i.tag){var h=i.type;if(Ut(h)){i=Yt(i,h,l);break t}}i=l}else i=Dt;return null===e.context?e.context=i:e.pendingContext=i,(e=Fe(a,n)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),Ue(s,e),Ls(s,a),a},batchedEventUpdates:function(t,e){var i=ss;ss|=2;try{return t(e)}finally{0===(ss=i)&&pe()}},batchedUpdates:function(t,e){var i=ss;ss|=1;try{return t(e)}finally{0===(ss=i)&&pe()}},unbatchedUpdates:function(t,e){var i=ss;ss&=-2,ss|=8;try{return t(e)}finally{0===(ss=i)&&pe()}},deferredUpdates:function(t){return _e(97,t)},syncUpdates:function(t,e,i,r){return _e(99,t.bind(null,e,i,r))},discreteUpdates:function(t,e,i,r){var s=ss;ss|=4;try{return _e(98,t.bind(null,e,i,r))}finally{0===(ss=s)&&pe()}},flushDiscreteUpdates:function(){0==(49&ss)&&(function(){if(null!==Es){var t=Es;Es=null,t.forEach((function(t,e){pa(e,t),Ps(e)})),pe()}}(),Qs())},flushControlled:function(t){var e=ss;ss|=1;try{_e(99,t)}finally{0===(ss=e)&&pe()}},flushSync:Os,flushPassiveEffects:Qs,IsThisRendererActing:{current:!1},getPublicRootInstance:function(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:return I(t.child.stateNode);default:return t.child.stateNode}},attemptSynchronousHydration:function(t){switch(t.tag){case 3:var e=t.stateNode;e.hydrate&&function(t,e){pa(t,e),Ps(t),0==(48&ss)&&pe()}(e,e.firstPendingTime);break;case 13:Os((function(){return Ls(t,1073741823)})),e=ve(ws(),150,100),va(t,e)}},attemptUserBlockingHydration:function(t){if(13===t.tag){var e=ve(ws(),150,100);Ls(t,e),va(t,e)}},attemptContinuousHydration:function(t){if(13===t.tag){ws();var e=ge++;Ls(t,e),va(t,e)}},attemptHydrationAtCurrentPriority:function(t){if(13===t.tag){var e=ws();Ls(t,e=Ms(e,t,null)),va(t,e)}},findHostInstance:ma,findHostInstanceWithWarning:function(t){return ma(t)},findHostInstanceWithNoPortals:function(t){return null===(t=function(t){if(!(t=M(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child&&4!==e.tag)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}(t))?null:20===t.tag?t.stateNode.instance:t.stateNode},shouldSuspend:function(){return!1},injectIntoDevTools:function(t){var e=t.findFiberByHostInstance;return function(t){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var i=e.inject(t);ea=function(t){try{e.onCommitFiberRoot(i,t,void 0,64==(64&t.current.effectTag))}catch(t){}},ia=function(t){try{e.onCommitFiberUnmount(i,t)}catch(t){}}}catch(t){}return!0}(s({},t,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=L(t))?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}};t.exports=ya.default||ya;var xa=t.exports;return t.exports=e,xa}},function(t,e,i){"use strict";t.exports=i(190)},function(t,e,i){"use strict";
/** @license React v0.18.0
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r,s,a,n,o;if(Object.defineProperty(e,"__esModule",{value:!0}),"undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,h=null,u=function(){if(null!==l)try{var t=e.unstable_now();l(!0,t),l=null}catch(t){throw setTimeout(u,0),t}},c=Date.now();e.unstable_now=function(){return Date.now()-c},r=function(t){null!==l?setTimeout(r,0,t):(l=t,setTimeout(u,0))},s=function(t,e){h=setTimeout(t,e)},a=function(){clearTimeout(h)},n=function(){return!1},o=e.unstable_forceFrameRate=function(){}}else{var _=window.performance,d=window.Date,f=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var m=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof _&&"function"==typeof _.now)e.unstable_now=function(){return _.now()};else{var g=d.now();e.unstable_now=function(){return d.now()-g}}var v=!1,y=null,x=-1,T=5,b=0;n=function(){return e.unstable_now()>=b},o=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):T=0<t?Math.floor(1e3/t):5};var E=new MessageChannel,C=E.port2;E.port1.onmessage=function(){if(null!==y){var t=e.unstable_now();b=t+T;try{y(!0,t)?C.postMessage(null):(v=!1,y=null)}catch(t){throw C.postMessage(null),t}}else v=!1},r=function(t){y=t,v||(v=!0,C.postMessage(null))},s=function(t,i){x=f((function(){t(e.unstable_now())}),i)},a=function(){p(x),x=-1}}function S(t,e){var i=t.length;t.push(e);t:for(;;){var r=Math.floor((i-1)/2),s=t[r];if(!(void 0!==s&&0<M(s,e)))break t;t[r]=e,t[i]=s,i=r}}function R(t){return void 0===(t=t[0])?null:t}function w(t){var e=t[0];if(void 0!==e){var i=t.pop();if(i!==e){t[0]=i;t:for(var r=0,s=t.length;r<s;){var a=2*(r+1)-1,n=t[a],o=a+1,l=t[o];if(void 0!==n&&0>M(n,i))void 0!==l&&0>M(l,n)?(t[r]=l,t[o]=i,r=o):(t[r]=n,t[a]=i,r=a);else{if(!(void 0!==l&&0>M(l,i)))break t;t[r]=l,t[o]=i,r=o}}}return e}return null}function M(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}var L=[],I=[],A=1,P=null,D=3,B=!1,O=!1,F=!1;function N(t){for(var e=R(I);null!==e;){if(null===e.callback)w(I);else{if(!(e.startTime<=t))break;w(I),e.sortIndex=e.expirationTime,S(L,e)}e=R(I)}}function U(t){if(F=!1,N(t),!O)if(null!==R(L))O=!0,r(k);else{var e=R(I);null!==e&&s(U,e.startTime-t)}}function k(t,i){O=!1,F&&(F=!1,a()),B=!0;var r=D;try{for(N(i),P=R(L);null!==P&&(!(P.expirationTime>i)||t&&!n());){var o=P.callback;if(null!==o){P.callback=null,D=P.priorityLevel;var l=o(P.expirationTime<=i);i=e.unstable_now(),"function"==typeof l?P.callback=l:P===R(L)&&w(L),N(i)}else w(L);P=R(L)}if(null!==P)var h=!0;else{var u=R(I);null!==u&&s(U,u.startTime-i),h=!1}return h}finally{P=null,D=r,B=!1}}function G(t){switch(t){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var W=o;e.unstable_ImmediatePriority=1,e.unstable_UserBlockingPriority=2,e.unstable_NormalPriority=3,e.unstable_IdlePriority=5,e.unstable_LowPriority=4,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=D;D=t;try{return e()}finally{D=i}},e.unstable_next=function(t){switch(D){case 1:case 2:case 3:var e=3;break;default:e=D}var i=D;D=e;try{return t()}finally{D=i}},e.unstable_scheduleCallback=function(t,i,n){var o=e.unstable_now();if("object"==typeof n&&null!==n){var l=n.delay;l="number"==typeof l&&0<l?o+l:o,n="number"==typeof n.timeout?n.timeout:G(t)}else n=G(t),l=o;return t={id:A++,callback:i,priorityLevel:t,startTime:l,expirationTime:n=l+n,sortIndex:-1},l>o?(t.sortIndex=l,S(I,t),null===R(L)&&t===R(I)&&(F?a():F=!0,s(U,l-o))):(t.sortIndex=n,S(L,t),O||B||(O=!0,r(k))),t},e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_wrapCallback=function(t){var e=D;return function(){var i=D;D=e;try{return t.apply(this,arguments)}finally{D=i}}},e.unstable_getCurrentPriorityLevel=function(){return D},e.unstable_shouldYield=function(){var t=e.unstable_now();N(t);var i=R(L);return i!==P&&null!==P&&null!==i&&null!==i.callback&&i.startTime<=t&&i.expirationTime<P.expirationTime||n()},e.unstable_requestPaint=W,e.unstable_continueExecution=function(){O||B||(O=!0,r(k))},e.unstable_pauseExecution=function(){},e.unstable_getFirstCallbackNode=function(){return R(L)},e.unstable_Profiling=null},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(192);e.HostConfig={now:Date.now,getRootHostContext:(...t)=>({}),getChildHostContext:(...t)=>({}),shouldSetTextContent:(t,e)=>!1,createTextInstance:(t,e,i,r)=>{},createInstance:(t,e,i,s,a)=>{const n=r.createEle(t);for(const t in e)n[t]=e[t];return n},appendInitialChild:(t,e)=>{t.appendChild(e)},finalizeInitialChildren:(...t)=>!1,prepareForCommit:(...t)=>{console.log("prepareForCommit",...t)},resetAfterCommit:(...t)=>{console.log("resetAfterCommit",...t)},appendChildToContainer:(t,e)=>{e.parent!==t&&t.addChild(e)},supportsMutation:!0,commitMount:(t,e,i,r)=>{t.focus()},prepareUpdate:function(t,e,i,r,s,a){},commitUpdate:function(t,e,i,r,s,a){console.log("commitUpdate")},commitTextUpdate:function(t,e,i){t.nodeValue=i},insertBefore:(t,e,i)=>{t.insertBefore(e,i)},removeChild:function(t,e){t.removeChild(e)},insertInContainerBefore:function(t,e,i){t.insertBefore(e,i)},removeChildFromContainer:function(t,e){t.removeChild(e)},shouldDeprioritizeSubtree:function(t,e){return!!e.hidden}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(193),s=i(196);e.createEle=function(t){return"Box"===t?new r.Box:"Label"===t?new s.Label:void 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(109),s=i(2),a=i(0),n=i(9);class o extends r.UIComponent{set dataSource(t){for(var e in this._dataSource=t,t){var i=this.getChildByName(e);i?i.dataSource=t[e]:e in this&&!(this[e]instanceof Function)&&(this[e]=t[e])}}get dataSource(){return super.dataSource}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t,t?(this._onResize(null),this.on(s.Event.RESIZE,this,this._onResize)):(this.graphics.clear(),this.off(s.Event.RESIZE,this,this._onResize))}_onResize(t){this.graphics.clear(),this.graphics.drawRect(0,0,this.width,this.height,this._bgColor)}}e.Box=o,a.ILaya.regClass(o),n.ClassUtils.regClass("laya.ui.Box",o),n.ClassUtils.regClass("Laya.Box",o)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(106),s=i(2),a=i(0),n=i(9);class o extends r.Component{constructor(){super(...arguments),this._top=NaN,this._bottom=NaN,this._left=NaN,this._right=NaN,this._centerX=NaN,this._centerY=NaN}onReset(){this._top=this._bottom=this._left=this._right=this._centerX=this._centerY=NaN}_onEnable(){this.owner.parent?this._onAdded():this.owner.once(s.Event.ADDED,this,this._onAdded)}_onDisable(){this.owner.off(s.Event.ADDED,this,this._onAdded),this.owner.parent&&this.owner.parent.off(s.Event.RESIZE,this,this._onParentResize)}_onAdded(){this.owner.parent&&this.owner.parent.on(s.Event.RESIZE,this,this._onParentResize),this.resetLayoutX(),this.resetLayoutY()}_onParentResize(){var t=this.resetLayoutX(),e=this.resetLayoutY();(t||e)&&this.owner.event(s.Event.RESIZE)}resetLayoutX(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerX)){if(isNaN(this.left))isNaN(this.right)||(t.x=Math.round(e.width-t.displayWidth-this.right+t.pivotX*t.scaleX));else if(t.x=Math.round(this.left+t.pivotX*t.scaleX),!isNaN(this.right)){var i=(e._width-this.left-this.right)/(t.scaleX||.01);if(i!=t.width)return t.width=i,!0}}else t.x=Math.round(.5*(e.width-t.displayWidth)+this.centerX+t.pivotX*t.scaleX);return!1}resetLayoutY(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerY)){if(isNaN(this.top))isNaN(this.bottom)||(t.y=Math.round(e.height-t.displayHeight-this.bottom+t.pivotY*t.scaleY));else if(t.y=Math.round(this.top+t.pivotY*t.scaleY),!isNaN(this.bottom)){var i=(e._height-this.top-this.bottom)/(t.scaleY||.01);if(i!=t.height)return t.height=i,!0}}else t.y=Math.round(.5*(e.height-t.displayHeight)+this.centerY+t.pivotY*t.scaleY);return!1}resetLayout(){this.owner&&(this.resetLayoutX(),this.resetLayoutY())}get top(){return this._top}set top(t){this._top!=t&&(this._top=t,this.resetLayoutY())}get bottom(){return this._bottom}set bottom(t){this._bottom!=t&&(this._bottom=t,this.resetLayoutY())}get left(){return this._left}set left(t){this._left!=t&&(this._left=t,this.resetLayoutX())}get right(){return this._right}set right(t){this._right!=t&&(this._right=t,this.resetLayoutX())}get centerX(){return this._centerX}set centerX(t){this._centerX!=t&&(this._centerX=t,this.resetLayoutX())}get centerY(){return this._centerY}set centerY(t){this._centerY!=t&&(this._centerY=t,this.resetLayoutY())}}e.Widget=o,o.EMPTY=null,a.ILaya.regClass(o),o.EMPTY=new o,n.ClassUtils.regClass("laya.ui.Widget",o),n.ClassUtils.regClass("Laya.Widget",o)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(2),s=i(0),a=i(9);class n extends r.Event{}e.UIEvent=n,n.SHOW_TIP="showtip",n.HIDE_TIP="hidetip",s.ILaya.regClass(n),a.ClassUtils.regClass("laya.ui.UIEvent",n),a.ClassUtils.regClass("Laya.UIEvent",n)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(197),s=i(36),a=i(2),n=i(109),o=i(110),l=i(0),h=i(9);class u extends n.UIComponent{constructor(t=""){super(),this.text=t}destroy(t=!0){super.destroy(t),this._tf=null}createChildren(){this.addChild(this._tf=new s.Text)}get text(){return this._tf.text}set text(t){this._tf.text!=t&&(t&&(t=o.UIUtils.adptString(t+"")),this._tf.text=t,this.event(a.Event.CHANGE),this._width&&this._height||this.onCompResize())}changeText(t){this._tf.changeText(t)}get wordWrap(){return this._tf.wordWrap}set wordWrap(t){this._tf.wordWrap=t}get color(){return this._tf.color}set color(t){this._tf.color=t}get font(){return this._tf.font}set font(t){this._tf.font=t}get align(){return this._tf.align}set align(t){this._tf.align=t}get valign(){return this._tf.valign}set valign(t){this._tf.valign=t}get bold(){return this._tf.bold}set bold(t){this._tf.bold=t}get italic(){return this._tf.italic}set italic(t){this._tf.italic=t}get leading(){return this._tf.leading}set leading(t){this._tf.leading=t}get fontSize(){return this._tf.fontSize}set fontSize(t){this._tf.fontSize=t}get padding(){return this._tf.padding.join(",")}set padding(t){this._tf.padding=o.UIUtils.fillArray(r.Styles.labelPadding,t,Number)}get bgColor(){return this._tf.bgColor}set bgColor(t){this._tf.bgColor=t}get borderColor(){return this._tf.borderColor}set borderColor(t){this._tf.borderColor=t}get stroke(){return this._tf.stroke}set stroke(t){this._tf.stroke=t}get strokeColor(){return this._tf.strokeColor}set strokeColor(t){this._tf.strokeColor=t}get textField(){return this._tf}measureWidth(){return this._tf.width}measureHeight(){return this._tf.height}get width(){return this._width||this._tf.text?super.width:0}set width(t){super.width=t,this._tf.width=t}get height(){return this._height||this._tf.text?super.height:0}set height(t){super.height=t,this._tf.height=t}set dataSource(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.text=t+"":super.dataSource=t}get dataSource(){return super.dataSource}get overflow(){return this._tf.overflow}set overflow(t){this._tf.overflow=t}get underline(){return this._tf.underline}set underline(t){this._tf.underline=t}get underlineColor(){return this._tf.underlineColor}set underlineColor(t){this._tf.underlineColor=t}}e.Label=u,l.ILaya.regClass(u),h.ClassUtils.regClass("laya.ui.Label",u),h.ClassUtils.regClass("Laya.Label",u)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r{}e.Styles=r,r.defaultSizeGrid=[4,4,4,4,0],r.labelColor="#000000",r.labelPadding=[2,2,2,2],r.inputLabelPadding=[1,1,1,3],r.buttonStateNum=3,r.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"],r.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"],r.scrollBarMinNum=15,r.scrollBarDelayTime=500}]);